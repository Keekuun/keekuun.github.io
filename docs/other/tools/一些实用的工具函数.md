---
title: 【工具】一些实用的工具函数
date: 2020-12-21
sidebar: auto
categories: 
- 其他
tags:
- 工具函数
---

# 一些实用的工具函数

## 1.数组对象按key去重

```typescript
export function uniqueArrObjByKey<T>(arr: T[], key?: keyof T): T[] {
  if (!key) {
    return [...new Set(arr)];
  }

  const res: T[] = [];
  for (let i = 0; i < arr.length; i++) {
    const has = res.some(d => d[key] === arr[i][key]);
    if (!has) {
      res.push(arr[i]);
    }
  }

  return res;
}
```

## 3.计算滚动条尺寸
```typescript
function getScrollbarSize() {
    const scrollDiv = document.createElement("div");
    scrollDiv.style.cssText = 'width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;opacity:0';
    document.body.appendChild(scrollDiv);
    // 垂直方向滚动条宽度
    const x = scrollDiv.offsetWidth - scrollDiv.clientWidth;
    // 水平方向滚动条宽度
    const y = scrollDiv.offsetHeight - scrollDiv.clientHeight;
    document.body.removeChild(scrollDiv);
    return {xWidth: x, yWidth: y};
}
```

## 4.判断容器是否出现滚动条
+ 判断body元素：
```typescript
function hasScrollbar() {
    return document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight);
}
```

+ 判断任意元素：
```typescript
function hasScrollbar(el: HTMLElement, isVertical=true) {
    if (isVertical) {
        return el.scrollHeight > el.clientHeight;
    } else {
        return el.scrollWidth > el.clientWidth;
    }
 }
```
