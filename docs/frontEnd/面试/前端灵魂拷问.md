---
title: ã€é¢è¯•ã€‘å‰ç«¯çµé­‚æ‹·é—®
date: 2020-09-03
sidebar: 'auto'
categories: 
- å‰ç«¯
tags: 
- JS
- é¢è¯•
keys:
- 'zkkysqs'
publish: true
---

# å‰ç«¯çµé­‚æ‹·é—®

> [æœ€æ–°å‰ç«¯é¢è¯•é¢˜æ”»ç•¥](https://juejin.im/post/6844903791246966791#heading-11)

## 1.CSSç›¸å…³

### 1.`css3`ç‰¹æ€§ä¸­çš„`transformï¼štranslateZ(0)`æœ‰ä»€ä¹ˆä½œç”¨?

**GPU**åŠ é€Ÿï¼Œä¼˜åŒ–å‰ç«¯æ€§èƒ½

```css 
.example {
  /*å¼€å¯ç¡¬ä»¶åŠ é€Ÿ*/
  transform: translateZ(0);
  /*ä¼˜åŒ–ï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œå“ªäº›å±æ€§éœ€è¦ç¡¬ä»¶åŠ é€Ÿï¼Œæå‰å¼€å¯ç¡¬ä»¶åŠ é€Ÿ*/
  will-change: transform, opacity;
  /*äººä¸ºå¹²æ‰°å¤åˆå±‚çš„æ’åº,å¯ä»¥æœ‰æ•ˆå‡å°‘chromeåˆ›å»ºä¸å¿…è¦çš„å¤åˆå±‚ï¼Œæå‡æ¸²æŸ“æ€§èƒ½*/
  z-index: 1
}
```



> [åœ¨ CSS åŠ¨ç”»ä¸­ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿ(ç¿»è¯‘)](https://juejin.im/post/6844903649974435854)
>
> [CSS3 transformä»‹ç»](https://www.jianshu.com/p/17e289fcf467)
>
> [CSS3ç¡¬ä»¶åŠ é€Ÿä¹Ÿæœ‰å‘](https://juejin.im/entry/6844903597772111886#comment)
>
> [CSS3å¼€å¯ç¡¬ä»¶åŠ é€Ÿçš„ä½¿ç”¨å’Œå‘](https://www.jianshu.com/p/9596c82086d5)
>
> [CSS will-change å±æ€§](https://www.cnblogs.com/yuzhongwusan/p/4186405.html)
>
> [iScroll, smooth scrolling for the web](https://github.com/Keekuun/iscroll)

## 2.æµè§ˆå™¨ç›¸å…³

### 1.åˆ—ä¸¾ä¸‰ç§ç¦æ­¢æµè§ˆå™¨ç¼“å­˜çš„å¤´å­—æ®µï¼Œå¹¶å†™å‡ºå“åº”çš„è®¾ç½®å€¼ï¼Ÿ

```js
/**
* ç¦ç”¨æµè§ˆå™¨ç¼“å­˜é€šè¿‡Cache-Controlã€pragmaã€expires 
*/
response.setHeader("Cache-Control","no-cache");
response.setHeader("pragma", "no-cache");
response.setDateHeader("expires", -1);
```

åœ¨ç°ä»£çš„æµè§ˆå™¨é‡Œï¼Œä¸ºäº†å¢å¼ºç”¨æˆ·ä½“éªŒï¼Œæµè§ˆå™¨ä¸€èˆ¬éƒ½ä¼šæŠŠç½‘é¡µä¸Šæ‰€éœ€çš„é™æ€æ–‡ä»¶ç¼“å­˜åˆ°æœ¬åœ°ï¼Œå†æ¬¡åˆ·æ–°çš„æ—¶å€™åˆ™æ— éœ€å†é‡æ–°åŠ è½½ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰æ—¶å€™å°±æ˜¯ä¸éœ€è¦æµè§ˆå™¨ç¼“å­˜è¿™äº›æ–‡ä»¶ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½ä»æœåŠ¡å™¨ç«¯è¯»å–æ•°æ®ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹åšæ³•ï¼š

åœ¨htmlæ–‡ä»¶å¤´éƒ¨åŠ ä¸Šï¼š

```html
<meta HTTP-EQUIV="pragma" CONTENT="no-cache">
<meta HTTP-EQUIV="Cache-Control" CONTENT="no-store, must-revalidate">
<meta HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT">
<meta HTTP-EQUIV="expires" CONTENT="0">
```

ç„¶è€Œè¿™äº›è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæœ‰äº›æµè§ˆå™¨è¿˜æ˜¯ç¼“å­˜äº†æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å¿…é¡»ç»™æ¯ä¸ªæ–‡ä»¶åŠ ä¸ªåç¼€æ—¶é—´æˆ³ï¼Œå‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªæ˜¯æ–°æ–‡ä»¶ï¼Œå¿…é¡»é‡æ–°åŠ è½½ï¼Œæµè§ˆå™¨å°±ä¼šä»æ–°åˆ°æœåŠ¡å™¨ç«¯è¯»å–æ•°æ®æ–‡ä»¶æ˜¾ç¤ºå‡ºæ¥ã€‚

ä¾‹å¦‚ï¼š

```html
<link href="reset.css?v=20150127" rel="stylesheet">
```

é‚£ä¹ˆï¼Œæµè§ˆå™¨ç¼“å­˜æœ‰å“ªäº›å‘¢ï¼Ÿ

+ å¼ºç¼“å­˜
+ åå•†ç¼“å­˜

#### 1.å¼ºç¼“å­˜

+ HTTP1.0ï¼š`Expires`å³è¿‡æœŸæ—¶é—´ï¼Œå­˜åœ¨äºæœåŠ¡ç«¯è¿”å›çš„å“åº”å¤´ä¸­ï¼Œå‘Šè¯‰æµè§ˆå™¨åœ¨è¿™ä¸ªè¿‡æœŸæ—¶é—´ä¹‹å‰å¯ä»¥ç›´æ¥ä»ç¼“å­˜é‡Œé¢è·å–æ•°æ®ï¼Œæ— éœ€å†æ¬¡è¯·æ±‚ã€‚(å‘ï¼š**æœåŠ¡å™¨çš„æ—¶é—´å’Œæµè§ˆå™¨çš„æ—¶é—´å¯èƒ½å¹¶ä¸ä¸€è‡´**ï¼Œé‚£æœåŠ¡å™¨è¿”å›çš„è¿™ä¸ªè¿‡æœŸæ—¶é—´å¯èƒ½å°±æ˜¯ä¸å‡†ç¡®çš„)

  ```makefile
  Expires: Wed, 22 Nov 2019 08:41:00 GMT
  ```

+ HTTP1.1ï¼š`Cache-Control`,é‡‡ç”¨è¿‡æœŸæ—¶é•¿æ¥æ§åˆ¶ç¼“å­˜ï¼Œå¯¹åº”çš„å­—æ®µæ˜¯**max-age**

  ```makefile
  # ä»£è¡¨è¿™ä¸ªå“åº”è¿”å›ååœ¨ 3600 ç§’ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå°æ—¶ä¹‹å†…å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜ã€‚
  Cache-Control: max-age=3600
  ```

  `Cache-Control`å±æ€§å€¼ï¼š

  + `max-age`ï¼šè¿‡æœŸæ—¶é•¿s

  + `private`ï¼š è¿™ç§æƒ…å†µå°±æ˜¯åªæœ‰æµè§ˆå™¨èƒ½ç¼“å­˜äº†ï¼Œä¸­é—´çš„ä»£ç†æœåŠ¡å™¨ä¸èƒ½ç¼“å­˜ã€‚
  + `no-cache`: è·³è¿‡å½“å‰çš„**å¼ºç¼“å­˜**ï¼Œå‘é€HTTPè¯·æ±‚ï¼Œå³ç›´æ¥è¿›å…¥`åå•†ç¼“å­˜é˜¶æ®µ`ã€‚
  + `no-store`ï¼šéå¸¸ç²—æš´ï¼Œä¸è¿›è¡Œä»»ä½•å½¢å¼çš„ç¼“å­˜ã€‚
  + `s-maxage`ï¼šè¿™å’Œ`max-age`é•¿å¾—æ¯”è¾ƒåƒï¼Œä½†æ˜¯åŒºåˆ«åœ¨äºs-maxageæ˜¯é’ˆå¯¹ä»£ç†æœåŠ¡å™¨çš„ç¼“å­˜æ—¶é—´ã€‚
  + `must-revalidate`: æ˜¯ç¼“å­˜å°±ä¼šæœ‰è¿‡æœŸçš„æ—¶å€™ï¼ŒåŠ ä¸Šè¿™ä¸ªå­—æ®µä¸€æ—¦ç¼“å­˜è¿‡æœŸï¼Œå°±å¿…é¡»å›åˆ°æºæœåŠ¡å™¨éªŒè¯ã€‚

  å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“**Expires**å’Œ**Cache-Control**åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œ**Cache-Control**ä¼šä¼˜å…ˆè€ƒè™‘ã€‚

  å½“ç„¶ï¼Œè¿˜å­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“èµ„æºç¼“å­˜æ—¶é—´è¶…æ—¶äº†ï¼Œä¹Ÿå°±æ˜¯`å¼ºç¼“å­˜`å¤±æ•ˆäº†ï¼Œæ¥ä¸‹æ¥æ€ä¹ˆåŠï¼Ÿæ²¡é”™ï¼Œè¿™æ ·å°±è¿›å…¥åˆ°ç¬¬äºŒçº§å±éšœâ€”â€”**åå•†ç¼“å­˜**äº†ã€‚

#### 2.åå•†ç¼“å­˜

å¼ºç¼“å­˜å¤±æ•ˆä¹‹åï¼Œæµè§ˆå™¨åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ç›¸åº”çš„`ç¼“å­˜tag`æ¥å‘æœåŠ¡å™¨å‘è¯·æ±‚ï¼Œç”±æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªtagï¼Œæ¥å†³å®šæ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œè¿™å°±æ˜¯**åå•†ç¼“å­˜**ã€‚

+ `Last-Modified`: æœ€åä¿®æ”¹æ—¶é—´(å•ä½s)ï¼ˆæ€§èƒ½ä¼˜äºETagï¼‰

åœ¨æµè§ˆå™¨ç¬¬ä¸€æ¬¡ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šåœ¨å“åº”å¤´ä¸­åŠ ä¸Šè¿™ä¸ªå­—æ®µã€‚

æµè§ˆå™¨æ¥æ”¶åˆ°åï¼Œå¦‚æœå†æ¬¡è¯·æ±‚ï¼Œä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦`If-Modified-Since`å­—æ®µï¼Œè¿™ä¸ªå­—æ®µçš„å€¼ä¹Ÿå°±æ˜¯æœåŠ¡å™¨ä¼ æ¥çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚

æœåŠ¡å™¨æ‹¿åˆ°è¯·æ±‚å¤´ä¸­çš„`If-Modified-Since`çš„å­—æ®µåï¼Œå…¶å®ä¼šå’Œè¿™ä¸ªæœåŠ¡å™¨ä¸­`è¯¥èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´`å¯¹æ¯”:

1. å¦‚æœè¯·æ±‚å¤´ä¸­çš„è¿™ä¸ªå€¼å°äºæœ€åä¿®æ”¹æ—¶é—´ï¼Œè¯´æ˜æ˜¯æ—¶å€™æ›´æ–°äº†ã€‚è¿”å›æ–°çš„èµ„æºï¼Œè·Ÿå¸¸è§„çš„HTTPè¯·æ±‚å“åº”çš„æµç¨‹ä¸€æ ·ã€‚

2. å¦åˆ™è¿”å›304ï¼Œå‘Šè¯‰æµè§ˆå™¨ç›´æ¥ç”¨ç¼“å­˜ã€‚

`ETag`: æ–‡ä»¶ç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†ã€‚ï¼ˆç²¾å‡†åº¦ä¼˜äºLast-Modifiedï¼‰

æœåŠ¡å™¨æ ¹æ®å½“å‰æ–‡ä»¶çš„å†…å®¹ï¼Œç»™æ–‡ä»¶ç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†ï¼Œåªè¦é‡Œé¢çš„å†…å®¹æœ‰æ”¹åŠ¨ï¼Œè¿™ä¸ªå€¼å°±ä¼šå˜ã€‚æœåŠ¡å™¨é€šè¿‡`å“åº”å¤´`æŠŠè¿™ä¸ªå€¼ç»™æµè§ˆå™¨ã€‚

æµè§ˆå™¨æ¥æ”¶åˆ°`ETag`çš„å€¼ï¼Œä¼šåœ¨ä¸‹æ¬¡è¯·æ±‚æ—¶ï¼Œå°†è¿™ä¸ªå€¼ä½œä¸º**If-None-Match**è¿™ä¸ªå­—æ®µçš„å†…å®¹ï¼Œå¹¶æ”¾åˆ°è¯·æ±‚å¤´ä¸­ï¼Œç„¶åå‘ç»™æœåŠ¡å™¨ã€‚

æœåŠ¡å™¨æ¥æ”¶åˆ°**If-None-Match**åï¼Œä¼šè·ŸæœåŠ¡å™¨ä¸Šè¯¥èµ„æºçš„**ETag**è¿›è¡Œæ¯”å¯¹:

- å¦‚æœä¸¤è€…ä¸ä¸€æ ·ï¼Œè¯´æ˜è¦æ›´æ–°äº†ã€‚è¿”å›æ–°çš„èµ„æºï¼Œè·Ÿå¸¸è§„çš„HTTPè¯·æ±‚å“åº”çš„æµç¨‹ä¸€æ ·ã€‚
- å¦åˆ™è¿”å›304ï¼Œå‘Šè¯‰æµè§ˆå™¨ç›´æ¥ç”¨ç¼“å­˜ã€‚

#### 3.ç¼“å­˜ä½ç½®

- Service Worker 

Service Worker å€Ÿé‰´äº† Web Workerçš„ æ€è·¯ï¼Œå³è®© JS è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œç”±äºå®ƒè„±ç¦»äº†æµè§ˆå™¨çš„çª—ä½“ï¼Œå› æ­¤æ— æ³•ç›´æ¥è®¿é—®`DOM`ã€‚è™½ç„¶å¦‚æ­¤ï¼Œä½†å®ƒä»ç„¶èƒ½å¸®åŠ©æˆ‘ä»¬å®Œæˆå¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚`ç¦»çº¿ç¼“å­˜`ã€`æ¶ˆæ¯æ¨é€`å’Œ`ç½‘ç»œä»£ç†`ç­‰åŠŸèƒ½ã€‚å…¶ä¸­çš„`ç¦»çº¿ç¼“å­˜`å°±æ˜¯ **Service Worker Cache**ã€‚

Service Worker åŒæ—¶ä¹Ÿæ˜¯ PWA çš„é‡è¦å®ç°æœºåˆ¶

- Memory Cache å†…å­˜ç¼“å­˜ï¼Œæ•ˆç‡æœ€å¿«
- Disk Cache ç£ç›˜ç¼“å­˜
- Push Cache æ¨é€ç¼“å­˜ï¼ˆHTTP/2ï¼‰

#### 4.æ€»ç»“

é¦–å…ˆé€šè¿‡ `Cache-Control` éªŒè¯å¼ºç¼“å­˜æ˜¯å¦å¯ç”¨

- å¦‚æœå¼ºç¼“å­˜å¯ç”¨ï¼Œç›´æ¥ä½¿ç”¨ï¼Œä¸ç”¨å‘èµ·HTTPè¯·æ±‚

- å¦åˆ™è¿›å…¥åå•†ç¼“å­˜ï¼Œå³å‘é€ HTTP è¯·æ±‚ï¼ŒæœåŠ¡å™¨é€šè¿‡è¯·æ±‚å¤´ä¸­çš„

  ```
  If-Modified-Since
  ```

  æˆ–è€…

  ```
  If-None-Match
  ```

  è¿™äº›æ¡ä»¶è¯·æ±‚å­—æ®µæ£€æŸ¥èµ„æºæ˜¯å¦æ›´æ–°

  - è‹¥èµ„æºæ›´æ–°ï¼Œè¿”å›èµ„æºå’Œ200çŠ¶æ€ç 
  - å¦åˆ™ï¼Œè¿”å›304ï¼Œå‘Šè¯‰æµè§ˆå™¨ç›´æ¥ä»ç¼“å­˜è·å–èµ„æº

> [èƒ½ä¸èƒ½è¯´ä¸€è¯´å‰ç«¯ç¼“å­˜?](http://47.98.159.95/my_blog/perform/001.html)
>
> [å…³äºæµè§ˆå™¨ç¼“å­˜çš„æ§åˆ¶cache-control,expires,last-modified,etag,åŠç¼–ç¨‹ç¤ºä¾‹](https://blog.csdn.net/iteye_11287/article/details/82618718?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param)

### 3.ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

> [(è¶…è¯¦ç»†ï¼‰ä»è¾“å…¥urlåˆ°é¡µé¢å±•ç¤ºå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ](https://juejin.im/post/6869279683230629896)
>
> [ç»å…¸é¢è¯•é¢˜ï¼ä»è¾“å…¥URLåˆ°é¡µé¢å±•ç¤ºä½ è¿˜ä¸èµ¶ç´§å­¦èµ·æ¥ï¼Ÿ](https://juejin.im/post/6858551640220729351)

1.è¿›ç¨‹ï¼šæµè§ˆå™¨è¿›ç¨‹ï¼ˆä¸»è¿›ç¨‹ï¼‰ --- ç½‘ç»œè¿›ç¨‹ --- æ¸²æŸ“è¿›ç¨‹ --- GPUè¿›ç¨‹----ç©¿æ’å…¶ä»–è¿›ç¨‹ï¼ˆæ’ä»¶è¿›ç¨‹ç­‰ï¼‰

2.å…·ä½“è¿‡ç¨‹ï¼š

- 1.ç”¨æˆ·åœ¨æµè§ˆå™¨å¯¼èˆªæ è¾“å…¥ä¿¡æ¯ï¼š éurl æ˜¯query--- é»˜è®¤æœç´¢å¼•æ“å»æœç´¢ï¼›url --- æµè§ˆå™¨è¿›ç¨‹é—´é€šä¿¡ï¼Œäº¤ç»™ç½‘ç»œè¿›ç¨‹å¤„ç†

- 2.ç½‘ç»œè¿›ç¨‹ä¼šå…ˆçœ‹æœ‰æ²¡æœ‰ç¼“å­˜ï¼Œå¦åˆ™è¿›è¡Œ DNSè§£æè·å–IPåœ°å€å»ºç«‹TCPè¿æ¥

- 3.DNSè§£æï¼šç½‘ç»œè¿›ç¨‹æ‹¿åˆ°URLåä¼šè¯·æ±‚DNSåŸŸåæœåŠ¡å™¨ï¼Œè§£æè·å–ipåœ°å€ã€‚

- 4.å»ºç«‹TCPè¿æ¥ï¼Œä¸‰æ¬¡æ¡æ‰‹ï¼Œå¦‚æœæ˜¯httpsåè®®ï¼Œè¿˜ä¼šå»ºç«‹SSL/TLSè¿æ¥

- 5.å‘é€HTTPè¯·æ±‚ï¼Œå››æ¬¡æŒ¥æ‰‹

- 6.æœåŠ¡å™¨å“åº”ï¼šæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä¿¡æ¯åï¼Œä¼šæ ¹æ®è¯·æ±‚ä¿¡æ¯ç”Ÿæˆ**å“åº”è¡Œ**ã€**å“åº”å¤´**ã€**å“åº”ä½“**ï¼Œå¹¶å‘ç»™ç½‘ç»œè¿›ç¨‹ã€‚ç½‘ç»œè¿›ç¨‹æ¥å—äº†å“åº”ä¿¡æ¯ä¹‹åï¼Œå°±å¼€å§‹è§£æå“åº”å¤´çš„å†…å®¹ã€‚

- 7.**ç½‘ç»œè¿›ç¨‹è§£æå“åº”è¡Œå’Œå“åº”å¤´ä¿¡æ¯çš„è¿‡ç¨‹**ï¼š

  - é‡å®šå‘ï¼šå¦‚æœå“åº”è¡ŒçŠ¶æ€ç ä¸º301ï¼ˆæ°¸ä¹…é‡å®šå‘ï¼‰å’Œ302ï¼ˆä¸´æ—¶ï¼‰ï¼Œé‚£ä¹ˆè¯´æ˜éœ€è¦é‡å®šå‘åˆ°å…¶ä»–urlã€‚è¿™æ—¶å€™ç½‘ç»œè¿›ç¨‹ä¼šä»å“åº”å¤´ä¸­çš„Locationå­—æ®µé‡Œè¯»å–é‡å®šå‘çš„åœ°å€ï¼Œå¹¶é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚
  - å“åº”æ•°æ®å¤„ç†ï¼šé€šè¿‡è¯·æ±‚å¤´çš„**Content-type**å­—æ®µåˆ¤æ–­**å“åº”ä½“**æ•°æ®çš„ç±»å‹ï¼Œä»è€Œå†³å®šæ€ä¹ˆå¤„ç†å“åº”çš„æ•°æ®ã€‚å¦‚æœæ˜¯æ–‡æœ¬æˆ–htmlç”¨æ¸²æŸ“è¿›ç¨‹æ¸²æŸ“ï¼Œå¦åˆ™å¦‚æœæ˜¯æ–‡ä»¶é€šçŸ¥ä¸‹è½½ç®¡ç†å™¨ï¼›

- 8.å‡†å¤‡æ¸²æŸ“è¿›ç¨‹ï¼šé»˜è®¤æƒ…å†µï¼Œæ¯ä¸ªé¡µé¢ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ã€‚ä½†è‹¥å¤„äº**åŒä¸€ç«™ç‚¹**ï¼ˆåŒæ ¹åŸŸå+åè®®ï¼‰ï¼Œé‚£ä¹ˆ**æ¸²æŸ“è¿›ç¨‹å°±ä¼šå¤ç”¨**ã€‚

- 9.æäº¤æ–‡æ¡£ï¼šæ¸²æŸ“è¿›ç¨‹å‡†å¤‡å¥½åï¼Œæµè§ˆå™¨è¿›ç¨‹å‘å‡º**â€œæäº¤æ–‡æ¡£çš„æ¶ˆæ¯â€**ã€‚ç­‰æ•°æ®ä¼ è¾“å®Œæˆäº†ï¼Œæ¸²æŸ“è¿›ç¨‹ä¼šå‘Šè¯‰æµè§ˆå™¨è¿›ç¨‹ï¼Œ**ç¡®è®¤æ–‡æ¡£æäº¤**ï¼Œè¿™æ—¶å€™æµè§ˆå™¨ä¼šæ›´æ–°é¡µé¢ï¼Œå®‰å…¨çŠ¶æ€ï¼Œurlï¼Œå‰è¿›åé€€çš„å†å²ã€‚åˆ°è¿™é‡Œå¯¼èˆªç»“æŸï¼Œè¿›å…¥æ¸²æŸ“é˜¶æ®µã€‚(**æ³¨**ï¼šå½“æµè§ˆå™¨åˆšå¼€å§‹åŠ è½½ä¸€ä¸ªåœ°å€ä¹‹åï¼Œæ ‡ç­¾é¡µä¸Šçš„å›¾æ ‡ä¾¿è¿›å…¥äº†åŠ è½½çŠ¶æ€ã€‚ä½†æ­¤æ—¶å›¾ä¸­é¡µé¢æ˜¾ç¤ºçš„ä¾ç„¶æ˜¯ä¹‹å‰æ‰“å¼€çš„é¡µé¢å†…å®¹ï¼Œå¹¶æ²¡ç«‹å³æ›¿æ¢ä¸ºç™¾åº¦é¦–é¡µçš„é¡µé¢ã€‚å› ä¸ºéœ€è¦ç­‰å¾…æäº¤æ–‡æ¡£é˜¶æ®µï¼Œé¡µé¢å†…å®¹æ‰ä¼šè¢«æ›¿æ¢ã€‚)

- **æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹**ï¼š

  + 1.æµè§ˆå™¨æ— æ³•ç›´æ¥è¯»å–htmlï¼Œéœ€è¦å…ˆæ„å»º**Dom**æ ‘ã€‚

  + 2.æŠŠè¯»å–åˆ°çš„cssï¼Œå˜æˆæµè§ˆå™¨å¯ä»¥ç†è§£çš„**cssom**æ ‘ã€‚

    **è½¬æ¢æ ·å¼è¡¨ä¸­çš„å±æ€§å€¼ï¼Œä½¿å…¶æ ‡å‡†åŒ–**ã€‚2em è¢«è§£ææˆäº† 32pxï¼Œred è¢«è§£ææˆäº† rgb(255,0,0)ï¼Œbold è¢«è§£ææˆäº† 700â€¦â€¦

    **è®¡ç®—å‡º DOM æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å…·ä½“æ ·å¼**ã€‚åˆ©ç”¨cssç»§æ‰¿ã€cssä¼˜å…ˆçº§ã€csså±‚å è§„åˆ™ç­‰è®¡ç®—å‡ºæ¥ã€‚

  + 3.æµè§ˆå™¨ä¼šå…ˆä»DOMæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ¯ä¸ªå¯è§èŠ‚ç‚¹ï¼Œå¹¶æŠŠè¿™äº›èŠ‚ç‚¹æ·»åŠ åˆ°**æ¸²æŸ“**æ ‘ä¸­ã€‚ä¸å¯è§çš„èŠ‚ç‚¹ä¸ä¼šæ·»åŠ åˆ°æ¸²æŸ“æ ‘ï¼Œæ¯”å¦‚cssè®¾ç½®äº†displayä¸ºnone å±æ€§çš„èŠ‚ç‚¹ã€‚

  + 4.æ ¹æ®ç”Ÿæˆçš„æ¸²æŸ“æ ‘ï¼Œè¿›è¡Œ**å¸ƒå±€**ï¼ˆä¹Ÿå¯ä»¥å«åšå›æµï¼‰ï¼Œå¾—åˆ°å„ä¸ªèŠ‚ç‚¹åœ¨é¡µé¢ä¸­çš„ç¡®åˆ‡ä½ç½®å’Œå¤§å°ã€‚ï¼ˆè‡ªåŠ¨é‡æ’ï¼‰ã€‚å¸ƒå±€é˜¶æ®µçš„è¾“å‡ºæ˜¯ä¸€ä¸ªç›’å­æ¨¡å‹ï¼Œå®ƒä¼šç²¾ç¡®åœ°æ•è·æ¯ä¸ªå…ƒç´ åœ¨å±å¹•å†…çš„ç¡®åˆ‡ä½ç½®ä¸å¤§å°ï¼Œæ‰€æœ‰ç›¸å¯¹çš„æµ‹é‡å€¼ä¹Ÿéƒ½ä¼šè¢«è½¬æ¢ä¸ºå±å¹•å†…çš„ç»å¯¹åƒç´ å€¼ï¼ˆé‡ç»˜ï¼‰ã€‚

  + 5.ç”Ÿæˆåˆ†å±‚æ ‘ï¼Œé¡µé¢éƒ½æ˜¯ä¸€å±‚ä¸€å±‚å åŠ åœ¨ä¸€èµ·å½¢æˆçš„ã€‚æ¯”å¦‚ä¸€äº›å¤æ‚çš„cssåŠ¨ç”»ï¼Œz-indexç­‰ï¼Œæ¸²æŸ“å¼•æ“ä¼šä¸ºä»–ä»¬ç”Ÿæˆä¸“ç”¨çš„å›¾å±‚ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„**å›¾å±‚æ ‘**ã€‚

  + 6.æ„å»ºå®Œå›¾å±‚ä¹‹åï¼Œæ¸²æŸ“å¼•æ“ä¼šå¯¹å›¾å±‚æ ‘ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œ**ç»˜åˆ¶**ã€‚åˆæˆçº¿ç¨‹ä¼šæŠŠåˆ†å±‚æ ‘çš„å›¾å±‚å˜æˆ**å›¾å—**ã€‚

  + 7.GPUçš„æ …æ ¼åŒ–æŠŠè§†çª—é™„è¿‘çš„å›¾å—å˜æˆä½å›¾ï¼Œç„¶åä¿å­˜åœ¨GPUçš„è¿›ç¨‹ä¸­ã€‚ï¼ˆå› ä¸ºä¸€ä¸ªé¡µé¢å¯èƒ½å¾ˆå¤§ï¼Œè€Œç”¨æˆ·åªèƒ½çœ‹åˆ°è§†å£ä¸­é¡µé¢çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœå…¨éƒ¨ç»˜åˆ¶å¼€é”€ä¼šå¾ˆå¤§ï¼Œæ‰€ä»¥åˆæˆçº¿ç¨‹ä¼šæŒ‰ç…§è§†å£é™„è¿‘çš„å›¾å—æ¥ä¼˜å…ˆç”Ÿæˆä½å›¾ï¼‰

    æ …æ ¼åŒ–å®Œæˆä¹‹åï¼Œæµè§ˆå™¨è¿›å»GPUè¿›ç¨‹é‡Œå–å‡ºé¡µé¢å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè¿™å°±å®Œæˆäº†æ¸²æŸ“é˜¶æ®µ

  + å½“ æ¸²æŸ“å™¨è¿›ç¨‹ æ¸²æŸ“ç»“æŸï¼ˆæ¸²æŸ“ç»“æŸæ„å‘³ç€è¯¥é¡µé¢å†…çš„æ‰€æœ‰çš„é¡µé¢ï¼ŒåŒ…æ‹¬æ‰€æœ‰ iframe éƒ½è§¦å‘äº† onload æ—¶ï¼‰ï¼Œä¼šå‘é€ IPC ä¿¡å·åˆ° æµè§ˆå™¨è¿›ç¨‹ï¼Œ UIçº¿ç¨‹ä¼šåœæ­¢å±•ç¤º tab ä¸­çš„ spinnerã€‚

    > **æ€»ç»“**:ç”Ÿæˆå„ç§æ ‘ï¼ŒåŒ…æ‹¬dom tree, css tree, layout tree, layer true, render treeï¼Œè¿™äº›æ˜¯`æ¸²æŸ“å™¨è¿›ç¨‹`ä¸­çš„`GUIæ¸²æŸ“çº¿ç¨‹`åšçš„äº‹ã€‚å…¶ä¸­jsè„šæœ¬çš„è§£ææ‰§è¡Œæ˜¯åŒè¿›ç¨‹ä¸‹çš„jså¼•æ“çº¿ç¨‹æ¥åšçš„ï¼Œä¹Ÿå°±æ˜¯å¤§åé¼é¼çš„`V8å¼•æ“`ã€‚è‡³äºå®šæ—¶å™¨å›è°ƒï¼Œæ˜¯`å®šæ—¶å™¨çº¿ç¨‹`æ¥è®¡æ•°ï¼Œè®¡æ•°å®Œæ¯•ä¼šæŠŠå›è°ƒæ¨å…¥äº‹ä»¶è§¦å‘çº¿ç¨‹ç»´æŠ¤çš„`ä»»åŠ¡é˜Ÿåˆ—`ï¼Œå½“jsçº¿ç¨‹ç©ºé—²å¹¶ä¸”æ­¤çº¿ç¨‹ç»´æŠ¤çš„å¾®ä»»åŠ¡é˜Ÿåˆ—æ— äº‹ä»¶ï¼Œæ‰ä¼šå»ä»»åŠ¡é˜Ÿåˆ—æ‹¿`å®ä»»åŠ¡`æ‰§è¡Œå¤„ç†ã€‚)

### 4.æµè§ˆå™¨å·¥ä½œåŸç†

> [æµè§ˆå™¨å·¥ä½œåŸç†](https://juejin.im/post/6846687590540640263#heading-29)

## 3.DOMç›¸å…³

### 1. ç²¾ç¡®è·å–é¡µé¢å…ƒç´ ä½ç½®çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ

+ `dom.getBoundingClientRect`: è¿”å› ä¸€ä¸ª`TextRectangle`å¯¹è±¡ï¼Œå³ä½¿DOMé‡Œæ²¡æœ‰æ–‡æœ¬ä¹Ÿèƒ½è¿”å›`TextRectangle`å¯¹è±¡ã€‚

+ `dom.getClientRects` : è¿”å›ä¸€ä¸ª`TextRectangle`é›†åˆï¼Œå°±æ˜¯`TextRectangleList`å¯¹è±¡ã€‚

`TextRectangle`åŒ…å«å…ƒç´ ç›¸å¯¹äºè§†å›¾çª—å£çš„å·¦ä¸Šè§’çš„ä½ç½®ï¼ˆtop, right, bottom,left, x, yï¼‰ä»¥åŠå…ƒç´ æœ¬èº«çš„å±æ€§ï¼ˆwidth, heightï¼‰ã€‚

```js
const dom = documnet.getElementById('#box');
// å…ƒç´ çš„ç›¸å¯¹ä½ç½®
let X = dom.getBoundingClientRect().left;
let Y = dom.getBoundingClientRect().top;
// è·å–æ»šåŠ¨æ¡ä½ç½®
let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
let scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft;
// å†åŠ ä¸Šæ»šåŠ¨è·ç¦»ï¼Œå°±å¯ä»¥å¾—åˆ°ç»å¯¹ä½ç½®
let X = dom.getBoundingClientRect().left + scrollLeft;
let Y = dom.getBoundingClientRect().top + scrollTop;
```

> [getClientRects() å’Œ getBoundingClientRect() çš„ç”¨æ³•å’ŒåŒºåˆ«](https://www.webhek.com/post/getclientrects-getboundingclientrect.html)
>
> [ç”¨Javascriptè·å–é¡µé¢å…ƒç´ çš„ä½ç½®](http://www.ruanyifeng.com/blog/2009/09/find_element_s_position_using_javascript.html)

## 4.JSç›¸å…³

### 1.æ­£åˆ™ä»`2018-10-07T11:48:47 Asia/zh-cn` æå–å‡ºæ¥ç»“æœ`[2018,10,07,11,48,47]`

```js
const date = new Date().toString();
// è¿”å›åŒ¹é…çš„æ•°ç»„
const ans = date.match(/\d+/g); 
// æƒ°æ€§ï¼šè¿”å›RegExpStringIterator
const ans = date.matchAll(/\d+/); 
```

### 2.å¦‚ä½•åˆ¤æ–­objectæ˜¯æ•°ç»„ç±»å‹ï¼Ÿ

```js
alert(typeof 1);                // è¿”å›å­—ç¬¦ä¸²"number" 
alert(typeof "1");              // è¿”å›å­—ç¬¦ä¸²"string" 
alert(typeof true);             // è¿”å›å­—ç¬¦ä¸²"boolean" 
alert(typeof {});               // è¿”å›å­—ç¬¦ä¸²"object" 
alert(typeof []);               // è¿”å›å­—ç¬¦ä¸²"object " 
alert(typeof function(){});     // è¿”å›å­—ç¬¦ä¸²"function" 
alert(typeof null);             // è¿”å›å­—ç¬¦ä¸²"object" 
alert(typeof undefined);        // è¿”å›å­—ç¬¦ä¸²"undefined"
alert(typeof Symbol());        // è¿”å›å­—ç¬¦ä¸²""symbol""
```

+ ä»åŸå‹å…¥æ‰‹ï¼Œ`Array.prototype.isPrototypeOf(obj)`;åˆ©ç”¨`isPrototypeOf()`æ–¹æ³•ï¼Œåˆ¤å®šArrayæ˜¯ä¸æ˜¯åœ¨objçš„åŸå‹é“¾ä¸­ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å›true,å¦åˆ™falseã€‚
+ ä»åŸå‹å…¥æ‰‹ï¼Œ`Object.prototype.toString.call(obj) === '[object Array]'`

+ `Array.isArray()`æ–¹æ³•

### 3.æ‰‹åŠ¨å®ç°composeå’Œpipeå‡½æ•°

```js
// ä½¿ç”¨reduceå®ç°
const compose = (...args) => value => args.reduceRight((acc, fn) => fn(acc), value);
const pipe = (...args) => value => args.reduce((acc, fn) => fn(acc), value);
```

```js
// åŸç”Ÿå®ç°composeä»å³å¾€å·¦æ‰§è¡Œ
function compose() {
    var fns = [].slice.call(arguments);
    return function(value) {
        var res = value;
        for(var i=fns.length - 1; i>=0;i--) {
            res = fns[i](res);
        }
        return res;
    }
}
//pipeä»å·¦å¾€å³æ‰§è¡Œ
function pipe() {
    var fns = [].slice.call(arguments);
    return function(value) {
        var res = value;
        for(var i=0; i<fns.length;i++) {
            res = fns[i](res);
        }
        return res;
    }
}
```

> [å®ç°composeçš„äº”ç§æ€è·¯](https://segmentfault.com/a/1190000011447164)

### 4. å®ç°add(1)(2)(3)(4) è¾“å‡º 10(**å‡½æ•°æŸ¯é‡ŒåŒ–**)

> [toString && valueOf && Symbol.toPrimitive è¾¨æ](https://juejin.im/post/6844903813749407752)
>
> [èŠä¸€èŠvalueOfå’ŒtoString](https://juejin.im/post/6844903967097356302)
>
> [ç”±Object.prototype.toString.call( )å¼•å‘å…³äºtoString( )æ–¹æ³•çš„æ€è€ƒ](https://juejin.im/post/6844903604990509063)
>
> [How can I make var a = add(2)(3); //5 work?](https://stackoverflow.com/questions/2272902/how-can-i-make-var-a-add23-5-work)
>
> [toString()çš„å‡ ç§ç”¨æ³•](https://juejin.im/post/6844903897618710541)

```js
// add(1)(2) = 3
const add = (a, b) => a + b;
const add2 = a => b => a + b;

// å¤šå€‹
function add(x) {
    return function(y) {
        if (typeof y !== 'undefined') {
            x = x + y;
            return arguments.callee;
        } else {
            return x;
        }
    };
}

// add(1)(2)(3)(4)()

function add(n){
  var addNext = function(x) {
    return add(n + x);
  };

  addNext.valueOf = function() {
    return n;
  };

  return addNext;
}

// more
function add(a, b){
 return a && b ? a+b : function(c){return a+c;}
}

console.log(add(2, 3));
console.log(add(2)(3));

```

```js
add(1) // 1
add(1)(2) //3
add(1)(2)(3) // 6
add(1,2)(3) // 6
add(1,2,3) // 6

function add(...args) {
    let _add = function(..._args) {
        return add.apply(null, [...args, ..._args]);
    }
    _add.toString = function() {
        return args.reduce((a, b) => a+b)
    }
    return _add;
}
```



> [å‰ç«¯ç»å…¸é¢è¯•é¢˜è§£å¯†-add(1)(2)(3)(4) == 10åˆ°åº•æ˜¯ä¸ªå•¥ï¼Ÿ](https://blog.csdn.net/qfluohao/article/details/105602707)

å®ç°æŸ¯é‡ŒåŒ–å‡½æ•°ï¼š

```js
function curry(fn, ...ars) {
    function curried(..._args) {
        return curry.call(null, fn, ...args, ..._args);
    }
	// é‡å†™toString
    curried.toString = function() {
        return fn.aply(null, args);
    }
    // è¿”å›ä¸€ä¸ªæ–°å‡½æ•°
    return curried;
}


// ä½¿ç”¨
const dynamicAdd = (...args) => args.reduce((prev, curr) => prev + curr, 0);
const curriedAdd = curry(dynamicAdd);
```



### 5.æ±‚1234567890.32æ ¼å¼åŒ–ä¸ºï¼š1,234,567,890.32ã€‚

> [æŠŠä¸€ä¸²æ•°å­—è¡¨ç¤ºæˆåƒä½åˆ†éš”å½¢å¼â€”â€”JSæ­£åˆ™è¡¨è¾¾å¼çš„åº”ç”¨](https://juejin.im/post/6844903584031571975)

```js
let n = 1234567890.32;
// æœ€ç®€æ´
n.toLocaleString()

// æ­£åˆ™
// åœ¨\då‰é¢åŠ ä¸€ä¸ªéå•è¯è¾¹ç•Œ\Bï¼Œç”¨æ¥è¡¨ç¤ºæ‰€åŒ¹é…çš„è¿™ä¸ªç©ºåé¢ä¸èƒ½æ˜¯ä¸€ä¸ªå•è¯è¾¹ç•Œ
let reg = /(?=(\B\d{3})+$)/g;
let str = '' + n;
str.replace(reg, ",")
```

### 6.ã€å¦‚ä½•ç†è§£JavaScriptåŸå‹é“¾

- JavaScriptä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª__proto__å±æ€§ï¼ˆå‡½æ•°å¯¹è±¡å³æœ‰__proto__ï¼Œåˆæœ‰prototypeï¼ŒprototypeæŒ‡å‘è‡ªå·±çš„åŸå‹è€Œ__proto__æŒ‡å‘çˆ¶çº§çš„åŸå‹ï¼‰æˆ‘ä»¬ç§°ä¹‹ä¸ºåŸå‹ï¼Œè€ŒåŸå‹çš„å€¼ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å®ƒä¹Ÿæœ‰è‡ªå·±çš„åŸå‹ï¼Œè¿™æ ·å°±ä¸²è”èµ·æ¥äº†ä¸€æ¡åŸå‹é“¾ï¼ŒåŸå‹é“¾çš„é“¾å¤´æ˜¯Object.prototype.__proto_,å®ƒçš„å€¼æ¯”è¾ƒç‰¹æ®Šï¼Œå€¼ä¸ºnullã€‚
- åŸå‹é“¾çš„ä½œç”¨æ˜¯ç”¨äºå¯¹è±¡ç»§æ‰¿ï¼Œå‡½æ•°Açš„åŸå‹å±æ€§(prototype property)æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå½“è¿™ä¸ªå‡½æ•°è¢«ç”¨ä½œæ„é€ å‡½æ•°æ¥åˆ›å»ºå®ä¾‹æ—¶ï¼Œè¯¥å‡½æ•°çš„åŸå‹å±æ€§å°†è¢«ä½œä¸ºåŸå‹èµ‹å€¼ç»™æ‰€æœ‰å¯¹è±¡å®ä¾‹ï¼Œæ¯”å¦‚æˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„æ–¹æ³•ä¾¿ä»æ•°ç»„çš„åŸå‹ä¸Šç»§æ‰¿è€Œæ¥ã€‚
-  å½“è®¿é—®å¯¹è±¡çš„ä¸€ä¸ªå±æ€§æ—¶, é¦–å…ˆæŸ¥æ‰¾å¯¹è±¡æœ¬èº«, æ‰¾åˆ°åˆ™è¿”å›; è‹¥æœªæ‰¾åˆ°, åˆ™ç»§ç»­æŸ¥æ‰¾å…¶åŸå‹å¯¹è±¡çš„å±æ€§(å¦‚æœè¿˜æ‰¾ä¸åˆ°å®é™…ä¸Šè¿˜ä¼šæ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾, ç›´è‡³åˆ°æ ¹). åªè¦æ²¡æœ‰è¢«è¦†ç›–çš„è¯, å¯¹è±¡åŸå‹çš„å±æ€§å°±èƒ½åœ¨æ‰€æœ‰çš„å®ä¾‹ä¸­æ‰¾åˆ°ï¼Œè‹¥æ•´ä¸ªåŸå‹é“¾æœªæ‰¾åˆ°åˆ™è¿”å›undefinedï¼›

### 7.ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ

> [æŒæ¡JavaScripté¢è¯•ï¼šä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ](https://juejin.im/post/6874829017006997511)

### 8.ES6è½¬ä¸ºES5çš„è¿‡ç¨‹ï¼Ÿ

ES6 è½¬ ES5 ç›®å‰è¡Œä¸šæ ‡é…æ˜¯ç”¨ Babelï¼Œè½¬æ¢çš„å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š

1. è§£æï¼šè§£æES6ä»£ç å­—ç¬¦ä¸²ï¼Œç”Ÿæˆ AST
2. è½¬æ¢ï¼šæŒ‰ä¸€å®šçš„è§„åˆ™è½¬æ¢ã€ä¿®æ”¹ AST
3. ç”Ÿæˆï¼šå°†ä¿®æ”¹åçš„ AST è½¬æ¢æˆæ™®é€šES5ä»£ç 

**å®ç°ï¼šå°† `let` è½¬æ¢ä¸º `var`**ï¼š

```js
// example.js

let a = 3; 
let b = 2;
console.log(a + b);


// app.js
const fs = require('fs');
const acorn = require('acorn'); //å°†JSä»£ç è½¬åŒ–ä¸ºè¯­æ³•æ ‘æ¨¡å—
const walk = require('acorn-walk'); //JSè¯­æ³•æ ‘éå†å„èŠ‚ç‚¹
const escodegen = require('escodegen'); //å°†JSè¯­æ³•æ ‘åç¼–è¯‘æˆjsä»£ç æ¨¡å—


// 1. è·å–JSä»£ç 
let code = fs.readFileSync('./example.js');
// 2. ç”¨acornå°†ä»£ç è§£æä¸ºè¯­æ³•æ ‘ast
let ast = acorn.parse(code, {
    ranges: true
});
// 3. ç”¨walkæ“ä½œè¯­æ³•æ ‘astï¼Œè¾“å‡ºnode.value
walk.simple(ast, {
    VariableDeclaration(node) {
        if(node.kind === 'let'){  
            node.kind = 'var'; // æŠŠlet å˜æˆ var
        }
    }
})

fs.writeFileSync('result.json', JSON.stringify(ast));  // å°†ä¿®æ”¹åçš„è¯­æ³•æ ‘astå­˜å‚¨ä¸ºresult.jsonæ–‡ä»¶
fs.writeFileSync('result.js', escodegen.generate(ast, {comment: true})); // ç”¨escodegenå°†è¯­æ³•æ ‘è½¬æ¢ä¸ºæœ€ç»ˆä»£ç ï¼Œå¹¶å­˜å‚¨ä¸ºresult.js
// result.js
var a = 3;
var b = 2;
console.log(a + b);
```

**çŸ¥è¯†ç‚¹å»¶ä¼¸ï¼š**

**Acorn**

`acorn`æ˜¯å¸¸ç”¨çš„ä¸€ä¸ª JS è§£æå™¨ï¼Œå¸¸ç”¨åˆ°çš„è¿˜æœ‰ä¸€ä¸ª `Esprima`ï¼Œacornåœ¨å®ƒä¹‹åè¯ç”Ÿï¼Œä¸¤è€…ç›¸æ¯”ï¼Œ`acorn`å®ç°ä»£ç æ›´å°‘ï¼Œé€Ÿåº¦å’Œ`Esprima`ç›¸å·®æ— å‡ ã€‚

äºŒè€…éƒ½éµå¾ª `The Estree Spec` è§„èŒƒï¼Œä¹Ÿå°±æ˜¯å¾—åˆ°çš„ç»“æœåœ¨å¾ˆå¤§éƒ¨åˆ†ä¸Šæ˜¯å…¼å®¹çš„ã€‚å¯¹ `ECMAScript` æ¥è¯´ï¼Œç¤¾åŒºæœ‰ä¸€ä¸ª AST è§„èŒƒï¼šï¼š[ESTree Spec](https://github.com/estree/estree)

**è§£æ javascript çš„ä¸‰ä»¶å¥—: `acorn`ã€`acorn-walk`ã€`escodegen`**ã€‚

AST èŠ‚ç‚¹æ˜¯æŒ‰ç…§å¦‚ä¸‹çš„æ ¼å¼å®šä¹‰çš„ï¼š

```
interface Node {
    type: string;
    loc: SourceLocation | null;
}
```

**åº”ç”¨ä¸¾ä¾‹ï¼š**

1. `webpack`æ˜¯ä½¿ç”¨`acorn`ä½œä¸ºè‡ªå·±çš„`Parser`çš„åŸºç¡€åº“ã€‚
2. `babel`, `babylon.js`ä¹Ÿæ˜¯forkçš„`acorn`å®ç°çš„.

æœ€åæ¨èä¸€ä¸ªåœ¨çº¿å®æ—¶æŸ¥çœ‹ASTçš„ç½‘ç«™ï¼šhttps://astexplorer.net/

## 5.ç¼–ç¨‹ç›¸å…³

> [32ä¸ªæ‰‹æ’•JSï¼Œå½»åº•æ‘†è„±åˆçº§å‰ç«¯ï¼ˆé¢è¯•é«˜é¢‘ï¼‰](https://juejin.im/post/6875152247714480136#heading-45)

### 1.å·²çŸ¥æ•°æ®ç»“æ„`users`ï¼Œè¯·å®ç°è¯­æ³•æ”¯æŒ`user.unique`èƒ½å¤ŸæŒ‰ç…§`name`å­—æ®µå»é‡ï¼Œå¹¶è¾“å‡ºç»“æ„ä¸ºï¼š`[â€œaâ€,â€œbâ€ï¼Œâ€œc"]`

```js
var users=[{
   id:1,name:"a"
},{
   id:2,name:"a"
},{
   id:3,name:"b"
},{
   id:4,name:"c"
}]
```

```js
// è¦æ”¯æŒuser.uniqueè¯­æ³•ï¼Œéœ€è¦åœ¨æ•°ç»„åŸå‹ä¸Šåšæ–‡ç« 
Array.prototype.unique = function(key = '') {
    if(!key) return [...new Set(this)];
   return [...new Set(this.map(d => d[key]))];
}

```

```js
 // ä½¿ç”¨`reduce`:
Array.prototype.unique = function(key = '') {
   if(!key) return [...new Set(this)];
   return this.reduce((accumulator, currentValue) => {
       if(!accumulator.includes(currentValue[key])) {
            accumulator.push(currentValue[key]);
       }
       return accumulator;
   }, []);
}

users.unique(key)
```

### 2.å·²çŸ¥å¦‚ä¸‹å¯¹è±¡ï¼Œè¯·åŸºäº`es6`çš„`proxy`æ–¹æ³•è®¾è®¡ä¸€ä¸ªå±æ€§æ‹¦æˆªè¯»å–æ“ä½œçš„ä¾‹å­ï¼Œè¦æ±‚å®ç°å»è®¿é—®ç›®æ ‡å¯¹è±¡`example`ä¸­ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯ï¼š`Property â€œ$(property)â€ does not exist`

```js
const man={
    name:'jscoder',
    age:22
}
 //è¡¥å…¨ä»£ç 
const proxy = new Proxy(...)
proxy.name //"jscoder"
proxy.age //22
proxy.location //Property "$(property)" does not exist
```

```js
const proxy = new Proxy(obj, {
    // getteræ‹¦æˆª
    get: function(target, property) {
        if(property in target) {
            return target[property];
        } else {
            throw new Error(`Property $(property) does not exist.`);
        }
    },
    // setteræ‹¦æˆª
    set: function(target, property, value) {
        target[property] = value;
    },
    has:function() {
        console.log('inæ“ä½œç¬¦çš„æ‹¦æˆª')
    },
    deleteProperty: function(){
        console.log('deleteæ“ä½œç¬¦çš„æ‹¦æˆª')
    },
})
```

+ è€ƒç‚¹`es6`çš„`Proxy` å®ä¾‹çš„æ–¹æ³•

```js
const p = new Proxy(target, handler)
```

`Proxy.revocable()` æ–¹æ³•å¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªå¯æ’¤é”€çš„ä»£ç†å¯¹è±¡ã€‚`Proxy.revocable(target, handler);`

> [Proxy](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy)

### 3.ç»™å‡ºå¦‚ä¸‹è™šæ‹Ÿdomçš„æ•°æ®ç»“æ„ï¼Œå¦‚ä½•å®ç°ç®€å•çš„è™šæ‹Ÿdomï¼Œæ¸²æŸ“åˆ°ç›®æ ‡domæ ‘

```js
//æ ·ä¾‹æ•°æ®
let demoNode = ({
    tagName: 'ul',
    props: {'class': 'list'},
    children: [
        ({tagName: 'li', children: ['douyin']}),
        ({tagName: 'li', children: ['toutiao']})
    ]
});
```

æ„å»ºä¸€ä¸ªrenderå‡½æ•°ï¼Œå°†demoNodeå¯¹è±¡æ¸²æŸ“ä¸ºä»¥ä¸‹dom:

```html
<ul class="list">
    <li>douyin</li>
    <li>toutiao</li>
</ul>
```

é€šè¿‡JavaScriptï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æ„å»ºå®ƒï¼Œå¦‚ä¸‹ï¼š

```js
var elem = Element({
    tagName: 'ul',
    props: {'class': 'list'},
    children: [
        Element({tagName: 'li', children: ['item1']}),
        Element({tagName: 'li', children: ['item2']})
    ]
});
```

ä¸‹é¢å®ç°Elementç±»ï¼š

Elementä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªElementå¯¹è±¡ã€‚ä¸ºäº†æ›´æ¸…æ™°çš„å‘ˆç°è™šæ‹ŸDOMç»“æ„ï¼Œæˆ‘ä»¬çœç•¥äº†newï¼Œè€Œåœ¨Elementä¸­å®ç°

```js
function Element({tagName, props, children}) {
    if (!(this instanceof Element)) {
        return new Element({tagName, props, children});
    }
	this.tagName = tagName;
	this.props = props;
	this.children = children;
}
```

ç°åœ¨å¯ä»¥é€šè¿‡Elementæˆ‘ä»¬å¯ä»¥ä»»æ„åœ°æ„å»ºè™šæ‹ŸDOMæ ‘ï¼Œé‚£ä¹ˆæ€ä¹ˆè½¬ä¸ºçœŸæ­£çš„DOMå‘¢ï¼Ÿ

å¯ä»¥é€šè¿‡DOMæ“ä½œï¼Œ`createElement`åˆ›å»ºå…ƒç´ èŠ‚ç‚¹ï¼Œ`createTextNode`åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹ï¼š

```js
// ä½¿ç”¨DFS
Element.prototype.render = function() {
    // åˆ›å»ºçˆ¶èŠ‚ç‚¹
    let el = document.createElement(this.tagName);
    for(let propName in this.props) {
        el.setAttribute(propName, this.props[propName]);
    }
    // éå†å­èŠ‚ç‚¹ -ã€‹ å­èŠ‚ç‚¹-ã€‹...
    this.children.forEach(function(child) {
        let childEl = null;
        // æ˜¯Elementç±»
        if(child instanceof Element) {
            childEl = child.render();
        // ä¸æ˜¯Elementç±»ï¼Œä½†æ˜¯{tagName, props, children}
        } else if (child.tagName) {
           childEl = Element(child).render();        
        } else {
           childEl = document.createTextNode(JSON.stringfy(child));
        }
        el.appendChild(childEl);
    });
    return el;
}
```

### 4. æ‰‹å†™æ·±æ‹·è´

```js
function deepClone(value) {
    if(value === null) return value;
    if(typeof value !== 'object') return value;
    if(value instanceof RegExp) return new RegExp(value);
    if(value instanceof Date) return new Date(value);
    // [] æˆ–è€…{}
    let obj = new value.constructor();
    // ä½¿ç”¨for ... inéå†è‡ªèº«å±æ€§
    for(let key in value) {
        // åªæ‹·è´å¯¹è±¡è‡ªèº«çš„å±æ€§
        if(value.hasOwnProperty(key)) {
            // é€’å½’è°ƒç”¨
             obj[key] = deepClone(value[key]);
        }
    }
    return obj;
}
```

### 5.æ‰‹å†™æ•°ç»„æ‰å¹³åŒ–

> [æ•°ç»„å¤šç»´è½¬ä¸€ç»´åº¦ï¼ˆæ‰å¹³åŒ–ï¼‰çš„6ç§æ–¹æ³•](https://juejin.im/post/6850037272964759566)

```js
function flatten(arr, depth=1) {
   if(depth > 0) {
       return arr.reduce((acc, cur) => {
           return acc.concat(Array.isArray(cur) ? flatten(cur, depth-1) : cur)
       }, [])
   } else {
       return arr;
   }
}
```

### 6.æ‰‹å†™newæ“ä½œç¬¦

é¦–å…ˆï¼Œç†è§£newæ“ä½œç¬¦å¹²äº†ä»€ä¹ˆï¼Ÿ

1. åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡
2. å°†thisæŒ‡å‘æ–°å¯¹è±¡
3. å°†åˆ›å»ºçš„å¯¹è±¡çš„åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹
4. è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœæ„é€ å‡½æ•°æœ¬èº«æœ‰è¿”å›å€¼å¹¶ä¸”è¿”å›çš„ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆå°±è¿”å›è¿™ä¸ªè¿”å›å€¼ï¼Œå¦åˆ™å¦ä¼šåˆ›å»ºçš„å¯¹è±¡ã€‚

```js
function _new(fn, ...args) {
    // åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡çš„__proto__æŒ‡å‘fnçš„ptototype
    let obj = Object.create(fn.prototype);
    // å°†fnçš„thisæŒ‡å‘objï¼Œå¹¶è·å–è¿”å›å€¼
    let ret = fn.apply(obj, args);
    // å¦‚æœfnè¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå°±è¿”å›è¿™ä¸ªå¯¹è±¡ï¼Œå¦åˆ™è¿”å›åˆšåˆ›å»ºçš„å¯¹è±¡
    return Object.prototype.toString.call(ret) === '[Object Object]' ? ret : obj;
}
```



### 7.æ‰‹å†™å¯¹è±¡ç»§æ‰¿

### 8. æ‰‹å†™é˜²æŠ–

+ ç®€å•å®ç°

```js
function debounce(fn, wait) {
    let timer = null;
    return function(..args) {
        clearTimeout(timer);
        timer = setTimeout(() => {
            fn.apply(this, args);
        }, wait);
    };
};
```

+ æ§åˆ¶ç«‹å³æ‰§è¡Œ

```js
function debounce(fn, wait=200, immediate=true) {
    let timer = null;
    return function(...args) {
        if(immediat) {
            fn.apply(this, args)
        }
        clearTimeout(timer);
        timer = setTimeout(() => {
            fn.apply(this, args)
        }, wait)
    }
}
```

### 9.æ‰‹å†™èŠ‚æµ

+ ç®€å•å®ç°

```js
// å®šæ—¶å™¨ç‰ˆ
function throttle() {
    let timer = null;
    return function(...args) {
        if(timer) return;
        timer = setTimeout(() => {
            fn.call(this, ...args);
            timer = null;
        }, wait);
    };
};

// æ—¶é—´æˆ³ç‰ˆ
const throttle = (func, wait) => {
  let last = 0;
  return (...args) => {
    const current_time = +new Date();
    if (current_time - last_time > wait) {
      func.apply(this, args);
      last_time = +new Date();
    }
  };
};
```

+ èŠ‚æµæˆ–é˜²æŠ–åˆ‡æ¢

```js
function throttleOrDebounce(fn, wait, isDebounce=true) {
    let timer = null;
    let prev = 0;
    return function(..args) {
        if(isDebounce) {
           if(timer) clearTimeout(timer);
           timer = setTimeout(() => {
               fn.apply(this, ...args);
           }, wait)
        } else {
            const now = +new Date();
            if(now - prev < wait) return;
            prev = now;
            fn.apply(this, args);
        }
    }
}
```

### 10. æ‰‹å†™call

+ ç®€æ˜“ç‰ˆï¼ˆä¸è€ƒè™‘contextéå¯¹è±¡æƒ…å†µï¼Œä¸è€ƒè™‘Symbol\BigInt ä¸èƒ½ new.constructor( context )æƒ…å†µï¼‰

```js
Function.prototype._call = function(context, ...args) {
    // null,undefined,ç©º --- contextä¸ºwindow
    context = context == null ? window : context;
    
    // å°†è¦è¢«æ›¿æ¢çš„fnæ”¾å…¥contextä¸­
    context['fn'] = this;
    // æ­¤æ—¶æ‰§è¡Œfn,å…¶thisè‡ªç„¶æŒ‡å‘äº†context
    const ret = context['fn'](...args);
    // ç”¨å®Œå¸è½½
    delete context['fn'];
    // è¿”å›æ‰§è¡Œç»“æœ
    return ret;
}
```

+ å®Œå–„ç‰ˆï¼ˆcontextå¿…é¡»å¯¹è±¡ç±»å‹ï¼Œå…¼å®¹Symbolç­‰æƒ…å†µï¼‰

```js
Function.prototype._call = function(context, ...args) {
    // null,undefined,ç©º --- contextä¸ºwindow
    context = context == null ? window : context;
    
    // å¿…é¡»ä¿è¯ context æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹
  	let contextType = typeof context;
    if (!/^(object|function)$/i.test(contextType)) {
   	 	// context = new context.constructor(context); // ä¸é€‚ç”¨äº Symbol/BigInt
    	context = Object(context);
    }

    // å°†è¦è¢«æ›¿æ¢çš„fnæ”¾å…¥contextä¸­
    context['fn'] = this;
    // æ­¤æ—¶æ‰§è¡Œfn,å…¶thisè‡ªç„¶æŒ‡å‘äº†context
    const ret = context['fn'](...args);
    // ç”¨å®Œå¸è½½
    delete context['fn'];
    // è¿”å›æ‰§è¡Œç»“æœ
    return ret;
}
```

### 11. æ‰‹å†™apply

åŸç†ï¼š åˆ©ç”¨å‡½æ•°é€šè¿‡`obj.func()`æ‰§è¡Œçš„æ–¹å¼ï¼Œå°†å‡½æ•°çš„thisæŒ‡å‘è¿™ä¸ªå¯¹è±¡ã€‚

```js
Function.prototype._apply = function(context, ...args) {
     context = context == null ? window : context;
    let contextType = typeof context;
  	if (!/^(object|function)$/i.test(contextType)) {
        // Objectä¼šå°†contextåŒ…è£…æˆå¯¹åº”çš„åŒ…è£…å¯¹è±¡
    	context = Object(context);
    }
    
    context['fn'] = this;
    // æ­¤å¤„å‚æ•°æ˜¯ä¸callçš„åŒºåˆ«
    let ret = context['fn'](args);
    delete context['fn'];
    
    return ret;
}
```

### 12. æ‰‹å†™bind

```js
Function.prototype._bind = function(context, ...args) {
    // ç¼“å­˜è¦å¤„ç†å‡½æ•°çš„this
    let this = that;
    return function(...args) {
        that.call(context, ...args);
        // æˆ–è€…
        // that.apply(context, args);
        // æˆ–è€…åœ¨è¿™é‡Œæ‰‹åŠ¨å®ç°call/apply
    }
}
```

### 13.æ‰‹å†™Promise

> [æœ€è¯¦ç»†çš„Promiseæºç å®ç°ï¼Œå†è¢«é¢è¯•é—®åˆ°è½»æ¾è§£ç­”](https://juejin.im/post/6860037916622913550)

## 6.å‰ç«¯å·¥ç¨‹åŒ–ç›¸å…³

### 6.1 babelè½¬æ¢ES6è¯­æ³•å·¥ä½œåŸç†
1. parsingé˜¶æ®µï¼šå°†ES6ä»£ç é€šè¿‡`babylon`è§£æï¼Œç”ŸæˆASTã€‚
2. transformingé˜¶æ®µï¼šç”¨`babel-transverse`å°†ä¸Šè¿°ES6çš„ASTè¿›è¡Œéå†è½¬è¯‘ä¸ºES5çš„ASTã€‚
3. generatingé˜¶æ®µï¼šç”¨`babel-generating`å°†ES5çš„ASTç”ŸæˆES5ä»£ç ã€‚

## 7.ç®—æ³•ç›¸å…³

### 1.äºŒè¿›åˆ¶

#### 	1.åˆ¤æ–­ä¸€ä¸ªæ•´æ•°è½¬æ¢æˆäºŒè¿›åˆ¶å1çš„ä¸ªæ•°

+ å–å·§

```js
function ChargeOnesCountInNum(num) {
    return num.toString(2).split('1').length - 1;
}
```

+ å¸¸è§„

```js
function ChargeOnesCountInNum(num) {
    let count = 0;
    num = Math.abs(num);
    while(num > 0) {
       if(num % 2 > 0)  count++;
        num = Math.floor(num / 2);
    }
    return count;
}
```

+ å³ä½ç§»

å…ˆå°†æ•´æ•°è½¬æ¢æˆæ­£æ•´æ•°ï¼Œå†å°†è¯¥æ•°ä¸1è¿›è¡Œä¸è¿ç®—ã€‚è‹¥ä¸å°†æ•´æ•°åšå–ç»å¯¹å€¼å¤„ç†ï¼Œå½“è¾“å…¥çš„æ•°æ˜¯è´Ÿæ•°æ—¶ï¼Œæ¯å‘å³ç§»åŠ¨ä¸€ä½ï¼Œé«˜ä½ä¼šè‡ªåŠ¨è¡¥1ï¼Œå°±ä¼šå¯¼è‡´æ­»å¾ªç¯ã€‚
```js{8}
function ChargeOnesCountInNum(num) {
    let count = 0;
    num = Math.abs(num);
    while(num > 0) {
        // & è¿ç®—
       if(num & 1)  count++;
        // å‘å³ç§»åŠ¨ä¸€ä½
        num = num >> 1;
    }
    return count;
}
```

+ å·¦ä½ç§»

```js {5,6,7}
function ChargeOnesCountInNum(num) {
    let count = 0;
    let flag = 1;
    num = Math.abs(num);
    while(flag < num) {
       if(num & flag)  count++;
        flag = flag << 1;
    }
    return count;
}
```

+ ä¸è¿ç®—

å°†ä¸€ä¸ªæ•´æ•°å‡å»1ä¹‹åï¼Œå…¶å¯¹åº”çš„äºŒè¿›åˆ¶ä¸­æœ€å³è¾¹çš„ä¸€ä¸ª1ä¼šå˜ä¸º0ï¼Œè‹¥å…¶åå­˜åœ¨0ï¼Œåˆ™å…¶ä¹‹åçš„æ‰€æœ‰0éƒ½ä¼šå˜ä¸º1ã€‚åŸºäºæ­¤ï¼Œè®¾ä¸€ä¸ªæ•´æ•°ä¸ºnï¼Œåˆ™ n & (n-1)ä¹‹åï¼Œä¼šæ¶ˆæ‰nå¯¹åº”çš„äºŒè¿›åˆ¶çš„æœ€å³è¾¹çš„1ã€‚å› æ­¤ï¼Œå°†ä¸€ä¸ªæ•°ä¸­æ‰€æœ‰1æ¶ˆæ‰æ‰€ç”¨çš„æ¬¡æ•°ï¼Œå³ä¸ºè¯¥æ•´æ•°å¯¹åº”çš„äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°ã€‚
```js {6}
function ChargeOnesCountInNum(num) {
    let count = 0;
    num = Math.abs(num);
    while(num > 0) {
       count++;
       num = num & (num - 1);
    }
    return count;
}
```

+ ç›¸å…³çš„å˜å½¢é—®é¢˜

    - ç”¨ä¸€æ¡è¯­å¥åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯ä¸æ˜¯2çš„æ•´æ•°æ¬¡æ–¹ã€‚å‚è€ƒç­”æ¡ˆï¼š`if(!(num & (num-1))){}`
    - è¾“å…¥ä¸¤ä¸ªæ•´æ•°må’Œnï¼Œè®¡ç®—må’Œnå¯¹åº”çš„äºŒè¿›åˆ¶ä¸­æœ‰å¤šå°‘ä¸ªä¸åŒçš„ä½ã€‚å‚è€ƒæ€è·¯ï¼šå…ˆå¯¹må’Œnè¿›è¡Œå¼‚æˆ–ï¼Œç„¶åè®¡ç®—å¼‚æˆ–åçš„äºŒè¿›åˆ¶ç»“æœä¸­1çš„ä¸ªæ•°ã€‚

### 2. åŠ¨æ€è§„åˆ’

> [åŠ¨æ€è§„åˆ’ä»å…¥é—¨åˆ°ç²¾é€šç³»åˆ—](https://blog.csdn.net/weixin_38278878/category_7611260.html)
>
> [ç»å…¸ä¸­çš„ç»å…¸ç®—æ³•:åŠ¨æ€è§„åˆ’(è¯¦ç»†è§£é‡Š,ä»å…¥é—¨åˆ°å®è·µ,é€æ­¥è®²è§£)](https://blog.csdn.net/ailaojie/article/details/83014821)

#### 1.è·³å°é˜¶é—®é¢˜

+ **æ™®é€šè·³å°é˜¶é—®é¢˜(è²æ³¢é‚£åˆ‡æ•°åˆ—)**

  ä¸€åªé’è›™ä¸€æ¬¡å¯ä»¥è·³ä¸Š1çº§å°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸Š2çº§å°é˜¶ã€‚æ±‚è¯¥é’è›™è·³ä¸Šä¸€ä¸ªnçº§å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ã€‚

| n    | dp(n)           |
| ---- | --------------- |
| 1    | 1               |
| 2    | 2               |
| 3    | 3               |
| ...  | ...             |
| n    | f(n-1) + f(n-2) |

```js
// O(n) = 2^n
function dp(n) {
    if(n<2) return n;
    return dp(n-1) + dp(n-2);
}
```

ä¼˜åŒ–(åˆ©ç”¨ç¼“å­˜)ï¼š

```js
function dp(n) {
   if(n<2) return n;
   let f = 1;
   let g = 1;
   while(n--) {
       g = g + f;
       f = g - f;
   }
   return f 
}

// æˆ–è€…
function dp(n, pre=1, next=1) {
    if (n < 2) {
        return next;
    } else {
        return dp(n - 1, next, pre + next)
    }
}
```

+ **æ‹“å±•ï¼šå˜æ€è·³å°é˜¶é—®é¢˜**

é¢˜ç›®ï¼šä¸€ä¸ªå°é˜¶æ€»å…±æœ‰nçº§ï¼Œå¦‚æœä¸€æ¬¡å¯ä»¥è·³1çº§ï¼Œä¹Ÿå¯ä»¥è·³2çº§......å®ƒä¹Ÿå¯ä»¥è·³ä¸Šnçº§ã€‚æ­¤æ—¶è¯¥é’è›™è·³ä¸Šä¸€ä¸ªnçº§çš„å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ï¼Ÿ

åˆ†æï¼šç”¨f(n)è¡¨ç¤ºé’è›™è·³ä¸Šné˜¶å°é˜¶çš„è·³æ³•æ•°ï¼Œè®¾å®šf(0) = 1;

å½“n = 1 æ—¶ï¼Œåªæœ‰ä¸€ç§è·³çš„æ–¹å¼ï¼Œä¸€é˜¶è·³ï¼Œf(1) = 1

å½“n = 2 æ—¶ï¼Œæœ‰ä¸¤ç§è·³çš„æ–¹å¼ï¼Œä¸€é˜¶è·³å’Œä¸¤é˜¶è·³ï¼Œf(2) = f(1) + f(0) = 2

å½“n = 3 æ—¶ï¼Œæœ‰ä¸‰ç§è·³çš„æ–¹å¼ï¼Œç¬¬ä¸€æ¬¡è·³å‡ºä¸€é˜¶åï¼Œåé¢è¿˜æœ‰f(3-1)ä¸­è·³æ³•ï¼› ç¬¬ä¸€æ¬¡è·³å‡ºäºŒé˜¶åï¼Œåé¢è¿˜æœ‰f(3-2)ä¸­è·³æ³•ï¼›ç¬¬ä¸€æ¬¡è·³å‡ºä¸‰é˜¶åï¼Œåé¢è¿˜æœ‰f(3-3)ä¸­è·³æ³•ï¼Œf(3) = f(2) + f(1) + f(0) = 4

å½“n = n æ—¶ï¼Œç¬¬ä¸€æ¬¡è·³å‡ºä¸€é˜¶åï¼Œåé¢è¿˜æœ‰f(n-1)ä¸­è·³æ³•ï¼› ç¬¬ä¸€æ¬¡è·³å‡ºäºŒé˜¶åï¼Œåé¢è¿˜æœ‰f(n-2)ä¸­è·³æ³•......ç¬¬ä¸€æ¬¡è·³å‡ºné˜¶åï¼Œåé¢è¿˜æœ‰ f(n-n)ä¸­è·³æ³•ï¼Œå³ï¼š

f(n) = f(n-1) + f(n-2) + f(n-3) + ... + f(n-n) = f(0) + f(1) + f(2) + ... + f(n-1)

åˆå› ä¸º f(n-1) = f(0) + f(2) + f(3) + ... + f(n-2)

ä¸¤å¼ç›¸å‡å¾—ï¼šf(n) = 2 * f(n-1)  ( n >= 2)

```markdown
      0 (n = 0);
f(n)= 1 (n = 1);
      2*f(n-1) (n >= 2);
```



```js
function dp(n) {
    if(n < 2) return n;
    return 2 * dp(n - 1);
}

// ä¼˜åŒ–(åˆ©ç”¨ç¼“å­˜)
function dp(n) {
    if(n < 2) return n;
    let ans = 1;
    for(let i=2;i<=n;i++) {
        ans = 2 * ans;
    }
    return ans;
}
```



#### 2.å‰ªç»³å­



ç»™ä½ ä¸€æ ¹é•¿åº¦ä¸ºnçš„ç»³å­ï¼Œè¯·æŠŠç»³å­å‰ªæˆmæ®µ (må’Œnéƒ½æ˜¯æ•´æ•°ï¼Œn>1å¹¶ä¸”m>1)æ¯æ®µç»³å­çš„é•¿åº¦è®°ä¸º`k[0],k[1],â€¦,k[m]`.è¯·é—®`k[0]k[1]â€¦*k[m]`å¯èƒ½çš„æœ€å¤§ä¹˜ç§¯æ˜¯å¤šå°‘ï¼Ÿ

åˆ†æï¼š

| n    | dp(n)                                  |
| ---- | -------------------------------------- |
| 0    | 0                                      |
| 1    | 1                                      |
| 2    | 1                                      |
| 3    | 2                                      |
| 4    | 4                                      |
| n    | max(dp(i)*dp(n-i)) , i = 1,2,3 ... n/2 |

ç¼–ç ï¼š

```js
function dp(n) {
    if(n < 2) return n;
    if(n===2) return 1;
    if(n===3) return 2;
    
    /****é•¿åº¦ä¸º0ã€1ã€2ã€3çš„ç»³å­çš„é•¿åº¦********/
    let arr = [0,1,2,3];
    let max = 0;
    for(let i=4;i<=n;i++) {
        // max(dp(i)*dp(n-i)) , i = 1,2,3 ... n/2,ä»1å¼€å§‹
        for(let j=1; j<=n/2;j++) {
            let t = arr[j] * arr[i - j];
            if(max < t) {
                max = t;
            }
            arr[i] = max;
        }
    }
    console.log(arr)
    return max;
}
```



#### 3.[æ•°å­—ä¸‰è§’å½¢](https://leetcode-cn.com/problems/triangle/solution/san-chong-jie-fa-duo-tu-xiang-jie-120-san-jiao-xin/)

```markdown
             7					7Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·ä¸‰è§’å½¢è¡Œæ•°(i)Â·Â·Â·Â·Â·Â·Â·Â·Â·[7]
           3  8					3	8Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·å½“å‰è¡Œç¬¬2ä¸ªæ•°å­—ï¼ˆjï¼‰Â·Â·[3,8]
         8  1  0		===>	8	1	0	Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·[8,1,0]
        2  7  4  4   			2	7	4	4 Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·[2,7,4,4]
       4  5  2  6  5    		4	5	2	6	5Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·[4,5,2,6,5]

       DPä¸‰è§’å½¢ğŸ‘‰              	   
       7
       10	15	
       18	16	15
       20  25   20  19
       24  30   27  26  24  
```
åœ¨ä¸Šé¢çš„æ•°å­—ä¸‰è§’å½¢ä¸­å¯»æ‰¾ä¸€æ¡ä»é¡¶éƒ¨åˆ°åº•è¾¹çš„è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šæ‰€ç»è¿‡çš„æ•°å­—ä¹‹å’Œæœ€å¤§ã€‚è·¯å¾„ä¸Šçš„æ¯ä¸€æ­¥éƒ½åªèƒ½å¾€**å·¦ä¸‹æˆ– å³ä¸‹èµ°**ã€‚åªéœ€è¦æ±‚å‡ºè¿™ä¸ªæœ€å¤§å’Œå³å¯ï¼Œä¸å¿…ç»™å‡ºå…·ä½“è·¯å¾„ã€‚ ä¸‰è§’å½¢çš„è¡Œæ•°å¤§äº1å°äºç­‰äº100ï¼Œæ•°å­—ä¸º 0 - 99

**åˆ†æ**ï¼š

+ ç”¨äºŒç»´æ•°ç»„å­˜æ”¾æ•°æ®

+ D(i, j)ï¼šç¬¬iè¡Œç¬¬jä¸ªæ•°å­—(**ä»0å¼€å§‹ç¼–å·**)

+ dp(i,j)ï¼šä»é¡¶éƒ¨èµ°åˆ°D(i,j)å¤„çš„æœ€å¤§è·¯å¾„å’Œ

+ DPæ–¹ç¨‹ï¼š

  ```markdown
  dp(i,j) = max(dp(i-1, j), dp(i-1,j-1)) + D(i,j)
  ```

+ è¾¹ç•Œæ¡ä»¶ï¼š

  + åœ¨ä¸‰è§’å½¢çš„é¡¶éƒ¨æ—¶(i=0)ï¼Œæœ€å¤§è·¯å¾„å’Œå°±ç­‰äºå¯¹åº”ä½ç½®çš„å…ƒç´ å€¼

  ```markdown
  dp(0,0)=D(0,0);
  ```

  + ç¬¬ä¸€åˆ—ï¼ˆæœ€å·¦è¾¹j=0ï¼‰è®¡ç®—çš„æ—¶å€™ï¼Œå¦‚æœç”¨dp(i-1, j-1)è·å–æ–œä¸Šæ–¹å€¼æ—¶ä¼šå‡ºç°ä¸‹æ ‡è¶Šç•Œ

  ```
  dp(i,0) = dp(i-1,0) + D(i,0)
  ```

  + æœ€å³è¾¹ä¹Ÿæ˜¯åªæœ‰ä¸€æ¡è½¬ç§»è·¯å¾„(i=j)

  ```
  dp(i,j) = dp(i-1,j-1) + D(i,j)
  ```

  

```js
let dataset = [
    [7],
    [3,8],
    [8,1,0],
    [2,7,4,4],
    [4,5,2,6,5]
];
function getMaxSum(dataset) {
    let dp = [];
	let N = dataset.length;
	// åˆ›å»ºäºŒç»´æ•°ç»„
    for(let i=0;i<N;i++) {
        let arr = [];
        for(let j=0;j<i+1;j++) {
           arr.push(0)
        }
        dp.push(arr);
    }	
    // åˆå§‹åŒ–dp[0][0],è®¡ç®—ç¬¬ä¸€è¡Œ
    dp[0][0] = dataset[0][0];
    // ä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå³i=1
    for(let i=1;i<N;i++) {
        // è®¡ç®—ç¬¬ä¸€åˆ—
        dp[i][0] = dp[i-1][0] + dataset[i][0];
        for(let j=1;j<i+1;j++) {
            dp[i][j] = Math.max(dp[i-1][j-1], dp[i-1][j]) + dataset[i][j]
        }
        // æœ€å³ä¾§
        dp[i][i] = dp[i - 1][i - 1] + dataset[i][i]
    }
    return Math.max(...dp[N-1])
}

getMaxSum(dataset) // 30
```

```js
// åŠ¨æ€è§„åˆ’-è‡ªåº•å‘ä¸Š-é™ç»´
function getMaxSum(dataset) {
    let N = dataset.length;
    let dp = new Array(N + 1).fill(0);
    for(let i=N-1;i>=0;i--) {
        for(let j=0;j<dataset[i].length;j++) {
            dp[j]=Math.max(dp[j],dp[j+1]) + dataset[i][j];
        }
    }
    return dp[0];
}
```



#### 4.[å…«çš‡åé—®é¢˜](https://leetcode-cn.com/problems/eight-queens-lcci/solution/ba-huang-hou-by-leetcode-solution/)

è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œæ‰“å° N çš‡ååœ¨ N Ã— N æ£‹ç›˜ä¸Šçš„å„ç§æ‘†æ³•ï¼Œå…¶ä¸­æ¯ä¸ªçš‡åéƒ½**ä¸åŒè¡Œã€ä¸åŒåˆ—ï¼Œä¹Ÿä¸åœ¨å¯¹è§’çº¿**ä¸Šã€‚è¿™é‡Œçš„â€œå¯¹è§’çº¿â€æŒ‡çš„æ˜¯æ‰€æœ‰çš„å¯¹è§’çº¿ï¼Œä¸åªæ˜¯å¹³åˆ†æ•´ä¸ªæ£‹ç›˜çš„é‚£ä¸¤æ¡å¯¹è§’çº¿ã€‚

| å…«çš‡å |         0          |         1          |         2          |         3          |         4          |         5          |         6          |         7          |
| :----: | :----------------: | :----------------: | :----------------: | :----------------: | :----------------: | :----------------: | :----------------: | :----------------: |
|   0    |       :lock:       |       :lock:       |       :lock:       | :white_check_mark: |       :lock:       |       :lock:       |       :lock:       |       :lock:       |
|   1    |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       | :white_check_mark: |       :lock:       |
|   2    |       :lock:       |       :lock:       | :white_check_mark: |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |
|   3    |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       | :white_check_mark: |
|   4    |       :lock:       | :white_check_mark: |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |
|   5    |       :lock:       |       :lock:       |       :lock:       |       :lock:       | :white_check_mark: |       :lock:       |       :lock:       |       :lock:       |
|   6    | :white_check_mark: |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       |
|   7    |       :lock:       |       :lock:       |       :lock:       |       :lock:       |       :lock:       | :white_check_mark: |       :lock:       |       :lock:       |

:lock: ï¼šè¡¨ç¤ºä¸èƒ½å­˜æ”¾:blonde_woman:

:white_check_mark: ï¼šè¡¨ç¤ºèƒ½å­˜æ”¾çš„ä½ç½®

ä¼ªä»£ç å¦‚ä¸‹ï¼š

```markdown
(i,j) i-è¡Œ j-åˆ—
dfs(n) {
	// å¦‚æœxç­‰äºnäº†ï¼Œè¯´æ˜æ¯è¡Œçš„çš‡åéƒ½æ”¾ç½®å®Œæ¯•
	if(i===n) {
		//å°†æ£‹ç›˜å†…å®¹çš„å¿«ç…§ä¿å­˜ä¸‹æ¥
		return
	}
	
	for(let j=0;j<n;j++) {
		if (i,j)ä½ç½®å¯ä»¥æ”¾ç½®çš‡åï¼ˆæ¨ªç«–æ’‡æºéƒ½æ²¡æœ‰å…¶ä»–çš‡åï¼‰ {
			   å°†æ£‹ç›˜[i,j]ä½ç½®è®¾ç½®ä¸º Q
            	dfs(i+1) ç»§ç»­å°è¯•ä¸‹ä¸€è¡Œ
            	å°†æ£‹ç›˜[i,j]ä½ç½®è¿˜åŸ
		}
	}
}

// åˆ†æ
æ¨ªï¼šiç›¸åŒ(i,j)ï¼ˆä¸ç”¨æ£€æŸ¥ï¼Œæˆ‘ä»¬æ˜¯æŒ‰è¡Œæ‰«æçš„ï¼‰
ç«–ï¼šjç›¸åŒï¼ˆi-1,jï¼‰
æ’‡ï¼š(i-1,j-1) ï¼ˆy=x + cï¼‰
æºï¼š(i-1,j+1) ï¼ˆy=-x + cï¼‰
```



```js
function solveQueens(n) {
    // ç”ŸæˆN*Nçš„æ£‹ç›˜
    //å¡«å……æ£‹ç›˜ï¼Œæ¯ä¸ªæ ¼å­é»˜è®¤æ˜¯"."è¡¨ç¤ºæ²¡æœ‰æ”¾ç½®çš‡å
    let arr = new Array(n).map(d => new Array(n).fill('.'));
    // ç»“æœæ•°ç»„
    let ans = [];
    dfs(arr,0,n,ans);
    return ans;
}

function dfs(arr, row, n, ans) {
    // ä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼ˆrow=0ï¼‰ï¼Œå½“rowç­‰äºnï¼Œè¡¨ç¤ºæ‰€æœ‰çš‡åéƒ½æ”¾ç½®å®Œï¼Œè®°å½•ç»“æœ
    if(row===n){
        // è®°å½•
        let res = [];
        for(let i=0;i<n;i++) {
            // //æ¯ä¸€è¡Œæ‹¼æˆå­—ç¬¦ä¸² '...Q....'
            res[i] = arr[i].join('');
        }
        ans.push(res)
        return;
    }
    
    // éå†æ¯ä¸€åˆ—
    for(let col=0;col<n;col++) {
         //æ£€æŸ¥(row, col)è¿™ä¸€åæ ‡æ˜¯å¦å¯ä»¥æ”¾ç½®çš‡å
         //å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œå°±æ”¾ç½®çš‡åï¼Œå¹¶ç»§ç»­æ£€æŸ¥ä¸‹ä¸€è¡Œ
        if(check(arr, row, col, n)) {
            // æ”¾ç½®çš‡å
            arr[row][col] = 'Q';
            // é€’å½’
            dfs(arr,row+1,n,ans);
            // åˆå§‹åŒ–
            arr[row][col] = '.';
        }
    }
}

// æ£€æŸ¥å½“å‰è¡Œå’Œåˆ—æ˜¯å¦å¯ä»¥æ”¾ç½®çš‡å
function check(arr, row, col, n) {
    // æ£€æŸ¥ç«–ç€çš„ä¸€åˆ—æ˜¯å¦æœ‰çš‡å
    for(let i=0;i<row;i++) {
        if(arr[i][col] === 'Q') {
            return false;
        }
    }
    // æ£€æŸ¥æ’‡æ˜¯å¦æœ‰çš‡å(å·¦ä¸Šåˆ°å³ä¸‹çš„æ–œè¾¹)
    let x = row - 1, y = col - 1;
    while(x >=0 && y>=0) {
        if(arr[x][y]==='Q') {
            return false;
        }
        x--;
        y--;
    }
    // æ£€æŸ¥æºæ˜¯å¦æœ‰çš‡å(å·¦ä¸‹åˆ°å³ä¸Šçš„æ–œè¾¹)
    x = row - 1;
    y = col + 1;
    while(x >=0 && y<n) {
        if(arr[x][y]==='Q') {
            return false;
        }
        x--;
        y++;
    }
    return true;
}


// ä¼˜åŒ–åˆ¤æ–­
// åˆ¤æ–­èƒ½å¦å°†ç¬¬rowè¡Œç¬¬colåˆ—è®¾ç½®ä¸ºçš‡å
function isValid(arr, row, col, n) {  
    //éå†[0, row - 1]è¡Œæ‰€å‡ºç°çš„çš‡åä½ç½®
    for(let i = 0; i < row; i++) {
        for(let j = 0; j < n; j++) {
            if(arr[i][j] === 'Q' && (j === col || i + j === row + col || i - j === row - col)) {                    
                return false;
                /* 
                        j == col ä»£è¡¨å½“å‰ä½ç½®ä¸ å·²è®¾ç½®çš„çš‡ååœ¨åŒä¸€åˆ—
                        i + j === row + col ä»£è¡¨å½“å‰ä½ç½®ä¸ å·²è®¾ç½®çš„çš‡ååœ¨åŒä¸€å‰¯å¯¹è§’çº¿(y=-x)
                        i - j === row - col ä»£è¡¨å½“å‰ä½ç½®ä¸ å·²è®¾ç½®çš„çš‡ååœ¨åŒä¸€ä¸»å¯¹è§’çº¿(y=x)
                    */
            }
        }
    }
    return true;
};
```



#### 5.èƒŒåŒ…é—®é¢˜

> [èƒŒåŒ…é—®é¢˜-ç¬”è®°æ•´ç†](https://blog.csdn.net/weixin_41162823/article/details/87878853)
>
> [è´­ç‰©å•](https://www.nowcoder.com/questionTerminal/f9c6f980eeec43ef85be20755ddbeaf4?answerType=1&f=discussion)
>
> [ç®—æ³•--èƒŒåŒ…ä¹è®²ï¼ˆè¯¦ç»†è®²è§£+ä»£ç ï¼‰](https://blog.csdn.net/qq_41289920/article/details/81299057?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.add_param_isCf&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.add_param_isCf)
>
> [èƒŒåŒ…ä¹è®²â€”â€”å…¨ç¯‡è¯¦ç»†ç†è§£ä¸ä»£ç å®ç°](https://blog.csdn.net/yandaoqiusheng/article/details/84782655)

+ é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ç»å…¸èƒŒåŒ…é—®é¢˜zkkysqs

**é—®é¢˜æè¿°**ï¼šæœ‰ä¸€ä¸ªèƒŒåŒ…å¯ä»¥è£…ç‰©å“çš„æ€»é‡é‡ä¸º`W`ï¼Œç°æœ‰`N`ä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“é‡`w[i]`ï¼Œä»·å€¼`v[i]`ï¼Œç”¨èƒŒåŒ…è£…ç‰©å“ï¼Œèƒ½è£…çš„æœ€å¤§ä»·å€¼æ˜¯å¤šå°‘ï¼Ÿ

**å®šä¹‰çŠ¶æ€è½¬ç§»æ•°ç»„dp[i][j]ï¼Œè¡¨ç¤ºå‰iä¸ªç‰©å“ï¼ŒèƒŒåŒ…é‡é‡ä¸ºjçš„æƒ…å†µä¸‹èƒ½è£…çš„æœ€å¤§ä»·å€¼ã€‚**

ä¾‹å¦‚ï¼š`dp[3][4] = 6`,è¡¨ç¤ºå‰ä¸‰ä¸ªç‰©å“è£…å…¥é‡é‡ä¸º4çš„èƒŒåŒ…æ‰€èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼ä¸º6ã€‚

**çŠ¶æ€è½¬ç§»æ–¹ç¨‹DP**ï¼š

`dp[i][j] = max(dp[i-1][j], dp[i-1][j-w[i]]+v[i])`

`dp[i-1][j]`è¡¨ç¤ºå½“å‰ç‰©å“ä¸æ”¾å…¥èƒŒåŒ…ï¼Œ`dp[i-1][j-w[i]]+v[i]`è¡¨ç¤ºå½“å‰ç‰©å“æ”¾å…¥èƒŒåŒ…ï¼Œå³å½“å‰ç¬¬iä¸ªç‰©å“è¦ä¹ˆæ”¾å…¥èƒŒåŒ…ï¼Œè¦ä¹ˆä¸æ”¾å…¥èƒŒåŒ…ã€‚

ä¼ªä»£ç å®ç°å¦‚ä¸‹ï¼š
```py
dp = [[0]*(n+1) for _ in range(m+1)]
for i in range(1, m+1):
    for j in range(1, n+1):
        if j - w[i] >= 0:
            dp[i][j] = max(dp[i-1][j], dp[i-1][j-w[i]] + v[i])
        else:
            dp[i][j] = dp[i-1][j]
return dp[m][n]
```
+ è´­ç‰©è½¦
è´­ç‰©è½¦æœ¬è´¨ä¸Šè¿˜æ˜¯0-1èƒŒåŒ…é—®é¢˜ï¼Œåªä¸è¿‡å¤šäº†ä¸»ä»¶å’Œé™„ä»¶ã€‚å‡è®¾å…ˆä¸çœ‹é™„ä»¶ï¼Œé‚£ä¹ˆå°±å’Œ0-1èƒŒåŒ…ä¸€æ ·äº†ã€‚é™„ä»¶ä¸èƒ½å•ç‹¬å‡ºç°ï¼Œè¦ä¾èµ–äºä¸»ä»¶ã€‚

å¯¹åº”äºèƒŒåŒ…é—®é¢˜ï¼Œä¸»ä»¶çš„ä¸ªæ•°å°±æ˜¯ç‰©å“çš„ä¸ªæ•°ï¼Œè€ƒè™‘æ¯ä¸ªä¸»ä»¶æ—¶è¦è€ƒè™‘å¯èƒ½å‡ºç°çš„æƒ…å†µã€‚

```markdown
è¾“å…¥ä¾‹å­:
1000 5
800 2 0
400 5 1
300 5 1
400 3 0
500 2 0
```
åœ¨å½“å‰çš„ä¾‹å­å½“ä¸­ç‰©å“çš„ä¸ªæ•°å°±æ˜¯3ã€‚

è€ƒè™‘æ¯ä¸ªç‰©å“æ—¶è¦è€ƒè™‘æ¯ç§å¯èƒ½å‡ºç°çš„æƒ…å†µï¼Œ1ã€ä¸»ä»¶ï¼Œ2ã€ä¸»ä»¶+é™„ä»¶1ï¼Œ3ã€ä¸»ä»¶+é™„ä»¶2ï¼Œ4ã€ä¸»ä»¶+é™„ä»¶1+é™„ä»¶2ï¼Œä¸ä¸€å®šæ¯ç§æƒ…å†µéƒ½å‡ºç°ï¼Œåªæœ‰å½“å­˜åœ¨é™„ä»¶æ—¶æ‰ä¼šå‡ºç°å¯¹åº”çš„æƒ…å†µã€‚

`w[i][k]`è¡¨ç¤ºç¬¬iä¸ªç‰©å“çš„ç¬¬kç§æƒ…å†µï¼Œkçš„å–å€¼èŒƒå›´0~3ï¼Œåˆ†åˆ«å¯¹åº”ä»¥ä¸Š4ä¸­æƒ…å†µï¼Œ`v[i][k]`è¡¨ç¤ºç¬¬iä¸ªç‰©å“å¯¹åº”ç¬¬kç§æƒ…å†µçš„ä»·å€¼ï¼Œç°åœ¨å°±æŠŠè´­ç‰©è½¦é—®é¢˜è½¬åŒ–ä¸ºäº†0-1èƒŒåŒ…é—®é¢˜ã€‚

**çŠ¶æ€è½¬ç§»æ–¹ç¨‹DP**å¯ä»¥å®šä¹‰ä¸º:

`dp[i][j] = max(dp[i-1][j],dp[i-1][j-w[i][k]]+v[i][k])`

`dp[i-1][j]`è¡¨ç¤ºå½“å‰ç‰©å“ä¸æ”¾å…¥èƒŒåŒ…ï¼Œ`w[i][k]`è¡¨ç¤ºç¬¬iä¸ªä¸»ä»¶å¯¹åº”ç¬¬kä¸­æƒ…å†µï¼Œå³å½“å‰ç¬¬iä¸ªç‰©å“çš„4ä¸­æƒ…å†µä¸­ä»·å€¼æœ€å¤§çš„è¦ä¹ˆæ”¾å…¥èƒŒåŒ…ï¼Œè¦ä¹ˆä¸æ”¾å…¥èƒŒåŒ…ã€‚

éœ€è¦æ³¨æ„ï¼š`dp[i][j] = max(ç‰©å“ä¸æ”¾å…¥èƒŒåŒ…ï¼Œä¸»ä»¶ï¼Œä¸»ä»¶+é™„ä»¶1ï¼Œä¸»ä»¶+é™„ä»¶2ï¼Œä¸»ä»¶+é™„ä»¶1+é™„ä»¶2)`

ä¼ªä»£ç å®ç°å¦‚ä¸‹ï¼š
```py
dp = [[0]*(n+1) for _ in range(m+1)]
for i in range(1,m+1):
    for j in range(1,n+1):
        max_i = dp[i-1][j]
        for k in range(len(w[i])):
            if j-w[i][k]>=0:
                max_i = max(max_i, dp[i-1][j-w[i][k]]+v[i][k])
        dp[i][j] = max_i
print(dp[m][n])
```

```js
/**
*@param m:æ€»é’±æ•°
*@param n:ç‰©å“æ•°
*@param arr: [[v,p,q]](v-ä»·æ ¼ï¼Œp-é‡è¦åº¦ï¼Œq-ä¸»é™„ä»¶)
*/
let m = 1000;
let n = 5;
let arr = [
  [800,2,0],
  [400,5,1],
  [300,5,1],
  [400,3,0],
  [500,2,0],
];

buyGoods(m/10, n, arr) // 2200;

function buyGoods(m, n, arr) {
    // {v: ä»·æ ¼ï¼Œ w:ä»·å€¼}[]
    let goods = generateGoods(arr);
    let res = Array(m+1).fill(0);
    
    for(let i=0;i<goods.length;i++) {
        for(let j=m;j>=0;j--) {
            if(goods[i]) {
                goods[i].forEach(d => {
                    if(d.v <= j) {
                        // ä¹°æƒé‡è¾ƒé«˜çš„ç‰©å“
                        res[j] = Math.max(res[j], res[j-d.v] + d.w);
                    }
                })
            }
        }
    }
    console.log(res);
    return res[m] * 10;
}

function generateGoods(arr) {
    let res = [];
    for(let i=0;i<arr.length;i++) {
        // æ˜¯ä¸»ä»¶
        if(arr[i][2] === 0) {
            res[i] = [{v: arr[i][0]/10, w:arr[i][0]/10 * arr[i][1]}]
        // æ˜¯é™„ä»¶ï¼ŒåŒæ—¶å¿…é¡»è´­ä¹°ç›¸åº”çš„ä¸»ä»¶    
        } else {
            // res[arr[2]-1]å¯¹åº”ä¸»ä»¶çš„æ•°æ®
            let add = res[arr[i][2]-1].map(d => ({
                v: arr[i][0]/10 + d.v,
                w: arr[i][0]*arr[i][1]/10 + d.w,
            }))
            res[arr[i][2]-1] = [...res[arr[i][2]-1], ...add];
        }
    }
    return res.filter(Boolean);
    // (3) [Array(4), Array(1), Array(1)]
    // 0: Array(4)
    // 0: {v: 800, w: 1600}
    // 1: {v: 1200, w: 3600}
    // 2: {v: 1100, w: 3100}
    // 3: {v: 1500, w: 5100}
    // length: 4
    // __proto__: Array(0)
    // 1: Array(1)
    // 0: {v: 400, w: 1200}
    // length: 1
    // __proto__: Array(0)
    // 2: Array(1)
    // 0: {v: 500, w: 1000}
}
```



#### 6.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº
