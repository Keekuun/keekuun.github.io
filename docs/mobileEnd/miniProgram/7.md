---
title: å¾®ä¿¡å°ç¨‹åºå¸¸ç”¨api date: 2022-03-15 sidebar: auto isComment: true categories:

- ç§»åŠ¨ç«¯ tags:
- å°ç¨‹åº

---

## `wx.request`ç½‘ç»œè¯·æ±‚[ğŸ‘‰](https://developers.weixin.qq.com/miniprogram/dev/api/network/request/wx.request.html)

`wx.request`ç”¨äºå‘èµ·HTTPSè¯·æ±‚ï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´å’Œæœ€å¤§è¶…æ—¶æ—¶é—´éƒ½æ˜¯60sã€‚å­—å•Šå°ç¨‹åºä¸­åªèƒ½ä½¿ç”¨HTTPSè¯·æ±‚è€Œä¸èƒ½ä½¿ç”¨HTTPè¯·æ±‚ï¼ŒåŒäº‹åªèƒ½æœ‰äº”ä¸ªç½‘ç»œè¯·æ±‚è¿æ¥ã€‚

```ts
// index.ts
// è·å–åº”ç”¨å®ä¾‹
const app = getApp<IAppOption>()
console.log('app', app.globalData);
Page({
    data: {
        userInfo: {},
    },
    // äº‹ä»¶å¤„ç†å‡½æ•°
    clickMe() {
        this.searchData()
    },
    // æ•°æ®è¯·æ±‚å‡½æ•°
    searchData() {
        wx.request({
            url: 'https://www.baidu.com/sugrec?pre=1&p=3&ie=utf-8&json=1&prod=pc&from=pc_web&wd=1&req=2&csor=1',
            header: {
                'Content-Type': 'application/json',
            },
            method: 'GET',  // å¿…é¡»å¤§å†™
            success(response) {
                // è¯·æ±‚æˆåŠŸï¼Œresponse
                console.log(response);
            },
            fail(err) {
                // è¯·æ±‚å¤±è´¥
                console.log('fail', err);
            },
            complete(e) {
                // æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ
                console.log('complete', e);
            }
        })
    },
    onLoad(query) {
        // é¡µé¢åŠ è½½æ—¶è¯·æ±‚æ•°æ®
        this.searchData()
    },
})
```

## `wx.uploadFile`ä¸Šä¼ [ğŸ‘‰](https://developers.weixin.qq.com/miniprogram/dev/api/network/upload/wx.uploadFile.html)

`wx.uploadFile`å°†æœ¬åœ°èµ„æºä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ª `HTTPS POST` è¯·æ±‚ï¼Œå…¶ä¸­ `content-type` ä¸º `multipart/form-data`

ä¸Šä¼ æ–‡ä»¶æœ€å¤§å¹¶å‘é™åˆ¶ä¸º10ä¸ªï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´å’Œæœ€å¤§è¶…æ—¶æ—¶é—´éƒ½æ˜¯60sã€‚

```js
wx.chooseImage({
  success (res) {
    const tempFilePaths = res.tempFilePaths
    wx.uploadFile({
      url: 'https://example.weixin.qq.com/upload', //ä»…ä¸ºç¤ºä¾‹ï¼ŒéçœŸå®çš„æ¥å£åœ°å€
      filePath: tempFilePaths[0],
      name: 'file',
      formData: {
        'user': 'test'
      },
      success (res) {
        const data = res.data
        //do something
      },
      fail (err) {
        //do something
      }
    })
  }
})
```

## `wx.downloadFile`ä¸‹è½½[ğŸ‘‰](https://developers.weixin.qq.com/miniprogram/dev/api/network/download/wx.downloadFile.html)

`wx.downloadFile`ä¸‹è½½æ–‡ä»¶èµ„æºåˆ°æœ¬åœ°ã€‚å®¢æˆ·ç«¯ç›´æ¥å‘èµ·ä¸€ä¸ª `HTTPS GET` è¯·æ±‚ï¼Œè¿”å›æ–‡ä»¶çš„æœ¬åœ°ä¸´æ—¶è·¯å¾„ (æœ¬åœ°è·¯å¾„)ï¼Œå•æ¬¡ä¸‹è½½å…è®¸çš„æœ€å¤§æ–‡ä»¶ä¸º 200MBã€‚

ä¸‹è½½æ–‡ä»¶æœ€å¤§å¹¶å‘é™åˆ¶ä¸º10ä¸ªï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´å’Œæœ€å¤§è¶…æ—¶æ—¶é—´éƒ½æ˜¯60sã€‚

> æ³¨æ„ï¼šè¯·åœ¨æœåŠ¡ç«¯å“åº”çš„ header ä¸­æŒ‡å®šåˆç†çš„ Content-Type å­—æ®µï¼Œä»¥ä¿è¯å®¢æˆ·ç«¯æ­£ç¡®å¤„ç†æ–‡ä»¶ç±»å‹

```js
wx.downloadFile({
  url: 'https://example.com/audio/123', //ä»…ä¸ºç¤ºä¾‹ï¼Œå¹¶éçœŸå®çš„èµ„æº
  success (res) {
    // åªè¦æœåŠ¡å™¨æœ‰å“åº”æ•°æ®ï¼Œå°±ä¼šæŠŠå“åº”å†…å®¹å†™å…¥æ–‡ä»¶å¹¶è¿›å…¥ success å›è°ƒï¼Œä¸šåŠ¡éœ€è¦è‡ªè¡Œåˆ¤æ–­æ˜¯å¦ä¸‹è½½åˆ°äº†æƒ³è¦çš„å†…å®¹
    if (res.statusCode === 200) {
      wx.playVoice({
        filePath: res.tempFilePath
      })
    }
  },
  fail (err) {
    //do something
  }
})
```

## ``
