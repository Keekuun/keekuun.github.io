## 79. ç”¨ JS å†™ä¸€ä¸ª cookies è§£æå‡½æ•°ï¼Œè¾“å‡ºç»“æœä¸ºä¸€ä¸ªå¯¹è±¡

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç”¨ JavaScript ç¼–å†™çš„ `cookies` è§£æå‡½æ•°ï¼Œå®ƒå°† `document.cookie` å­—ç¬¦ä¸²è§£æä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ–¹ä¾¿è¯»å–å’Œæ“ä½œ Cookie æ•°æ®ã€‚ä»£ç ä½¿ç”¨ TypeScript ç±»å‹å¢å¼ºå¯è¯»æ€§ã€‚

---

### **1. å®ç°ä»£ç **
```typescript
/**
 * è§£æå½“å‰é¡µé¢çš„ cookiesï¼Œè¿”å›ä¸€ä¸ªé”®å€¼å¯¹å¯¹è±¡
 * @returns {Record<string, string>} Cookie å¯¹è±¡
 */
function parseCookies(): Record<string, string> {
  // è·å–å½“å‰é¡µé¢çš„æ‰€æœ‰ cookies
  const cookiesString = document.cookie;

  // å¦‚æœ cookies ä¸ºç©ºï¼Œè¿”å›ç©ºå¯¹è±¡
  if (!cookiesString) {
    return {};
  }

  // åˆ†å‰² cookies å­—ç¬¦ä¸²ä¸ºé”®å€¼å¯¹æ•°ç»„
  const cookiePairs = cookiesString.split('; ');

  // è½¬æ¢ä¸ºå¯¹è±¡
  const cookies: Record<string, string> = {};

  for (const pair of cookiePairs) {
    // åˆ†å‰²é”®å€¼å¯¹
    const [key, value] = pair.split('=');

    // è§£ç å¹¶å­˜å‚¨ï¼ˆå› ä¸º cookie å€¼å¯èƒ½æ˜¯ URL ç¼–ç çš„ï¼‰
    cookies[decodeURIComponent(key)] = decodeURIComponent(value);
  }

  return cookies;
}

// ä½¿ç”¨ç¤ºä¾‹
const cookies = parseCookies();
console.log(cookies); // è¾“å‡ºï¼š{ "key1": "value1", "key2": "value2", ... }
```

---

### **2. åŠŸèƒ½è¯´æ˜**
1. **è¾“å…¥**ï¼š`document.cookie` å­—ç¬¦ä¸²ï¼ˆå¦‚ `"name=John; age=30; city=New%20York"`ï¼‰ã€‚
2. **è¾“å‡º**ï¼šè§£æåçš„å¯¹è±¡ï¼ˆå¦‚ `{ name: "John", age: "30", city: "New York" }`ï¼‰ã€‚
3. **ç‰¹æ€§**ï¼š
    - è‡ªåŠ¨è§£ç  URL ç¼–ç çš„é”®å’Œå€¼ï¼ˆå¦‚ `%20` â†’ ç©ºæ ¼ï¼‰ã€‚
    - å¤„ç†å¤šä¸ª Cookie åˆ†å‰²ç¬¦ï¼ˆ`;`ï¼‰ã€‚
    - ç©º Cookie å­—ç¬¦ä¸²æ—¶è¿”å›ç©ºå¯¹è±¡ã€‚

---

### **3. æµ‹è¯•ç”¨ä¾‹**
```typescript
// è®¾ç½®æµ‹è¯• cookies
document.cookie = "username=Alice";
document.cookie = "token=abc123";
document.cookie = "language=en%20US";

// è§£æå¹¶æ‰“å°
console.log(parseCookies());
// è¾“å‡ºï¼š{ username: "Alice", token: "abc123", language: "en US" }
```

---

### **4. æ³¨æ„äº‹é¡¹**
1. **å®‰å…¨æ€§**ï¼š
    - é¿å…å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ï¼‰åœ¨ Cookie ä¸­ã€‚
    - ä½¿ç”¨ `HttpOnly` å’Œ `Secure` æ ‡å¿—å¢å¼ºå®‰å…¨æ€§ã€‚
2. **ç¼–ç é—®é¢˜**ï¼š
    - å¦‚æœ Cookie å€¼åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ `=` æˆ– `;`ï¼‰ï¼Œç¡®ä¿åœ¨è®¾ç½®æ—¶è¿›è¡Œ `encodeURIComponent`ã€‚
3. **æµè§ˆå™¨å…¼å®¹æ€§**ï¼š
    - æ‰€æœ‰ç°ä»£æµè§ˆå™¨å‡æ”¯æŒ `document.cookie` å’Œ `decodeURIComponent`ã€‚

---

### **5. è¿›é˜¶æ‰©å±•**
å¦‚æœéœ€è¦æ”¯æŒæ›´å¤æ‚çš„ Cookie æ“ä½œï¼ˆå¦‚è®¾ç½®è¿‡æœŸæ—¶é—´ã€åŸŸåé™åˆ¶ç­‰ï¼‰ï¼Œå¯ä»¥å°è£…ä¸€ä¸ªå®Œæ•´çš„ Cookie å·¥å…·åº“ï¼š

```typescript
/**
 * è®¾ç½® Cookie
 * @param key - Cookie é”®å
 * @param value - Cookie å€¼
 * @param options - å¯é€‰é…ç½®ï¼ˆè¿‡æœŸæ—¶é—´ã€åŸŸåç­‰ï¼‰
 */
function setCookie(
  key: string,
  value: string,
  options: { expires?: Date; domain?: string; path?: string; secure?: boolean } = {}
): void {
  let cookieString = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;

  if (options.expires) {
    cookieString += `; expires=${options.expires.toUTCString()}`;
  }
  if (options.domain) {
    cookieString += `; domain=${options.domain}`;
  }
  if (options.path) {
    cookieString += `; path=${options.path}`;
  }
  if (options.secure) {
    cookieString += '; secure';
  }

  document.cookie = cookieString;
}

// ä½¿ç”¨ç¤ºä¾‹
setCookie("theme", "dark", { expires: new Date(Date.now() + 86400000), path: "/" });
```

---

é€šè¿‡è¿™ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥è½»æ¾è§£æå’Œæ“ä½œ Cookieï¼Œæå‡å¼€å‘æ•ˆç‡ï¼ ğŸªğŸš€