## 105. OAuth2.0 是什么登录方式

OAuth2.0（Open Authorization 2.0）是一种**授权框架**，而不是传统的登录方式。它允许用户在不直接提供用户名和密码的情况下，授权第三方应用访问其在其他服务上的资源（如个人信息、照片等）。OAuth2.0 主要用于**安全的授权访问**，而不是直接用于身份认证（Authentication），但可以与身份认证协议（如 OpenID Connect）结合使用，实现登录功能。

### 🔑 OAuth2.0 的核心概念
1. **资源所有者（Resource Owner）**：通常是用户，拥有被访问资源的权限。
2. **客户端（Client）**：需要访问用户资源的第三方应用。
3. **授权服务器（Authorization Server）**：负责验证用户身份并颁发访问令牌（Access Token）。
4. **资源服务器（Resource Server）**：存储用户资源的服务器（如 Google 的 API）。

### 🔄 OAuth2.0 的工作流程
1. **用户授权**：用户通过授权服务器同意客户端访问其资源。
2. **获取令牌**：客户端收到授权码（Authorization Code）或直接获取访问令牌。
3. **访问资源**：客户端使用令牌向资源服务器请求数据。

### 🎯 OAuth2.0 的常见应用场景
- **社交登录**：如“使用 Google 账号登录”或“使用微信登录”。
- **API 访问**：第三方应用访问用户在其他平台的数据（如获取 GitHub 仓库信息）。
- **单点登录（SSO）**：结合 OpenID Connect 实现跨平台登录。

### 📜 代码示例（TypeScript）
以下是一个简单的 OAuth2.0 授权流程示例：
```typescript
import axios from 'axios';

// 1. 用户被重定向到授权服务器
const authorizeUrl = 'https://auth.example.com/authorize';
const clientId = 'your-client-id';
const redirectUri = 'https://your-app.com/callback';
const scope = 'read:user';

const authUrl = `${authorizeUrl}?client_id=${clientId}&redirect_uri=${redirectUri}&scope=${scope}&response_type=code`;

console.log(`请访问以下链接授权: ${authUrl}`);

// 2. 客户端通过回调 URL 获取授权码
const authorizationCode = 'received-code-from-callback';

// 3. 使用授权码交换访问令牌
const tokenUrl = 'https://auth.example.com/token';
const clientSecret = 'your-client-secret';

axios.post(tokenUrl, {
    grant_type: 'authorization_code',
    code: authorizationCode,
    redirect_uri: redirectUri,
    client_id: clientId,
    client_secret: clientSecret,
}).then((response) => {
    const accessToken = response.data.access_token;
    console.log(`访问令牌: ${accessToken}`);

    // 4. 使用令牌访问资源
    const resourceUrl = 'https://api.example.com/user';
    axios.get(resourceUrl, {
        headers: { 'Authorization': `Bearer ${accessToken}` },
    }).then((res) => {
        console.log('用户数据:', res.data);
    });
});
```

### ⚠️ 注意事项
- **安全性**：确保使用 HTTPS 传输令牌，避免泄露。
- **令牌有效期**：访问令牌通常有较短的有效期，需定期刷新。
- **权限控制**：仅请求必要的权限（Scope），避免过度授权。

OAuth2.0 是现代 Web 和移动应用中最常用的授权标准之一，广泛应用于各种互联网服务中。 🚀