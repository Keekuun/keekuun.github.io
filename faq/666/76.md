## 76. å‰ç«¯è§†è§’-å¦‚ä½•ä¿è¯ç³»ç»Ÿç¨³å®šæ€§

ä»å‰ç«¯è§†è§’æ¥çœ‹ï¼Œ**ç³»ç»Ÿç¨³å®šæ€§**ä¸ä»…æ¶‰åŠä»£ç å¥å£®æ€§ï¼Œè¿˜åŒ…æ‹¬æ€§èƒ½ä¼˜åŒ–ã€é”™è¯¯å¤„ç†ã€ç›‘æ§å‘Šè­¦ç­‰æ–¹é¢ã€‚ä»¥ä¸‹æ˜¯ç¡®ä¿å‰ç«¯ç³»ç»Ÿç¨³å®šæ€§çš„å…³é”®ç­–ç•¥å’Œå®è·µï¼š

---

## **1. ä»£ç å¥å£®æ€§**
### **âœ… ç±»å‹å®‰å…¨ï¼ˆTypeScriptï¼‰**
ä½¿ç”¨ TypeScript å‡å°‘è¿è¡Œæ—¶é”™è¯¯ï¼š
```typescript
interface User {
  id: number;
  name: string;
}

function getUserName(user: User): string {
  return user.name; // ç¼–è¯‘æ—¶æ£€æŸ¥å±æ€§æ˜¯å¦å­˜åœ¨
}
```

### **âœ… é˜²å¾¡æ€§ç¼–ç¨‹**
- æ£€æŸ¥æ•°æ®è¾¹ç•Œå’Œç©ºå€¼ï¼š
  ```javascript
  const safeData = data?.list?.map(item => item.value) || [];
  ```
- ä½¿ç”¨é»˜è®¤å€¼å’Œå…œåº•é€»è¾‘ï¼š
  ```javascript
  const fontSize = options.size || 14; // é»˜è®¤å€¼
  ```

---

## **2. é”™è¯¯å¤„ç†ä¸ç›‘æ§**
### **âœ… å…¨å±€é”™è¯¯æ•è·**
- **JavaScript é”™è¯¯**ï¼š
  ```javascript
  window.addEventListener('error', (e) => {
    logError(e); // ä¸ŠæŠ¥é”™è¯¯
    showFallbackUI(); // é™çº§å±•ç¤º
  });
  ```
- **Promise æœªæ•è·å¼‚å¸¸**ï¼š
  ```javascript
  window.addEventListener('unhandledrejection', (e) => {
    logError(e.reason);
  });
  ```

### **âœ… æ¥å£å®¹é”™**
- å°è£…ç»Ÿä¸€è¯·æ±‚å·¥å…·ï¼š
  ```typescript
  async function safeFetch(url: string) {
    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return await res.json();
    } catch (error) {
      console.error('Request failed:', error);
      return null; // è¿”å›å…œåº•æ•°æ®
    }
  }
  ```

### **âœ… ç›‘æ§å‘Šè­¦**
- é›†æˆ Sentry æˆ–è‡ªå»ºç›‘æ§ï¼š
  ```javascript
  Sentry.init({ dsn: 'YOUR_DSN' });
  ```
- å…³é”®æŒ‡æ ‡ä¸ŠæŠ¥ï¼ˆå¦‚é¡µé¢åŠ è½½æ—¶é—´ã€æ¥å£æˆåŠŸç‡ï¼‰ã€‚

---

## **3. æ€§èƒ½ä¼˜åŒ–**
### **âœ… èµ„æºåŠ è½½ä¼˜åŒ–**
- **æ‡’åŠ è½½éæ ¸å¿ƒæ¨¡å—**ï¼š
  ```javascript
  const HeavyComponent = React.lazy(() => import('./HeavyComponent'));
  ```
- **é¢„åŠ è½½å…³é”®èµ„æº**ï¼š
  ```html
  <link rel="preload" href="main.js" as="script">
  ```

### **âœ… å†…å­˜ç®¡ç†**
- é¿å…å†…å­˜æ³„æ¼ï¼š
  ```javascript
  useEffect(() => {
    const timer = setInterval(() => {}, 1000);
    return () => clearInterval(timer); // æ¸…ç†å‰¯ä½œç”¨
  }, []);
  ```

---

## **4. ä¾èµ–ç®¡ç†**
### **âœ… é”å®šç‰ˆæœ¬**
- ä½¿ç”¨ `package-lock.json` æˆ– `yarn.lock` å›ºå®šä¾èµ–ç‰ˆæœ¬ã€‚
- å®šæœŸæ›´æ–°ä¾èµ–ï¼ˆ`npm audit` æ£€æŸ¥å®‰å…¨æ¼æ´ï¼‰ã€‚

### **âœ… æ²™ç®±éš”ç¦»**
- å¾®å‰ç«¯åœºæ™¯ä¸‹ï¼Œé€šè¿‡ Shadow DOM æˆ– `iframe` éš”ç¦» CSS/JSï¼š
  ```javascript
  const shadow = element.attachShadow({ mode: 'closed' });
  ```

---

## **5. è‡ªåŠ¨åŒ–æµ‹è¯•**
### **âœ… å•å…ƒæµ‹è¯•ï¼ˆJestï¼‰**
```typescript
test('adds 1 + 2 to equal 3', () => {
  expect(1 + 2).toBe(3);
});
```

### **âœ… E2E æµ‹è¯•ï¼ˆCypressï¼‰**
```javascript
describe('Login', () => {
  it('successfully loads', () => {
    cy.visit('/login');
    cy.get('button').should('be.visible');
  });
});
```

---

## **6. ç°åº¦å‘å¸ƒä¸å›æ»š**
### **âœ… åŠŸèƒ½å¼€å…³ï¼ˆFeature Flagsï¼‰**
```javascript
if (featureFlags.enableNewUI) {
  renderNewUI();
} else {
  renderLegacyUI();
}
```

### **âœ… A/B æµ‹è¯•**
é€šè¿‡ CDN æˆ–åç«¯åŠ¨æ€è¿”å›ä¸åŒç‰ˆæœ¬ä»£ç ã€‚

---

## **7. ç¾éš¾æ¢å¤**
### **âœ… é™çº§ç­–ç•¥**
- æ¥å£å¤±è´¥æ—¶å±•ç¤ºç¼“å­˜æ•°æ®ï¼š
  ```javascript
  const data = await fetchData().catch(() => getCachedData());
  ```
- é™æ€èµ„æºåŠ è½½å¤±è´¥æ—¶ä½¿ç”¨å¤‡ç”¨ CDNï¼š
  ```html
  <script src="https://primary.cdn.com/main.js" onerror="fallbackCDN(this)"></script>
  ```

### **âœ… ç¦»çº¿æ¨¡å¼ï¼ˆPWAï¼‰**
é€šè¿‡ Service Worker ç¼“å­˜å…³é”®èµ„æºï¼š
```javascript
self.addEventListener('install', (e) => {
  e.waitUntil(caches.open('v1').then(cache => cache.addAll(['/index.html'])));
});
```

---

## **8. å›¢é˜Ÿåä½œè§„èŒƒ**
### **âœ… Code Review**
- å¼ºåˆ¶æ£€æŸ¥è¾¹ç•Œæ¡ä»¶ï¼ˆå¦‚ `null`ã€`undefined`ï¼‰ã€‚
- ç¦æ­¢ç›´æ¥ä¿®æ”¹ `props` æˆ–å…¨å±€å˜é‡ã€‚

### **âœ… æ–‡æ¡£ä¸æ³¨é‡Š**
- ä¸ºå¤æ‚é€»è¾‘æ·»åŠ æ³¨é‡Šï¼š
  ```typescript
  /**
   * @description å®‰å…¨è§£æ JSONï¼Œé¿å…å´©æºƒ
   */
  function safeParse(json: string) {
    try { return JSON.parse(json); }
    catch { return null; }
  }
  ```

---

## **9. æ€»ç»“**
| **æ–¹å‘**         | **å…·ä½“æªæ–½**                              | **å·¥å…·/ç¤ºä¾‹**                     |
|------------------|-----------------------------------------|----------------------------------|
| ä»£ç å¥å£®æ€§       | TypeScript + é˜²å¾¡æ€§ç¼–ç¨‹                  | `interface`, `?.` æ“ä½œç¬¦          |
| é”™è¯¯ç›‘æ§         | Sentry + å…¨å±€é”™è¯¯æ•è·                    | `window.onerror`                 |
| æ€§èƒ½ä¼˜åŒ–         | æ‡’åŠ è½½ + å†…å­˜ç®¡ç†                        | `React.lazy`, `useEffect` æ¸…ç†    |
| è‡ªåŠ¨åŒ–æµ‹è¯•       | Jest + Cypress                          | `expect()`, `cy.visit()`          |
| ç¾éš¾æ¢å¤         | é™çº§ç­–ç•¥ + PWA                          | `try/catch`, Service Worker       |

é€šè¿‡ä»¥ä¸Šæªæ–½ï¼Œå‰ç«¯ç³»ç»Ÿå¯ä»¥è¾¾åˆ° **é«˜å¯ç”¨ã€æ˜“ç»´æŠ¤ã€å¿«é€Ÿæ¢å¤** çš„ç¨³å®šæ€§ç›®æ ‡ï¼ ğŸ›¡ï¸