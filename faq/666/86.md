## 86. åœ¨è¡¨å•æ ¡éªŒåœºæ™¯ä¸­ï¼Œå¦‚ä½•å®ç°é¡µé¢è§†å£æ»šåŠ¨åˆ°æŠ¥é”™çš„ä½ç½®

åœ¨è¡¨å•æ ¡éªŒåœºæ™¯ä¸­ï¼Œå½“ç”¨æˆ·æäº¤è¡¨å•æ—¶ï¼Œå¦‚æœæŸäº›å­—æ®µæ ¡éªŒå¤±è´¥ï¼Œé€šå¸¸éœ€è¦å°†é¡µé¢è§†å£è‡ªåŠ¨æ»šåŠ¨åˆ°ç¬¬ä¸€ä¸ªæŠ¥é”™çš„ä½ç½®ï¼Œä»¥æå‡ç”¨æˆ·ä½“éªŒã€‚ä»¥ä¸‹æ˜¯å®ç°è¿™ä¸€åŠŸèƒ½çš„å‡ ç§æ–¹æ³•ï¼š

---

## **1. ä½¿ç”¨ `Element.scrollIntoView()`**
### **åŸç†**
é€šè¿‡è°ƒç”¨æŠ¥é”™å…ƒç´ çš„ `scrollIntoView()` æ–¹æ³•ï¼Œå°†å…ƒç´ æ»šåŠ¨åˆ°è§†å£èŒƒå›´å†…ã€‚

### **ä»£ç ç¤ºä¾‹**
```typescript
// è·å–ç¬¬ä¸€ä¸ªæŠ¥é”™çš„è¡¨å•å…ƒç´ 
const firstErrorElement = document.querySelector('.error') as HTMLElement;

if (firstErrorElement) {
  // æ»šåŠ¨åˆ°æŠ¥é”™ä½ç½®ï¼Œå¹¶å¹³æ»‘æ»šåŠ¨
  firstErrorElement.scrollIntoView({
    behavior: 'smooth', // å¹³æ»‘æ»šåŠ¨
    block: 'center',    // å‚ç›´å±…ä¸­
  });

  // å¯é€‰ï¼šé«˜äº®æŠ¥é”™å…ƒç´ 
  firstErrorElement.focus();
}
```

### **å‚æ•°è¯´æ˜**
| **å‚æ•°**       | **ä½œç”¨**                                                                 |
|----------------|--------------------------------------------------------------------------|
| `behavior`     | æ»šåŠ¨è¡Œä¸ºï¼š`'auto'`ï¼ˆé»˜è®¤ï¼Œç¬é—´æ»šåŠ¨ï¼‰æˆ– `'smooth'`ï¼ˆå¹³æ»‘æ»šåŠ¨ï¼‰ã€‚           |
| `block`        | å‚ç›´å¯¹é½æ–¹å¼ï¼š`'start'`ã€`'center'`ã€`'end'`ã€‚                           |
| `inline`       | æ°´å¹³å¯¹é½æ–¹å¼ï¼š`'start'`ã€`'center'`ã€`'end'`ã€‚                           |

### **ä¼˜ç¼ºç‚¹**
| **ä¼˜ç‚¹**               | **ç¼ºç‚¹**                     |
|------------------------|------------------------------|
| åŸç”Ÿæ”¯æŒï¼Œæ— éœ€é¢å¤–åº“   | å…¼å®¹æ€§ç¨å·®ï¼ˆ`smooth` åœ¨æ—§æµè§ˆå™¨ä¸­ä¸æ”¯æŒï¼‰ |

---

## **2. ä½¿ç”¨ `window.scrollTo()`**
### **åŸç†**
é€šè¿‡è®¡ç®—æŠ¥é”™å…ƒç´ çš„ `offsetTop`ï¼ŒåŠ¨æ€è®¾ç½® `window.scrollTo` çš„æ»šåŠ¨ä½ç½®ã€‚

### **ä»£ç ç¤ºä¾‹**
```typescript
const firstErrorElement = document.querySelector('.error') as HTMLElement;

if (firstErrorElement) {
  // è®¡ç®—å…ƒç´ è·ç¦»é¡¶éƒ¨çš„è·ç¦»
  const offset = firstErrorElement.offsetTop - 100; // å‘ä¸Šåç§» 100px

  // æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®
  window.scrollTo({
    top: offset,
    behavior: 'smooth',
  });
}
```

### **é€‚ç”¨åœºæ™¯**
- éœ€è¦è‡ªå®šä¹‰æ»šåŠ¨åç§»é‡ï¼ˆå¦‚é¿å¼€å›ºå®šå¯¼èˆªæ ï¼‰ã€‚
- å…¼å®¹æ€§æ›´å¥½ï¼ˆæ”¯æŒæ—§æµè§ˆå™¨ï¼‰ã€‚

---

## **3. ç»“åˆè¡¨å•åº“ï¼ˆå¦‚ React Hook Formï¼‰**
### **åŸç†**
åœ¨æµè¡Œçš„è¡¨å•åº“ï¼ˆå¦‚ React Hook Formã€Formikï¼‰ä¸­ï¼Œé€šå¸¸å†…ç½®äº†æ»šåŠ¨åˆ°æŠ¥é”™çš„åŠŸèƒ½ã€‚

### **ç¤ºä¾‹ï¼ˆReact Hook Formï¼‰**
```typescript
import { useForm } from 'react-hook-form';

const { handleSubmit, formState: { errors } } = useForm();

const onSubmit = (data: any) => {
  if (Object.keys(errors).length > 0) {
    // è‡ªåŠ¨æ»šåŠ¨åˆ°ç¬¬ä¸€ä¸ªæŠ¥é”™å­—æ®µ
    const firstErrorField = Object.keys(errors)[0];
    const errorElement = document.getElementsByName(firstErrorField)[0];
    errorElement.scrollIntoView({ behavior: 'smooth' });
  }
};

return (
  <form onSubmit={handleSubmit(onSubmit)}>
    <input name="username" {...register('username', { required: true })} />
    {errors.username && <span className="error">Username is required</span>}
  </form>
);
```

---

## **4. å¤„ç†åŠ¨æ€å†…å®¹ï¼ˆå¦‚å¼‚æ­¥åŠ è½½çš„è¡¨å•ï¼‰**
### **é—®é¢˜**
å¦‚æœè¡¨å•å†…å®¹æ˜¯åŠ¨æ€åŠ è½½çš„ï¼ˆå¦‚é€šè¿‡ AJAX æˆ–æ‡’åŠ è½½ï¼‰ï¼Œç›´æ¥è°ƒç”¨ `scrollIntoView` å¯èƒ½æ— æ•ˆã€‚

### **è§£å†³æ–¹æ¡ˆ**
ä½¿ç”¨ `MutationObserver` ç›‘å¬ DOM å˜åŒ–ï¼Œç¡®ä¿å…ƒç´ åŠ è½½å®Œæˆåå†æ»šåŠ¨ã€‚

```typescript
const observer = new MutationObserver((mutations) => {
  const firstErrorElement = document.querySelector('.error') as HTMLElement;
  if (firstErrorElement) {
    firstErrorElement.scrollIntoView({ behavior: 'smooth' });
    observer.disconnect(); // åœæ­¢ç›‘å¬
  }
});

observer.observe(document.body, {
  childList: true,
  subtree: true,
});
```

---

## **5. å…¼å®¹æ€§å¤„ç†**
### **Polyfill å¹³æ»‘æ»šåŠ¨**
å¦‚æœéœ€è¦åœ¨æ—§æµè§ˆå™¨ä¸­æ”¯æŒ `smooth` æ»šåŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ `polyfill`ï¼ˆå¦‚ `smoothscroll-polyfill`ï¼‰ã€‚

```bash
npm install smoothscroll-polyfill
```

```typescript
import 'smoothscroll-polyfill';

// åœ¨ä»£ç ä¸­ç›´æ¥è°ƒç”¨ scrollIntoView å³å¯
```

---

## **6. æœ€ä½³å®è·µæ€»ç»“**
1. **ä¼˜å…ˆä½¿ç”¨ `scrollIntoView`**ï¼šç®€å•ã€åŸç”Ÿæ”¯æŒã€‚
2. **è‡ªå®šä¹‰åç§»é‡**ï¼šç»“åˆ `window.scrollTo` é¿å¼€å›ºå®šå¯¼èˆªæ ã€‚
3. **è¡¨å•åº“é›†æˆ**ï¼šåˆ©ç”¨ React Hook Form ç­‰åº“çš„å†…ç½®åŠŸèƒ½ã€‚
4. **åŠ¨æ€å†…å®¹å¤„ç†**ï¼šä½¿ç”¨ `MutationObserver` ç¡®ä¿å…ƒç´ åŠ è½½å®Œæˆã€‚
5. **å…¼å®¹æ€§ä¼˜åŒ–**ï¼šé€šè¿‡ `polyfill` æ”¯æŒæ—§æµè§ˆå™¨ã€‚

---

## **å®Œæ•´ä»£ç ç¤ºä¾‹**
```typescript
// è¡¨å•æäº¤æ—¶æ»šåŠ¨åˆ°ç¬¬ä¸€ä¸ªæŠ¥é”™ä½ç½®
function scrollToFirstError() {
  const firstErrorElement = document.querySelector('.error') as HTMLElement;

  if (firstErrorElement) {
    // å¹³æ»‘æ»šåŠ¨åˆ°æŠ¥é”™ä½ç½®
    firstErrorElement.scrollIntoView({
      behavior: 'smooth',
      block: 'center',
    });

    // é«˜äº®æŠ¥é”™å­—æ®µ
    firstErrorElement.focus();
  }
}

// è°ƒç”¨ç¤ºä¾‹
document.querySelector('form')?.addEventListener('submit', (e) => {
  e.preventDefault();
  scrollToFirstError();
});
```

---

é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œå¯ä»¥è½»æ¾å®ç°è¡¨å•æ ¡éªŒå¤±è´¥æ—¶è‡ªåŠ¨æ»šåŠ¨åˆ°æŠ¥é”™ä½ç½®çš„åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼ ğŸš€