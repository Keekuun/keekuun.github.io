## 84. ts é¡¹ç›®ä¸­ï¼Œå¦‚ä½•ä½¿ç”¨ node modules é‡Œé¢å®šä¹‰çš„å…¨å±€ç±»å‹åŒ…åˆ°è‡ªå·±é¡¹ç›® src ä¸‹é¢ä½¿ç”¨ï¼Ÿ

åœ¨ TypeScript é¡¹ç›®ä¸­ï¼Œå¦‚æœéœ€è¦åœ¨ `src` ç›®å½•ä¸‹ä½¿ç”¨ `node_modules` ä¸­å®šä¹‰çš„å…¨å±€ç±»å‹åŒ…ï¼ˆå¦‚ `@types` æˆ–ç¬¬ä¸‰æ–¹åº“çš„ç±»å‹å£°æ˜ï¼‰ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š

---

## **1. ç¡®ä¿ç±»å‹åŒ…å·²å®‰è£…**
é¦–å…ˆï¼Œç¡®è®¤ç±»å‹åŒ…å·²é€šè¿‡ npm/yarn å®‰è£…ï¼š
```bash
npm install --save-dev @types/package-name  # ä¾‹å¦‚ @types/lodash
```
æˆ–ç›´æ¥å®‰è£…åŒ…å«ç±»å‹çš„åº“ï¼š
```bash
npm install package-name  # ä¾‹å¦‚ lodashï¼ˆè‡ªå¸¦ç±»å‹ï¼‰
```

---

## **2. é…ç½® `tsconfig.json`**
åœ¨é¡¹ç›®çš„ `tsconfig.json` ä¸­ï¼Œç¡®ä¿ä»¥ä¸‹é…ç½®æ­£ç¡®ï¼š

### **(1) åŒ…å« `node_modules` ç±»å‹**
```json
{
  "compilerOptions": {
    "types": ["package-name"],  // æ˜¾å¼å¼•å…¥å…¨å±€ç±»å‹åŒ…
    "typeRoots": [
      "./node_modules/@types",  // é»˜è®¤ç±»å‹è·¯å¾„
      "./src/@types"            // è‡ªå®šä¹‰ç±»å‹è·¯å¾„ï¼ˆå¯é€‰ï¼‰
    ]
  },
  "include": ["src/**/*"]       // ç¡®ä¿åŒ…å« src ç›®å½•
}
```

### **(2) å…è®¸è§£æ `node_modules`**
```json
{
  "compilerOptions": {
    "moduleResolution": "node"  // ä½¿ç”¨ Node.js çš„æ¨¡å—è§£æç­–ç•¥
  }
}
```

---

## **3. å…¨å±€ç±»å‹çš„å£°æ˜æ‰©å±•**
å¦‚æœç±»å‹åŒ…æ˜¯å…¨å±€çš„ï¼ˆå¦‚ `@types/jquery`ï¼‰ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨æ‰©å±•å…¨å±€ç±»å‹ï¼š

### **(1) åœ¨ `src` ä¸‹åˆ›å»ºå£°æ˜æ–‡ä»¶**
åœ¨ `src/@types` æˆ– `src` ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª `.d.ts` æ–‡ä»¶ï¼ˆå¦‚ `global.d.ts`ï¼‰ï¼š
```typescript
// src/@types/global.d.ts
import "package-name";  // å¯¼å…¥å…¨å±€ç±»å‹åŒ…
```

### **(2) æ‰©å±•å…¨å±€æ¥å£**
å¦‚æœéœ€è¦æ‰©å±•å…¨å±€å˜é‡æˆ–æ¨¡å—ï¼š
```typescript
// src/@types/global.d.ts
declare global {
  interface Window {
    myCustomProp: string;  // æ‰©å±•å…¨å±€ Window ç±»å‹
  }
}
```

---

## **4. åœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨**
å®Œæˆé…ç½®åï¼Œåœ¨ `src` ä¸‹çš„ä»£ç ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»å‹åŒ…ï¼š
```typescript
// src/index.ts
import _ from "lodash";  // ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“çš„ç±»å‹
const list: _.List<number> = [1, 2, 3];

// ä½¿ç”¨å…¨å±€ç±»å‹ï¼ˆå¦‚ jQueryï¼‰
declare const $: JQueryStatic;
$("#app").hide();
```

---

## **5. å¤„ç†å¸¸è§é—®é¢˜**
### **(1) ç±»å‹æ‰¾ä¸åˆ°**
- **åŸå› **ï¼šç±»å‹åŒ…æœªæ­£ç¡®å®‰è£…æˆ– `tsconfig.json` é…ç½®é”™è¯¯ã€‚
- **è§£å†³**ï¼š
  ```bash
  npm install --save-dev @types/package-name
  ```
  æ£€æŸ¥ `tsconfig.json` çš„ `types` å’Œ `typeRoots` é…ç½®ã€‚

### **(2) å…¨å±€ç±»å‹æœªç”Ÿæ•ˆ**
- **åŸå› **ï¼šå£°æ˜æ–‡ä»¶æœªè¢« TypeScript è¯†åˆ«ã€‚
- **è§£å†³**ï¼š
  ç¡®ä¿ `.d.ts` æ–‡ä»¶åœ¨ `include` èŒƒå›´å†…ï¼Œæˆ–æ˜¾å¼å¼•ç”¨ï¼š
  ```typescript
  /// <reference types="package-name" />
  ```

### **(3) æ¨¡å—ç±»å‹å†²çª**
- **åŸå› **ï¼šå¤šä¸ªç±»å‹åŒ…å®šä¹‰äº†ç›¸åŒçš„æ¨¡å—ã€‚
- **è§£å†³**ï¼šåœ¨ `tsconfig.json` ä¸­æŒ‡å®šä¼˜å…ˆçº§ï¼š
  ```json
  {
    "compilerOptions": {
      "paths": {
        "package-name": ["node_modules/accurate-types"]
      }
    }
  }
  ```

---

## **6. ç¤ºä¾‹é¡¹ç›®ç»“æ„**
```
project/
â”œâ”€â”€ node_modules/
â”‚   â””â”€â”€ @types/
â”‚       â””â”€â”€ jquery/  # å…¨å±€ç±»å‹åŒ…
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ @types/
â”‚   â”‚   â””â”€â”€ global.d.ts  # è‡ªå®šä¹‰å…¨å±€ç±»å‹
â”‚   â””â”€â”€ index.ts     # ä½¿ç”¨å…¨å±€ç±»å‹
â”œâ”€â”€ tsconfig.json
â””â”€â”€ package.json
```

---

## **æ€»ç»“**
1. **å®‰è£…ç±»å‹åŒ…**ï¼šç¡®ä¿ `@types/package-name` æˆ–è‡ªå¸¦ç±»å‹çš„åº“å·²å®‰è£…ã€‚
2. **é…ç½® `tsconfig.json`**ï¼šè®¾ç½® `types`ã€`typeRoots` å’Œ `moduleResolution`ã€‚
3. **å£°æ˜å…¨å±€ç±»å‹**ï¼šé€šè¿‡ `.d.ts` æ–‡ä»¶æ‰©å±•æˆ–å¯¼å…¥å…¨å±€ç±»å‹ã€‚
4. **ç›´æ¥ä½¿ç”¨**ï¼šåœ¨ `src` ä¸‹çš„ä»£ç ä¸­å¼•ç”¨ç±»å‹ã€‚

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå¯ä»¥æ— ç¼é›†æˆ `node_modules` ä¸­çš„å…¨å±€ç±»å‹åˆ°ä½ çš„ TypeScript é¡¹ç›®ä¸­ï¼ ğŸš€