## 68. Eslint ä»£ç æ£€æŸ¥çš„è¿‡ç¨‹æ˜¯å•¥ï¼Ÿ

`ESLint` æ˜¯ä¸€ä¸ªç”¨äº **é™æ€ä»£ç åˆ†æ** çš„å·¥å…·ï¼Œé€šè¿‡é¢„å®šä¹‰çš„è§„åˆ™æ£€æŸ¥ JavaScript/TypeScript ä»£ç ä¸­çš„æ½œåœ¨é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å®ƒçš„æ ¸å¿ƒå·¥ä½œæµç¨‹å’ŒåŸç†è¯¦è§£ï¼š

---

## **1. æ ¸å¿ƒæ£€æŸ¥æµç¨‹**
### **(1) è§£æï¼ˆParsingï¼‰**
- **å°†ä»£ç è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰**ï¼š
  ESLint ä½¿ç”¨è§£æå™¨ï¼ˆå¦‚ `Espree`ã€`@typescript-eslint/parser`ï¼‰å°†æºä»£ç è§£æä¸º ASTï¼Œç”Ÿæˆä¸€æ£µç»“æ„åŒ–è¯­æ³•æ ‘ã€‚
  ```javascript
  // ç¤ºä¾‹ä»£ç 
  const foo = 1;
  ```
  å¯¹åº”çš„ AST ç‰‡æ®µï¼š
  ```json
  {
    "type": "VariableDeclaration",
    "declarations": [{
      "type": "VariableDeclarator",
      "id": { "type": "Identifier", "name": "foo" },
      "init": { "type": "Literal", "value": 1 }
    }]
  }
  ```

### **(2) éå†ï¼ˆTraversalï¼‰**
- **è®¿é—® AST èŠ‚ç‚¹**ï¼š
  ESLint é€šè¿‡ **æ·±åº¦ä¼˜å…ˆéå†** è®¿é—® AST çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œæ£€æŸ¥æ˜¯å¦ç¬¦åˆè§„åˆ™ã€‚
    - ä¾‹å¦‚ï¼šæ£€æŸ¥å˜é‡æ˜¯å¦æœªä½¿ç”¨ï¼ˆ`no-unused-vars` è§„åˆ™ï¼‰ã€‚

### **(3) è§„åˆ™æ£€æŸ¥ï¼ˆLintingï¼‰**
- **åº”ç”¨è§„åˆ™é›†**ï¼š
  æ¯æ¡è§„åˆ™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶å½“å‰èŠ‚ç‚¹å’Œä¸Šä¸‹æ–‡ï¼Œè¿”å›é”™è¯¯æˆ–è­¦å‘Šã€‚
  ```javascript
  // ç¤ºä¾‹è§„åˆ™ï¼šç¦æ­¢ä½¿ç”¨ console
  module.exports = {
    create(context) {
      return {
        CallExpression(node) {
          if (node.callee.object?.name === 'console') {
            context.report({ node, message: 'Unexpected console statement' });
          }
        }
      };
    }
  };
  ```

### **(4) æŠ¥å‘Šï¼ˆReportingï¼‰**
- **è¾“å‡ºé—®é¢˜**ï¼š
  å°†æ£€æŸ¥ç»“æœåˆ†ç±»ä¸ºé”™è¯¯ï¼ˆErrorï¼‰æˆ–è­¦å‘Šï¼ˆWarningï¼‰ï¼Œå¹¶æ˜¾ç¤ºä½ç½®å’Œä¿®å¤å»ºè®®ã€‚
  ```
  /src/index.js
    1:5  error  'foo' is assigned but never used  no-unused-vars
  ```

---

## **2. å…³é”®ç»„æˆéƒ¨åˆ†**
### **(1) é…ç½®æ–‡ä»¶ï¼ˆ.eslintrcï¼‰**
å®šä¹‰æ£€æŸ¥è§„åˆ™å’Œè§£æå™¨é…ç½®ï¼š
```json
{
  "parser": "@typescript-eslint/parser",
  "rules": {
    "no-unused-vars": "error",
    "semi": ["error", "always"]
  }
}
```

### **(2) æ’ä»¶ï¼ˆPluginsï¼‰**
æ‰©å±• ESLint çš„èƒ½åŠ›ï¼š
- **æ·»åŠ è§„åˆ™**ï¼šå¦‚ `eslint-plugin-react` æä¾› React ç›¸å…³è§„åˆ™ã€‚
- **æ”¯æŒæ–°è¯­æ³•**ï¼šå¦‚ `@typescript-eslint` æ”¯æŒ TypeScriptã€‚

### **(3) å…±äº«é…ç½®ï¼ˆShareable Configsï¼‰**
ç›´æ¥å¤ç”¨é¢„è®¾è§„åˆ™é›†ï¼š
```json
{
  "extends": ["airbnb", "prettier"]
}
```

### **(4) è§£æå™¨ï¼ˆParserï¼‰**
- é»˜è®¤è§£æå™¨ï¼š`Espree`ï¼ˆåŸºäº Acornï¼‰ã€‚
- å…¶ä»–è§£æå™¨ï¼š
    - `@typescript-eslint/parser`ï¼šè§£æ TypeScriptã€‚
    - `babel-eslint`ï¼šæ”¯æŒå®éªŒæ€§è¯­æ³•ã€‚

---

## **3. æ‰§è¡Œæ–¹å¼**
### **(1) å‘½ä»¤è¡Œ**
```bash
eslint src/**/*.js --fix  # æ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤
```

### **(2) ç¼–è¾‘å™¨é›†æˆ**
- **VS Code**ï¼šé€šè¿‡ `ESLint` æ’ä»¶å®æ—¶æ£€æŸ¥ã€‚
- **WebStorm**ï¼šå†…ç½®æ”¯æŒã€‚

### **(3) æ„å»ºå·¥å…·é›†æˆ**
- **Webpack**ï¼š`eslint-webpack-plugin`ã€‚
- **Vite**ï¼š`vite-plugin-eslint`ã€‚

---

## **4. æ€§èƒ½ä¼˜åŒ–**
### **(1) å¢é‡æ£€æŸ¥**
åªæ£€æŸ¥ä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼š
```bash
eslint --cache
```

### **(2) å¿½ç•¥æ–‡ä»¶**
é€šè¿‡ `.eslintignore` æ’é™¤ä¸éœ€è¦æ£€æŸ¥çš„æ–‡ä»¶ï¼š
```
node_modules/
dist/
```

### **(3) å¹¶è¡Œæ£€æŸ¥**
ä½¿ç”¨ `--max-warnings` å’Œ `--no-inline-config` å‡å°‘å¼€é”€ã€‚

---

## **5. ä¸ Prettier çš„åä½œ**
- **åˆ†å·¥**ï¼š
    - ESLint è´Ÿè´£ä»£ç è´¨é‡ï¼ˆå¦‚æœªä½¿ç”¨çš„å˜é‡ï¼‰ã€‚
    - Prettier è´Ÿè´£ä»£ç é£æ ¼ï¼ˆå¦‚ç¼©è¿›ã€å¼•å·ï¼‰ã€‚
- **é›†æˆé…ç½®**ï¼š
  ```json
  {
    "extends": ["prettier"],
    "plugins": ["prettier"],
    "rules": {
      "prettier/prettier": "error"
    }
  }
  ```

---

## **6. ç¤ºä¾‹ï¼šä»é›¶é…ç½® ESLint**
### **(1) å®‰è£…ä¾èµ–**
```bash
npm install eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin --save-dev
```

### **(2) é…ç½®æ–‡ä»¶ï¼ˆ.eslintrc.jsï¼‰**
```javascript
module.exports = {
  parser: "@typescript-eslint/parser",
  plugins: ["@typescript-eslint"],
  extends: ["eslint:recommended", "plugin:@typescript-eslint/recommended"],
  rules: {
    "@typescript-eslint/no-unused-vars": "error"
  }
};
```

### **(3) è¿è¡Œæ£€æŸ¥**
```bash
eslint src/**/*.ts --fix
```

---

## **7. æ€»ç»“**
- **æ ¸å¿ƒæµç¨‹**ï¼šè§£æ â†’ éå† â†’ è§„åˆ™æ£€æŸ¥ â†’ æŠ¥å‘Šã€‚
- **å…³é”®é…ç½®**ï¼šè§„åˆ™ã€æ’ä»¶ã€è§£æå™¨ã€å…±äº«é…ç½®ã€‚
- **ä¼˜åŒ–æ–¹å‘**ï¼šå¢é‡æ£€æŸ¥ã€å¹¶è¡Œå¤„ç†ã€ç¼–è¾‘å™¨é›†æˆã€‚

é€šè¿‡ ESLintï¼Œå¯ä»¥ç³»ç»ŸåŒ–åœ°æå‡ä»£ç è´¨é‡å’Œå›¢é˜Ÿåä½œæ•ˆç‡ï¼ ğŸ› ï¸