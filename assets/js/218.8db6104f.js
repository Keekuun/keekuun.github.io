(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{926:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#一、核心架构升级"}},[t._v("一、核心架构升级")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-server-components-服务端组件-正式支持"}},[t._v("1. Server Components（服务端组件）正式支持")])]),s("li",[s("a",{attrs:{href:"#_2-react-compiler编译器优化"}},[t._v("2. React Compiler编译器优化")])])])]),s("li",[s("a",{attrs:{href:"#二、新-hook-api"}},[t._v("二、新 Hook API")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-use-hook"}},[t._v("1. use() Hook")])]),s("li",[s("a",{attrs:{href:"#_2-useactionstate"}},[t._v("2. useActionState")])]),s("li",[s("a",{attrs:{href:"#_3-useoptimistic"}},[t._v("3. useOptimistic")])])])]),s("li",[s("a",{attrs:{href:"#三、渲染系统改进"}},[t._v("三、渲染系统改进")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-自动批量更新增强"}},[t._v("1. 自动批量更新增强")])]),s("li",[s("a",{attrs:{href:"#_2-新的渲染返回值"}},[t._v("2. 新的渲染返回值")])]),s("li",[s("a",{attrs:{href:"#_3-hydration-错误处理"}},[t._v("3. hydration 错误处理")])])])]),s("li",[s("a",{attrs:{href:"#四、开发者体验"}},[t._v("四、开发者体验")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-调试工具升级"}},[t._v("1. 调试工具升级")])]),s("li",[s("a",{attrs:{href:"#_2-typescript-5-0-深度集成"}},[t._v("2. TypeScript 5.0+ 深度集成")])]),s("li",[s("a",{attrs:{href:"#_3-错误边界增强"}},[t._v("3. 错误边界增强")])])])]),s("li",[s("a",{attrs:{href:"#五、破坏性变更"}},[t._v("五、破坏性变更")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-移除的-api"}},[t._v("1. 移除的 API")])]),s("li",[s("a",{attrs:{href:"#_2-严格模式新行为"}},[t._v("2. 严格模式新行为")])]),s("li",[s("a",{attrs:{href:"#_3-最低浏览器要求"}},[t._v("3. 最低浏览器要求")])])])]),s("li",[s("a",{attrs:{href:"#六、生态系统适配"}},[t._v("六、生态系统适配")])]),s("li",[s("a",{attrs:{href:"#七、完整迁移指南-建议参考"}},[t._v("七、完整迁移指南建议参考：")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"一、核心架构升级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、核心架构升级"}},[t._v("🌙")]),t._v(" "),s("strong",[t._v("一、核心架构升级")])]),t._v(" "),s("h3",{attrs:{id:"_1-server-components-服务端组件-正式支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-server-components-服务端组件-正式支持"}},[t._v("🌙")]),t._v(" 1. "),s("strong",[t._v("Server Components（服务端组件）正式支持")])]),t._v(" "),s("ul",[s("li",[t._v("原生支持组件级流式 SSR")]),t._v(" "),s("li",[t._v("新增 "),s("code",[t._v("server")]),t._v(" 和 "),s("code",[t._v("client")]),t._v(" 编译指令")])]),t._v(" "),s("div",{staticClass:"language-jsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-jsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use server'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ServerButton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 仅在服务端执行 */")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"_2-react-compiler编译器优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-react-compiler编译器优化"}},[t._v("🌙")]),t._v(" 2. "),s("strong",[t._v("React Compiler编译器优化")])]),t._v(" "),s("ul",[s("li",[t._v("React Compiler 旨在通过编译时优化 React 代码，提升运行时性能。\n"),s("ul",[s("li",[t._v("自动优化组件重渲染，替代手动 "),s("code",[t._v("useMemo")]),t._v("/"),s("code",[t._v("useCallback")])]),t._v(" "),s("li",[t._v("编译时静态分析依赖关系")]),t._v(" "),s("li",[t._v("示例效果：减少 30-50% 不必要的渲染")])])])]),t._v(" "),s("h2",{attrs:{id:"二、新-hook-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、新-hook-api"}},[t._v("🌙")]),t._v(" "),s("strong",[t._v("二、新 Hook API")])]),t._v(" "),s("h3",{attrs:{id:"_1-use-hook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-use-hook"}},[t._v("🌙")]),t._v(" 1. "),s("strong",[t._v("use() Hook")])]),t._v(" "),s("ul",[s("li",[t._v("统一异步资源读取方式，支持：")]),t._v(" "),s("li",[t._v("Promises")]),t._v(" "),s("li",[t._v("Context")]),t._v(" "),s("li",[t._v("数据加载")])]),t._v(" "),s("div",{staticClass:"language-jsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-jsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api/data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"_2-useactionstate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-useactionstate"}},[t._v("🌙")]),t._v(" 2. "),s("strong",[t._v("useActionState")])]),t._v(" "),s("ul",[s("li",[t._v("合并 "),s("code",[t._v("useFormState")]),t._v(" + "),s("code",[t._v("useFormStatus")])]),t._v(" "),s("li",[t._v("完整状态管理：")])]),t._v(" "),s("div",{staticClass:"language-jsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-jsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isPending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useActionState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("prevState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" formData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submitForm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("formData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" initialState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"_3-useoptimistic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-useoptimistic"}},[t._v("🌙")]),t._v(" 3. "),s("code",[t._v("useOptimistic")])]),t._v(" "),s("p",[s("strong",[t._v("用途")]),t._v("：实现乐观更新（即在等待服务器响应前先更新UI）")]),t._v(" "),s("h4",{attrs:{id:"核心特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#核心特性"}},[t._v("🌙")]),t._v(" 核心特性：")]),t._v(" "),s("div",{staticClass:"language-jsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-jsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("optimisticState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addOptimistic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useOptimistic")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  baseState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("currentState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" optimisticValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回新的乐观状态")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("currentState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" optimisticValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h4",{attrs:{id:"完整示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#完整示例"}},[t._v("🌙")]),t._v(" 完整示例：")]),t._v(" "),s("div",{staticClass:"language-jsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-jsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("TodoList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("todos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setTodos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("optimisticTodos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addOptimisticTodo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useOptimistic")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    todos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("currentTodos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newTodo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("currentTodos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("newTodo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_pending")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("addTodo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("text")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newTodo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addOptimisticTodo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newTodo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 立即显示")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api/todos'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("body")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" text "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTodos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 回滚 optimistic update")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTodos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("todos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ul")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("optimisticTodos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("todo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token script language-javascript"}},[s("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("className")]),s("span",{pre:!0,attrs:{class:"token script language-javascript"}},[s("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_pending "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pending'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n            ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_pending "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' (保存中...)'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n          ")]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ul")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    ")]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br")])]),s("h2",{attrs:{id:"三、渲染系统改进"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、渲染系统改进"}},[t._v("🌙")]),t._v(" "),s("strong",[t._v("三、渲染系统改进")])]),t._v(" "),s("h3",{attrs:{id:"_1-自动批量更新增强"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-自动批量更新增强"}},[t._v("🌙")]),t._v(" 1. "),s("strong",[t._v("自动批量更新增强")])]),t._v(" "),s("ul",[s("li",[t._v("覆盖所有场景（包括异步代码、timeouts）")]),t._v(" "),s("li",[t._v("手动退出需用 "),s("code",[t._v("flushSync")])])]),t._v(" "),s("h3",{attrs:{id:"_2-新的渲染返回值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-新的渲染返回值"}},[t._v("🌙")]),t._v(" 2. "),s("strong",[t._v("新的渲染返回值")])]),t._v(" "),s("ul",[s("li",[t._v("支持返回普通对象、Map、Set")]),t._v(" "),s("li",[t._v("不再强制要求 "),s("code",[t._v("key")]),t._v(" 属性")])]),t._v(" "),s("h3",{attrs:{id:"_3-hydration-错误处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-hydration-错误处理"}},[t._v("🌙")]),t._v(" 3. "),s("strong",[t._v("hydration 错误处理")])]),t._v(" "),s("ul",[s("li",[t._v("新增 "),s("code",[t._v("onRecoverableError")]),t._v(" 回调")]),t._v(" "),s("li",[t._v("更清晰的客户端-服务端不匹配警告")])]),t._v(" "),s("h2",{attrs:{id:"四、开发者体验"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、开发者体验"}},[t._v("🌙")]),t._v(" "),s("strong",[t._v("四、开发者体验")])]),t._v(" "),s("h3",{attrs:{id:"_1-调试工具升级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-调试工具升级"}},[t._v("🌙")]),t._v(" 1. "),s("strong",[t._v("调试工具升级")])]),t._v(" "),s("ul",[s("li",[t._v("组件树性能火焰图")]),t._v(" "),s("li",[t._v("并发模式渲染优先级可视化")])]),t._v(" "),s("h3",{attrs:{id:"_2-typescript-5-0-深度集成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-typescript-5-0-深度集成"}},[t._v("🌙")]),t._v(" 2. "),s("strong",[t._v("TypeScript 5.0+ 深度集成")])]),t._v(" "),s("ul",[s("li",[t._v("组件 props 自动推导")]),t._v(" "),s("li",[t._v("更严格的 "),s("code",[t._v("useState")]),t._v(" 类型约束"),s("div",{staticClass:"language-tsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setCount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token generic-function"}},[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token generic class-name"}},[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必须提供初始值或明确undefined")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])])])]),t._v(" "),s("h3",{attrs:{id:"_3-错误边界增强"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-错误边界增强"}},[t._v("🌙")]),t._v(" 3. "),s("strong",[t._v("错误边界增强")])]),t._v(" "),s("ul",[s("li",[t._v("支持错误原因追踪")]),t._v(" "),s("li",[t._v("组件级错误恢复尝试")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"五、破坏性变更"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、破坏性变更"}},[t._v("🌙")]),t._v(" "),s("strong",[t._v("五、破坏性变更")])]),t._v(" "),s("h3",{attrs:{id:"_1-移除的-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-移除的-api"}},[t._v("🌙")]),t._v(" 1. "),s("strong",[t._v("移除的 API")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("React.children")]),t._v(" 方法")]),t._v(" "),s("li",[s("code",[t._v("unstable_createRoot")]),t._v("（直接使用 "),s("code",[t._v("createRoot")]),t._v("）")])]),t._v(" "),s("h3",{attrs:{id:"_2-严格模式新行为"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-严格模式新行为"}},[t._v("🌙")]),t._v(" 2. "),s("strong",[t._v("严格模式新行为")])]),t._v(" "),s("ul",[s("li",[t._v("开发环境下组件卸载/重新挂载逻辑调整")]),t._v(" "),s("li",[t._v("模拟生产环境渲染更准确")])]),t._v(" "),s("h3",{attrs:{id:"_3-最低浏览器要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-最低浏览器要求"}},[t._v("🌙")]),t._v(" 3. "),s("strong",[t._v("最低浏览器要求")])]),t._v(" "),s("ul",[s("li",[t._v("完全放弃 IE11 支持")]),t._v(" "),s("li",[t._v("需要现代浏览器原生支持 ES2017+")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"六、生态系统适配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、生态系统适配"}},[t._v("🌙")]),t._v(" "),s("strong",[t._v("六、生态系统适配")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("工具")]),t._v(" "),s("th",[t._v("适配要求")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Next.js 15+")]),t._v(" "),s("td",[t._v("必须更新以支持 RSC 新规范")])]),t._v(" "),s("tr",[s("td",[t._v("Redux Toolkit")]),t._v(" "),s("td",[t._v("需要 2.0+ 版本兼容新上下文系统")])]),t._v(" "),s("tr",[s("td",[t._v("Jest 30+")]),t._v(" "),s("td",[t._v("新增 React Compiler 转换插件")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"七、完整迁移指南建议参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、完整迁移指南建议参考"}},[t._v("🌙")]),t._v(" "),s("strong",[t._v("七、完整迁移指南")]),t._v("建议参考：")]),t._v(" "),s("ol",[s("li",[t._v("官方升级工具："),s("code",[t._v("npx react-codemod@latest")])]),t._v(" "),s("li",[t._v("逐步迁移策略文档")]),t._v(" "),s("li",[t._v("兼容性检查工具包"),s("code",[t._v("react-compat-check")])])]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://react.dev/blog/2024/12/05/react-19",target:"_blank",rel:"noopener noreferrer"}},[t._v("React 19 is now stable!"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);