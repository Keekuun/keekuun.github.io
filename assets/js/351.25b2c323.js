(window.webpackJsonp=window.webpackJsonp||[]).push([[351],{1071:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("blockquote",[t("p",[s._v("æœ¬æ–‡æ·±å…¥æµ…å‡ºåœ°è®²è§£ BFCacheï¼ˆå¾€è¿”ç¼“å­˜ / Back/Forward Cacheï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªèƒ½å¤Ÿæå¤§æå‡ç”¨æˆ·ä½“éªŒï¼Œç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯ä½“éªŒçš„å…³é”®æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ã€‚")])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"ä»æµ…å…¥æ·±-ç†è§£-bfcache"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»æµ…å…¥æ·±-ç†è§£-bfcache"}},[s._v("ğŸŒ™")]),s._v(" ä»æµ…å…¥æ·±ï¼Œç†è§£ BFCache")]),s._v(" "),t("h4",{attrs:{id:"_1-ä»€ä¹ˆæ˜¯-bfcache-å®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä»€ä¹ˆæ˜¯-bfcache-å®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜"}},[s._v("ğŸŒ™")]),s._v(" 1. ä»€ä¹ˆæ˜¯ BFCacheï¼Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ")]),s._v(" "),t("p",[s._v("æƒ³è±¡ä¸€ä¸ªå¸¸è§çš„åœºæ™¯ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ä½ æ­£åœ¨æ‰‹æœºä¸Šæµè§ˆä¸€ä¸ªå•†å“åˆ—è¡¨é¡µï¼ˆé¡µé¢Aï¼‰ã€‚")]),s._v(" "),t("li",[s._v("ä½ æ»šåŠ¨äº†å¾ˆä¹…ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªæ„Ÿå…´è¶£çš„å•†å“ï¼Œç‚¹å‡»è¿›å…¥äº†å•†å“è¯¦æƒ…é¡µï¼ˆé¡µé¢Bï¼‰ã€‚")]),s._v(" "),t("li",[s._v("çœ‹å®Œåï¼Œä½ ç‚¹å‡»äº†æµè§ˆå™¨çš„â€œåé€€â€æŒ‰é’®ï¼Œæƒ³å›åˆ°åˆšæ‰çš„åˆ—è¡¨é¡µï¼ˆé¡µé¢Aï¼‰ã€‚")])]),s._v(" "),t("p",[t("strong",[s._v("æ²¡æœ‰ BFCache çš„æƒ…å†µï¼š")]),s._v("\næµè§ˆå™¨ä¼šé‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢Aã€‚è¿™æ„å‘³ç€ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("é‡æ–°è¯·æ±‚ HTMLã€CSSã€JS æ–‡ä»¶ã€‚")]),s._v(" "),t("li",[s._v("é‡æ–°æ‰§è¡Œ JavaScriptï¼Œé‡æ–°æ¸²æŸ“ DOMã€‚")]),s._v(" "),t("li",[t("strong",[s._v("ä½ ä¹‹å‰æ»šåˆ°çš„ä½ç½®ä¸¢å¤±äº†ï¼")]),s._v(" ä½ å›åˆ°äº†åˆ—è¡¨é¡µçš„é¡¶éƒ¨ï¼Œéœ€è¦é‡æ–°æ»šåŠ¨æŸ¥æ‰¾ã€‚")]),s._v(" "),t("li",[s._v("æ•´ä¸ªè¿‡ç¨‹å¾ˆæ…¢ï¼Œæœ‰æ˜æ˜¾çš„ç™½å±æ—¶é—´ï¼Œä½“éªŒéå¸¸ç³Ÿç³•ã€‚")])]),s._v(" "),t("p",[t("strong",[s._v("æœ‰äº† BFCache çš„æƒ…å†µï¼š")]),s._v("\nå½“ä½ ç¦»å¼€é¡µé¢Aæ—¶ï¼Œç°ä»£æµè§ˆå™¨ä¼šåƒæ‹â€œå¿«ç…§â€ä¸€æ ·ï¼Œå°†æ•´ä¸ªé¡µé¢çš„çŠ¶æ€ï¼ˆåŒ…æ‹¬ DOM æ ‘ã€JavaScript å †å†…å­˜ã€æ»šåŠ¨ä½ç½®ç­‰ï¼‰å®Œæ•´åœ°ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚")]),s._v(" "),t("p",[s._v("å½“ä½ ç‚¹å‡»â€œåé€€â€æŒ‰é’®æ—¶ï¼Œæµè§ˆå™¨ä¼šç›´æ¥ä»å†…å­˜ä¸­æ¢å¤è¿™ä¸ªâ€œå¿«ç…§â€ï¼Œè€Œä¸æ˜¯é‡æ–°åŠ è½½ã€‚è¿™æ„å‘³ç€ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("é¡µé¢å‡ ä¹æ˜¯"),t("strong",[s._v("ç¬æ—¶")]),s._v("æ¢å¤ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("ä½ ä¹‹å‰æ»šåˆ°çš„ä½ç½®ã€å¡«å†™äº†ä¸€åŠçš„è¡¨å•æ•°æ®ã€JSä¸­çš„å˜é‡çŠ¶æ€éƒ½å®Œç¾ä¿ç•™ã€‚")])]),s._v(" "),t("li",[s._v("ç”¨æˆ·ä½“éªŒå¦‚ä¸èˆ¬é¡ºæ»‘ã€‚")])]),s._v(" "),t("p",[t("strong",[s._v("æ ¸å¿ƒæ¯”å–»ï¼š")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("æ™®é€šåŠ è½½")]),s._v(" = å…³æ‰ç”µè„‘å†é‡æ–°å¼€æœºã€‚")]),s._v(" "),t("li",[t("strong",[s._v("BFCache")]),s._v(" = è®©ç”µè„‘è¿›å…¥â€œç¡çœ â€æ¨¡å¼ï¼Œç„¶åç¬é—´å”¤é†’ã€‚")])]),s._v(" "),t("hr"),s._v(" "),t("h4",{attrs:{id:"_2-bfcache-çš„å·¥ä½œåŸç†å’Œç”Ÿå‘½å‘¨æœŸäº‹ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-bfcache-çš„å·¥ä½œåŸç†å’Œç”Ÿå‘½å‘¨æœŸäº‹ä»¶"}},[s._v("ğŸŒ™")]),s._v(" 2. BFCache çš„å·¥ä½œåŸç†å’Œç”Ÿå‘½å‘¨æœŸäº‹ä»¶")]),s._v(" "),t("p",[s._v("è¦åˆ©ç”¨å¥½ BFCacheï¼Œæˆ‘ä»¬å¿…é¡»ç†è§£å®ƒå¼•å…¥çš„ä¸¤ä¸ªå…³é”®é¡µé¢ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼š"),t("code",[s._v("pageshow")]),s._v(" å’Œ "),t("code",[s._v("pagehide")]),s._v("ã€‚è¿™ä¸¤ä¸ªäº‹ä»¶æ˜¯ä¸ºäº†å–ä»£æ—§çš„ã€ä¼šç ´å BFCache çš„ "),t("code",[s._v("load")]),s._v(" å’Œ "),t("code",[s._v("unload")]),s._v(" äº‹ä»¶è€Œè®¾è®¡çš„ã€‚")]),s._v(" "),t("h5",{attrs:{id:"pagehide-äº‹ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pagehide-äº‹ä»¶"}},[s._v("ğŸŒ™")]),s._v(" "),t("strong",[t("code",[s._v("pagehide")]),s._v(" äº‹ä»¶")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è§¦å‘æ—¶æœº")]),s._v("ï¼šå½“ç”¨æˆ·å³å°†ç¦»å¼€å½“å‰é¡µé¢æ—¶è§¦å‘ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å…³é”®å±æ€§")]),s._v("ï¼šäº‹ä»¶å¯¹è±¡ "),t("code",[s._v("event")]),s._v(" ä¸­åŒ…å«ä¸€ä¸ªå¸ƒå°”å€¼ "),t("code",[s._v("persisted")]),s._v("ã€‚\n"),t("ul",[t("li",[t("code",[s._v("event.persisted === true")]),s._v("ï¼šè¡¨ç¤ºé¡µé¢"),t("strong",[s._v("æ­£åœ¨è¢«å­˜å…¥ BFCache")]),s._v("ï¼Œæœªæ¥æœ‰å¯èƒ½è¢«æ¢å¤ã€‚")]),s._v(" "),t("li",[t("code",[s._v("event.persisted === false")]),s._v("ï¼šè¡¨ç¤ºé¡µé¢"),t("strong",[s._v("ä¸ä¼šè¢«ç¼“å­˜")]),s._v("ï¼Œå°†è¢«æ­£å¸¸å¸è½½ã€‚")])])])]),s._v(" "),t("h5",{attrs:{id:"pageshow-äº‹ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pageshow-äº‹ä»¶"}},[s._v("ğŸŒ™")]),s._v(" "),t("strong",[t("code",[s._v("pageshow")]),s._v(" äº‹ä»¶")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è§¦å‘æ—¶æœº")]),s._v("ï¼šå½“ç”¨æˆ·è¿›å…¥æˆ–è¿”å›åˆ°å½“å‰é¡µé¢æ—¶è§¦å‘ã€‚å®ƒåœ¨ä¼ ç»Ÿçš„ "),t("code",[s._v("load")]),s._v(" äº‹ä»¶ä¹‹åè§¦å‘ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å…³é”®å±æ€§")]),s._v("ï¼šäº‹ä»¶å¯¹è±¡ "),t("code",[s._v("event")]),s._v(" ä¸­ä¹ŸåŒ…å«ä¸€ä¸ªå¸ƒå°”å€¼ "),t("code",[s._v("persisted")]),s._v("ã€‚\n"),t("ul",[t("li",[t("code",[s._v("event.persisted === true")]),s._v("ï¼šè¡¨ç¤ºé¡µé¢æ˜¯"),t("strong",[s._v("ä» BFCache ä¸­æ¢å¤")]),s._v("çš„ã€‚è¿™æ—¶ "),t("code",[s._v("load")]),s._v(" äº‹ä»¶ä¸ä¼šè§¦å‘ï¼")]),s._v(" "),t("li",[t("code",[s._v("event.persisted === false")]),s._v("ï¼šè¡¨ç¤ºé¡µé¢æ˜¯"),t("strong",[s._v("é¦–æ¬¡åŠ è½½")]),s._v("ï¼ˆæˆ–æµè§ˆå™¨ä¸æ”¯æŒ BFCacheï¼‰ã€‚")])])])]),s._v(" "),t("h5",{attrs:{id:"ä»£ç ç¤ºä¾‹-typescript"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç ç¤ºä¾‹-typescript"}},[s._v("ğŸŒ™")]),s._v(" "),t("strong",[s._v("ä»£ç ç¤ºä¾‹ (TypeScript)")])]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[s._v("window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pageshow'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" PageTransitionEvent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("persisted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é¡µé¢ä» BFCache ä¸­æ¢å¤")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'This page was restored from the BFCache.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨è¿™é‡Œæ‰§è¡Œæ¢å¤åéœ€è¦æ›´æ–°çš„é€»è¾‘ï¼Œæ¯”å¦‚é‡æ–°è¯·æ±‚å®æ—¶æ•°æ®")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("refreshRealTimeData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é¡µé¢æ˜¯é¦–æ¬¡åŠ è½½")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'This page was loaded normally.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nwindow"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pagehide'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" PageTransitionEvent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("persisted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é¡µé¢å³å°†è¿›å…¥ BFCache")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'This page will be saved in the BFCache.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨è¿™é‡Œå¯ä»¥åšä¸€äº›æ¸…ç†å·¥ä½œï¼Œä½†ä¸èƒ½æ˜¯ç ´åæ€§çš„")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é¡µé¢å°†è¢«æ­£å¸¸å¸è½½")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'This page will be unloaded.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("refreshRealTimeData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Fetching fresh data because the page was restored...'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¾‹å¦‚ï¼šfetch('/api/latest-news').then(...)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("hr"),s._v(" "),t("h4",{attrs:{id:"_3-ä¸ºä»€ä¹ˆæˆ‘çš„é¡µé¢æ— æ³•è¿›å…¥-bfcache"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-ä¸ºä»€ä¹ˆæˆ‘çš„é¡µé¢æ— æ³•è¿›å…¥-bfcache"}},[s._v("ğŸŒ™")]),s._v(" 3. ä¸ºä»€ä¹ˆæˆ‘çš„é¡µé¢æ— æ³•è¿›å…¥ BFCacheï¼Ÿ")]),s._v(" "),t("p",[s._v("è¿™æ˜¯æœ€å…³é”®çš„å®è·µéƒ¨åˆ†ã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„é¡µé¢æ— æ³•äº«å— BFCache å¸¦æ¥çš„å¥½å¤„ï¼Œé€šå¸¸æ˜¯å› ä¸ºåŒ…å«äº†ä¸€äº›â€œä¸å…¼å®¹â€çš„ç‰¹æ€§ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("å¯¼è‡´ BFCache å¤±æ•ˆçš„å¸¸è§åŸå› ï¼š")])]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[t("code",[s._v("unload")]),s._v(" äº‹ä»¶ç›‘å¬å™¨ï¼š")]),s._v(" è¿™æ˜¯"),t("strong",[s._v("å¤´å·æ€æ‰‹")]),s._v("ã€‚ä»»ä½•åœ¨ "),t("code",[s._v("window")]),s._v(" ä¸Šæ³¨å†Œçš„ "),t("code",[s._v("unload")]),s._v(" äº‹ä»¶éƒ½ä¼šè®©æµè§ˆå™¨æ”¾å¼ƒç¼“å­˜è¯¥é¡µé¢ã€‚å› ä¸ºæµè§ˆå™¨æ— æ³•ä¿è¯ "),t("code",[s._v("unload")]),s._v(" é‡Œçš„ä»£ç æ‰§è¡Œåï¼Œé¡µé¢è¿˜èƒ½è¢«å®‰å…¨åœ°æ¢å¤ã€‚")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è§£å†³æ–¹æ¡ˆ")]),s._v("ï¼š"),t("strong",[s._v("æ°¸è¿œç”¨ "),t("code",[s._v("pagehide")]),s._v(" ä»£æ›¿ "),t("code",[s._v("unload")])]),s._v("ã€‚å¦‚æœä½ ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆæ¯”å¦‚ä¸€äº›æ—§çš„ç»Ÿè®¡è„šæœ¬ï¼‰è¿˜åœ¨ç”¨ "),t("code",[s._v("unload")]),s._v("ï¼Œè¯·è”ç³»å…¶å¼€å‘è€…æ›´æ–°æˆ–å¯»æ‰¾æ›¿ä»£å“ã€‚")])])]),s._v(" "),t("li",[t("p",[t("strong",[t("code",[s._v("Cache-Control: no-store")]),s._v(" HTTP å¤´ï¼š")]),s._v(" å¦‚æœé¡µé¢å“åº”å¤´ä¸­åŒ…å« "),t("code",[s._v("Cache-Control: no-store")]),s._v("ï¼Œæµè§ˆå™¨ä¼šéµä»è¿™ä¸ªæŒ‡ä»¤ï¼Œä¸ç¼“å­˜é¡µé¢ã€‚")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("æ³¨æ„")]),s._v("ï¼š"),t("code",[s._v("no-cache")]),s._v(" é€šå¸¸ä¸å½±å“ BFCacheï¼Œä½† "),t("code",[s._v("no-store")]),s._v(" ä¼šã€‚")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("æœªå…³é—­çš„è¿æ¥ï¼š")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("WebSocket")]),s._v(" æˆ– "),t("strong",[s._v("WebRTC")]),s._v(" è¿æ¥ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("IndexedDB")]),s._v(" äº‹åŠ¡ã€‚")]),s._v(" "),t("li",[t("strong",[t("code",[s._v("fetch")]),s._v(" æˆ– "),t("code",[s._v("XMLHttpRequest")])]),s._v(" ä»åœ¨è¿›è¡Œä¸­ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("è§£å†³æ–¹æ¡ˆ")]),s._v("ï¼šåœ¨ "),t("code",[s._v("pagehide")]),s._v(" äº‹ä»¶ä¸­ï¼Œå¦¥å–„å…³é—­è¿™äº›è¿æ¥æˆ–è¯·æ±‚ã€‚")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("éœ€è¦ç”¨æˆ·æˆæƒçš„ APIï¼š")]),s._v(" å¦‚æœé¡µé¢æ­£åœ¨ä½¿ç”¨æ‘„åƒå¤´ã€éº¦å…‹é£æˆ–åœ°ç†ä½ç½®ç­‰éœ€è¦ç”¨æˆ·æˆæƒçš„ APIï¼Œé€šå¸¸æ— æ³•è¢«ç¼“å­˜ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[t("code",[s._v("window.opener")]),s._v(" å¼•ç”¨ï¼š")]),s._v(" å¦‚æœé¡µé¢æ˜¯é€šè¿‡ "),t("code",[s._v("window.open")]),s._v(" æ‰“å¼€çš„ï¼Œå¹¶ä¸”ä¿ç•™äº†å¯¹çˆ¶çª—å£ï¼ˆ"),t("code",[s._v("window.opener")]),s._v("ï¼‰çš„å¼•ç”¨ï¼Œå¯èƒ½ä¼šé˜»æ­¢ BFCacheã€‚ä½¿ç”¨ "),t("code",[s._v('rel="noopener"')]),s._v(" å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚")])])]),s._v(" "),t("p",[t("strong",[s._v("å¦‚ä½•æ£€æŸ¥ BFCache æ˜¯å¦ç”Ÿæ•ˆï¼Ÿ")])]),s._v(" "),t("p",[t("strong",[s._v("Chrome DevTools")]),s._v(" æ˜¯ä½ çš„å¥½æœ‹å‹ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("æ‰“å¼€å¼€å‘è€…å·¥å…· ("),t("code",[s._v("F12")]),s._v(")ã€‚")]),s._v(" "),t("li",[s._v("è¿›å…¥ "),t("code",[s._v("Application")]),s._v(" (åº”ç”¨) é¢æ¿ã€‚")]),s._v(" "),t("li",[s._v("åœ¨å·¦ä¾§å¯¼èˆªæ æ‰¾åˆ° "),t("code",[s._v("Background services")]),s._v(" (åå°æœåŠ¡) ä¸‹çš„ "),t("code",[s._v("Back/forward cache")]),s._v("ã€‚")]),s._v(" "),t("li",[s._v("ç‚¹å‡» "),t("code",[s._v("Run Test")]),s._v(" æŒ‰é’®ã€‚DevTools ä¼šæ¨¡æ‹Ÿä¸€æ¬¡å¾€è¿”å¯¼èˆªï¼Œå¹¶å‘Šè¯‰ä½ é¡µé¢æ˜¯å¦æˆåŠŸè¿›å…¥ BFCacheã€‚å¦‚æœå¤±è´¥ï¼Œå®ƒä¼šæ˜ç¡®åˆ—å‡ºåŸå› ï¼ˆ"),t("code",[s._v("Reasons")]),s._v('ï¼‰ï¼Œä¾‹å¦‚ "Unload handler"ã€‚')])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"ç»“åˆå®é™…å¼€å‘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»“åˆå®é™…å¼€å‘"}},[s._v("ğŸŒ™")]),s._v(" ç»“åˆå®é™…å¼€å‘")]),s._v(" "),t("h4",{attrs:{id:"åœºæ™¯ä¸€-h5-å¼€å‘-å¦‚ç”µå•†ã€æ–°é—»åº”ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åœºæ™¯ä¸€-h5-å¼€å‘-å¦‚ç”µå•†ã€æ–°é—»åº”ç”¨"}},[s._v("ğŸŒ™")]),s._v(" åœºæ™¯ä¸€ï¼šH5 å¼€å‘ï¼ˆå¦‚ç”µå•†ã€æ–°é—»åº”ç”¨ï¼‰")]),s._v(" "),t("p",[t("strong",[s._v("é—®é¢˜ï¼š")]),s._v(" åœ¨ä¸€ä¸ªå•†å“åˆ—è¡¨é¡µï¼Œç”¨æˆ·å‘ä¸‹æ»šåŠ¨äº†å¾ˆå¤šï¼Œç„¶åè¿›å…¥è¯¦æƒ…é¡µï¼Œå†è¿”å›ã€‚æˆ‘ä»¬å¸Œæœ›ç”¨æˆ·èƒ½å›åˆ°åŸæ¥çš„ä½ç½®ï¼Œä½†åŒæ—¶ï¼Œåˆ—è¡¨é¡µçš„æŸäº›ä¿¡æ¯ï¼ˆå¦‚åº“å­˜ã€æœ€æ–°ä»·æ ¼ï¼‰å¯èƒ½å·²ç»è¿‡æ—¶äº†ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("è§£å†³æ–¹æ¡ˆï¼š")])]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("ç¡®ä¿ BFCache ç”Ÿæ•ˆ")]),s._v("ï¼šæ£€æŸ¥ä»£ç ï¼Œç¡®ä¿æ²¡æœ‰ä½¿ç”¨ "),t("code",[s._v("unload")]),s._v(" äº‹ä»¶ï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–é˜»æ­¢ BFCache çš„å› ç´ ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("åœ¨ "),t("code",[s._v("pageshow")]),s._v(" äº‹ä»¶ä¸­æ›´æ–°æ•°æ®")]),s._v("ï¼šåˆ©ç”¨ "),t("code",[s._v("event.persisted")]),s._v(" æ¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä»ç¼“å­˜ä¸­æ¢å¤ã€‚å¦‚æœæ˜¯ï¼Œå°±å‘èµ·ä¸€ä¸ªè½»é‡çº§çš„æ•°æ®è¯·æ±‚æ¥æ›´æ–°å…³é”®ä¿¡æ¯ï¼ŒåŒæ—¶ä¿ç•™ç”¨æˆ·çš„æ»šåŠ¨ä½ç½®ã€‚")])]),s._v(" "),t("p",[t("strong",[s._v("ç¤ºä¾‹ä»£ç  (TypeScript):")])]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨å•†å“åˆ—è¡¨é¡µçš„ JS ä¸­")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProductListPage")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("constructor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("loadInitialData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pageshow'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("handlePageShow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("handlePageShow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" PageTransitionEvent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åªæœ‰å½“é¡µé¢ä» BFCache æ¢å¤æ—¶ï¼Œæ‰æ‰§è¡Œæ­¤é€»è¾‘")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("persisted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Page restored from BFCache. Refreshing stock levels.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("refreshStockLevels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("loadInitialData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é¦–æ¬¡åŠ è½½æ—¶è·å–å®Œæ•´æ•°æ®")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Loading initial product list...'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("refreshStockLevels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘èµ·ä¸€ä¸ªAPIè¯·æ±‚ï¼Œåªè·å–æœ€æ–°çš„åº“å­˜å’Œä»·æ ¼ä¿¡æ¯")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// fetch('/api/products/stock-updates').then(...)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æˆåŠŸåï¼Œåªæ›´æ–°DOMä¸­å¯¹åº”çš„åº“å­˜å’Œä»·æ ¼éƒ¨åˆ†ï¼Œä¸é‡æ–°æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¿™æ ·ç”¨æˆ·çš„æ»šåŠ¨ä½ç½®å’Œå…¶ä»–çŠ¶æ€éƒ½å¾—ä»¥ä¿ç•™")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProductListPage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("h4",{attrs:{id:"åœºæ™¯äºŒ-webview-æ··åˆå¼€å‘-hybrid-app"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åœºæ™¯äºŒ-webview-æ··åˆå¼€å‘-hybrid-app"}},[s._v("ğŸŒ™")]),s._v(" åœºæ™¯äºŒï¼šWebView æ··åˆå¼€å‘ (Hybrid App)")]),s._v(" "),t("p",[s._v("åœ¨æ··åˆåº”ç”¨ä¸­ï¼Œå‰ç«¯é¡µé¢è¿è¡Œåœ¨ Native App æä¾›çš„ WebViewï¼ˆå¦‚ iOS çš„ WKWebViewï¼ŒAndroid çš„ Chrome WebViewï¼‰ä¸­ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("BFCache åœ¨ WebView ä¸­çš„è¡¨ç°ï¼š")])]),s._v(" "),t("ul",[t("li",[s._v("ç°ä»£çš„ WebView å·²ç»å¾ˆå¥½åœ°æ”¯æŒ BFCacheã€‚å…¶è¡Œä¸ºå’Œæ ‡å‡†æµè§ˆå™¨åŸºæœ¬ä¸€è‡´ã€‚")]),s._v(" "),t("li",[s._v("å½“ç”¨æˆ·åœ¨ WebView å†…çš„é¡µé¢ä¹‹é—´è¿›è¡Œå‰è¿›/åé€€æ—¶ï¼ŒBFCache ä¼šèµ·ä½œç”¨ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æ³¨æ„")]),s._v("ï¼šå½“ç”¨æˆ·ä» WebView "),t("strong",[s._v("è¿”å›åˆ° Native ç•Œé¢")]),s._v("æ—¶ï¼ŒWebView å®ä¾‹æœ¬èº«å¯èƒ½ä¼šè¢«é”€æ¯æˆ–è¿›å…¥åå°ï¼Œè¿™ä¸å±äº BFCache çš„èŒƒç•´ã€‚BFCache åªç®¡ç† WebView å†…éƒ¨çš„æµè§ˆå†å²ã€‚")])]),s._v(" "),t("p",[t("strong",[s._v("é—®é¢˜ï¼š")]),s._v(" ä¸€ä¸ª WebView é¡µé¢ä¾èµ– Native æä¾›çš„æ•°æ®ã€‚å½“é¡µé¢ä» BFCache æ¢å¤æ—¶ï¼Œè¿™äº›æ•°æ®å¯èƒ½å·²ç»å› ä¸ºæŸäº› Native æ“ä½œè€Œå˜å¾—é™ˆæ—§ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("è§£å†³æ–¹æ¡ˆï¼š")]),s._v("\nå»ºç«‹ä¸€ä¸ªé€šä¿¡æœºåˆ¶ï¼Œåœ¨ WebView é‡æ–°å˜ä¸ºå¯è§æ—¶ï¼Œç”± Native ä¸»åŠ¨é€šçŸ¥ H5 é¡µé¢è¿›è¡Œæ•°æ®åˆ·æ–°ã€‚")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("Native ç«¯")]),s._v("ï¼šç›‘å¬ WebView çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ "),t("code",[s._v("viewWillAppear")]),s._v(" on iOSï¼‰ã€‚å½“ WebView å³å°†å†æ¬¡æ˜¾ç¤ºæ—¶ï¼Œæ‰§è¡Œä¸€æ®µ JS ä»£ç æ¥é€šçŸ¥ H5 é¡µé¢ã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Android ç¤ºä¾‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// webView.evaluateJavascript(\"window.dispatchEvent(new CustomEvent('native-wakeup'))\", null);")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("H5 ç«¯")]),s._v("ï¼šé™¤äº†ç›‘å¬ "),t("code",[s._v("pageshow")]),s._v(" äº‹ä»¶ï¼Œä¹Ÿç›‘å¬æ¥è‡ª Native çš„è‡ªå®šä¹‰äº‹ä»¶ã€‚")])])]),s._v(" "),t("p",[t("strong",[s._v("ç¤ºä¾‹ä»£ç  (TypeScript):")])]),s._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HybridPage")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("constructor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("initListeners")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("initListeners")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç›‘å¬ BFCache æ¢å¤")]),s._v("\n    window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pageshow'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" PageTransitionEvent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("persisted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Restored from BFCache, checking for native updates.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("requestDataFromNative")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç›‘å¬æ¥è‡ª Native çš„å”¤é†’é€šçŸ¥")]),s._v("\n    window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'native-wakeup'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Woken up by native, refreshing data.'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("requestDataFromNative")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("requestDataFromNative")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é€šè¿‡ JSBridge è°ƒç”¨ Native æ–¹æ³•è·å–æœ€æ–°æ•°æ®")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// bridge.call('getUserInfo', (userInfo) => { this.updateUI(userInfo); });")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Requesting fresh data from Native host...'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateUI")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("any")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°é¡µé¢å†…å®¹")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HybridPage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("h3",{attrs:{id:"æ€»ç»“ä¸æœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“ä¸æœ€ä½³å®è·µ"}},[s._v("ğŸŒ™")]),s._v(" æ€»ç»“ä¸æœ€ä½³å®è·µ")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("æ‹¥æŠ± "),t("code",[s._v("pageshow")]),s._v(" å’Œ "),t("code",[s._v("pagehide")])]),s._v("ï¼šè¿™æ˜¯åˆ©ç”¨ BFCache çš„åŸºçŸ³ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å‘Šåˆ« "),t("code",[s._v("unload")])]),s._v("ï¼šå½»åº•ä»ä½ çš„ä»£ç å’Œä¾èµ–ä¸­ç§»é™¤å®ƒã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å–„ç”¨ DevTools")]),s._v("ï¼šå®šæœŸæ£€æŸ¥å…³é”®é¡µé¢çš„ BFCache å…¼å®¹æ€§ï¼Œå¹¶æ ¹æ®æç¤ºè¿›è¡Œä¿®å¤ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å¤„ç†é™ˆæ—§æ•°æ®")]),s._v("ï¼šåœ¨ "),t("code",[s._v("pageshow")]),s._v(" äº‹ä»¶ï¼ˆå½“ "),t("code",[s._v("event.persisted")]),s._v(" ä¸º "),t("code",[s._v("true")]),s._v(" æ—¶ï¼‰ä¸­ï¼Œæ™ºèƒ½åœ°æ›´æ–°é¡µé¢æ‰€éœ€çš„æ ¸å¿ƒæ•°æ®ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("ç®¡ç†å¥½è¿æ¥")]),s._v("ï¼šåœ¨ "),t("code",[s._v("pagehide")]),s._v(" ä¸­æ¸…ç† WebSocketã€XHR ç­‰èµ„æºï¼Œä¸ºé¡µé¢è¿›å…¥ BFCache åšå¥½å‡†å¤‡ã€‚")])]),s._v(" "),t("p",[s._v("æŒæ¡ BFCache æ˜¯ç°ä»£å‰ç«¯å·¥ç¨‹å¸ˆæå‡ç”¨æˆ·ä½“éªŒçš„å¿…å¤‡æŠ€èƒ½ã€‚å®ƒèƒ½ä»¥æä½çš„æˆæœ¬å¸¦æ¥å·¨å¤§çš„æ€§èƒ½æå‡ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œç¯å¢ƒä¸ä½³çš„ç§»åŠ¨ç«¯ã€‚")])])}),[],!1,null,null,null);t.default=e.exports}}]);