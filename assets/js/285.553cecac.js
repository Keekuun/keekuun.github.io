(window.webpackJsonp=window.webpackJsonp||[]).push([[285],{1001:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("ä» React 18 å¼€å§‹ï¼Œè®¸å¤šæ–°å¼•å…¥çš„ Hooks å…¶ä¸»è¦è®¾è®¡ç›®æ ‡å°±æ˜¯ä¸ºäº†"),s("strong",[t._v("æ·±åŒ–å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„é›†æˆ")]),t._v("ï¼Œå°¤å…¶æ˜¯åœ¨ "),s("strong",[t._v("React Server Components (RSC)")]),t._v(" è¿™ä¸ªæ–°èŒƒå¼ä¸‹ã€‚")]),t._v(" "),s("p",[t._v("ç†è§£è¿™äº› Hooks æ˜¯æŒæ¡æœªæ¥ React å¼€å‘æ¨¡å¼çš„å…³é”®ã€‚å®ƒä»¬ä¸å†ä»…ä»…æ˜¯ä¸ºâ€œåœ¨æœåŠ¡å™¨ä¸Šæ¸²æŸ“ HTMLâ€æœåŠ¡ï¼Œè€Œæ˜¯ä¸ºäº†æ„å»ºä¸€ç§å…¨æ–°çš„ã€æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯æ— ç¼åä½œçš„åº”ç”¨æ¨¡å‹ã€‚")]),t._v(" "),s("p",[t._v("æˆ‘å°†è¿™äº› Hooks åˆ†ä¸ºä¸‰ç±»ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å®ƒä»¬çš„èŒè´£ï¼š")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("ç›´æ¥ä¸º React Server Components & Server Actions è®¾è®¡çš„ Hooks")])]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºè§£å†³ä¼ ç»Ÿ SSR æ°´åˆï¼ˆHydrationï¼‰é—®é¢˜çš„ Hooks")])]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºæ”¯æŒå¹¶å‘æ¸²æŸ“ï¼ˆç°ä»£ SSR çš„åŸºç¡€ï¼‰çš„ Hooks")])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_1-ç›´æ¥ä¸º-react-server-components-server-actions-è®¾è®¡çš„-hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-ç›´æ¥ä¸º-react-server-components-server-actions-è®¾è®¡çš„-hooks"}},[t._v("ğŸŒ™")]),t._v(" 1. ç›´æ¥ä¸º React Server Components & Server Actions è®¾è®¡çš„ Hooks")]),t._v(" "),s("p",[t._v("è¿™äº›æ˜¯æœ€æ–°ã€ä¸æœåŠ¡ç«¯è€¦åˆæœ€ç´§å¯†çš„ Hooksã€‚å®ƒä»¬åªèƒ½åœ¨å®¢æˆ·ç«¯ç»„ä»¶ï¼ˆ"),s("code",[t._v("'use client'")]),t._v("ï¼‰ä¸­ä½¿ç”¨ï¼Œä½†å…¶ç›®çš„æ˜¯ä¸åœ¨æœåŠ¡ç«¯è¿è¡Œçš„é€»è¾‘è¿›è¡Œäº¤äº’ã€‚")]),t._v(" "),s("h4",{attrs:{id:"use"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use"}},[t._v("ğŸŒ™")]),t._v(" "),s("code",[t._v("use()")])]),t._v(" "),s("p",[t._v("è¿™æ˜¯ React 18.3 å¼•å…¥çš„é©å‘½æ€§ Hookã€‚å®ƒæå¤§ç®€åŒ–äº†åœ¨ç»„ä»¶ä¸­å¤„ç† Promise å’Œ Context çš„æ–¹å¼ã€‚")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("æ ¸å¿ƒç›®çš„")]),t._v(": åœ¨ç»„ä»¶æ¸²æŸ“æœŸé—´ï¼ŒåŒæ­¥åœ°â€œè§£åŒ…â€ä¸€ä¸ª Promise æˆ– Context çš„å€¼ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä½•ä¸ºæœåŠ¡ç«¯æœåŠ¡")]),t._v(": åœ¨ "),s("strong",[t._v("Server Components")]),t._v(" ä¸­ï¼Œ"),s("code",[t._v("use(promise)")]),t._v(" æ˜¯è¿›è¡Œæ•°æ®è·å–çš„"),s("strong",[t._v("æ¨èæ–¹å¼")]),t._v("ã€‚å®ƒå…è®¸ä½ åœ¨æœåŠ¡ç«¯ç»„ä»¶ä¸­åƒå†™åŒæ­¥ä»£ç ä¸€æ ·å»è·å–æ•°æ®ï¼ŒReact ä¼šåœ¨åº•å±‚å¤„ç†æ•°æ®åŠ è½½çš„æš‚åœä¸æ¢å¤ã€‚åœ¨å®¢æˆ·ç«¯ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨æ¥è¯»å–ä¼ é€’è¿‡æ¥çš„ Promiseã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("ç¤ºä¾‹ (åœ¨ Server Component ä¸­)")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// app/page.tsx (Server Component)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" fetchPost "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/lib/api'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™æ˜¯ä¸€ä¸ªè¿”å› Promise<Post> çš„å‡½æ•°")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" use "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨æ„ï¼šServer Component æœ¬èº«å¯ä»¥æ˜¯ async å‡½æ•°")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PostDetails")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// `use` åƒ await ä¸€æ ·â€œæš‚åœâ€ç»„ä»¶çš„æ¸²æŸ“ï¼Œç›´åˆ° Promise resolve")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" post "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetchPost")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("article"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("article"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" PostDetails"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("h4",{attrs:{id:"useoptimistic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#useoptimistic"}},[t._v("ğŸŒ™")]),t._v(" "),s("code",[t._v("useOptimistic()")])]),t._v(" "),s("p",[t._v("å®ƒå°±æ˜¯ä¸ºäº†ç»™å¼‚æ­¥æ“ä½œï¼ˆå°¤å…¶æ˜¯ Server Actionsï¼‰æä¾›å³æ—¶ UI åé¦ˆè€Œç”Ÿçš„ã€‚")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("æ ¸å¿ƒç›®çš„")]),t._v(": åœ¨ç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼ˆå°¤å…¶æ˜¯ Server Actionï¼‰å®Œæˆæ—¶ï¼Œç«‹å³åœ¨ UI ä¸Šå±•ç¤ºä¸€ä¸ªâ€œä¹è§‚â€çš„ã€é¢„æœŸçš„æˆåŠŸçŠ¶æ€ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä½•ä¸ºæœåŠ¡ç«¯æœåŠ¡")]),t._v(": å½“ä½ è°ƒç”¨ä¸€ä¸ª Server Action (ä¸€ä¸ªåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„å‡½æ•°) æ—¶ï¼Œç½‘ç»œå»¶è¿Ÿæ˜¯ä¸å¯é¿å…çš„ã€‚"),s("code",[t._v("useOptimistic")]),t._v(" å¯ä»¥åœ¨å®¢æˆ·ç«¯ç«‹å³æ¨¡æ‹Ÿå‡ºæˆåŠŸåçš„ UIï¼Œæå¤§åœ°æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚")])]),t._v(" "),s("p",[t._v("æœ€ä½³å®è·µï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ€»æ˜¯ä¸ Server Action é…åˆä½¿ç”¨ï¼Œç”¨äºæå‡è¡¨å•æäº¤ã€ç‚¹èµã€è¯„è®ºç­‰äº¤äº’çš„å³æ—¶æ€§ã€‚")]),t._v(" "),s("li",[t._v("ç¡®ä¿ä¼ é€’ç»™å®ƒçš„ updateFn æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå®ƒåªè´Ÿè´£è®¡ç®—ä¸‹ä¸€ä¸ªä¹è§‚çŠ¶æ€ï¼Œä¸åº”æœ‰å‰¯ä½œç”¨ã€‚")]),t._v(" "),s("li",[t._v("å½“å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨å›æ»šåˆ°åŸå§‹çŠ¶æ€ï¼Œä½ æ— éœ€ç¼–å†™æ‰‹åŠ¨å›æ»šé€»è¾‘ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"useformstatus"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#useformstatus"}},[t._v("ğŸŒ™")]),t._v(" "),s("code",[t._v("useFormStatus()")])]),t._v(" "),s("p",[t._v("è¿™æ˜¯ä¸€ä¸ªè¾…åŠ© Hookï¼Œå¿…é¡»åœ¨ä½¿ç”¨äº† Server Action çš„ "),s("code",[t._v("<form>")]),t._v(" ç»„ä»¶å†…éƒ¨ä½¿ç”¨ã€‚")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("æ ¸å¿ƒç›®çš„")]),t._v(": è·å–çˆ¶çº§ "),s("code",[t._v("<form>")]),t._v(" çš„æäº¤çŠ¶æ€ï¼Œä¾‹å¦‚ "),s("code",[t._v("pending")]),t._v("ï¼ˆæ˜¯å¦æ­£åœ¨æäº¤ï¼‰ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä½•ä¸ºæœåŠ¡ç«¯æœåŠ¡")]),t._v(": å®ƒè®©ä½ èƒ½å¤Ÿæ ¹æ® Server Action çš„æ‰§è¡ŒçŠ¶æ€è½»æ¾åœ°æ›´æ–° UIï¼Œæ¯”å¦‚åœ¨æäº¤æœŸé—´ç¦ç”¨æŒ‰é’®æˆ–æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç®¡ç†åŠ è½½çŠ¶æ€ã€‚")])]),t._v(" "),s("p",[t._v("æœ€ä½³å®è·µï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¿…é¡»åœ¨ä½œä¸º "),s("code",[t._v("<form>")]),t._v(" åä»£çš„ç»„ä»¶ä¸­ä½¿ç”¨ã€‚")]),t._v(" "),s("li",[t._v("æé€‚åˆç”¨æ¥åˆ›å»ºå¯å¤ç”¨çš„ SubmitButton ç»„ä»¶ï¼Œè¯¥ç»„ä»¶èƒ½è‡ªåŠ¨æ„ŸçŸ¥å…¶æ‰€åœ¨è¡¨å•çš„æäº¤çŠ¶æ€ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("ç¤ºä¾‹ ("),s("code",[t._v("useOptimistic")]),t._v(" å’Œ "),s("code",[t._v("useFormStatus")]),t._v(" ç»„åˆ)")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// components/OptimisticForm.tsx ('use client')")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use client'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useOptimistic "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useFormStatus "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-dom'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨æ„ï¼Œæ¥è‡ª react-dom")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" submitMessageAction "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/app/actions'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™æ˜¯ä¸€ä¸ª Server Action")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SubmitButton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" pending "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useFormStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–è¡¨å•æäº¤çŠ¶æ€")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"submit"')]),t._v(" disabled"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("pending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("pending "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Submitting...'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Submit'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("OptimisticForm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" messages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" messages"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("optimisticMessages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addOptimisticMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useOptimistic")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    messages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentMessages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newMessage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("currentMessages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("formAction")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("formData"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" FormData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" formData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addOptimisticMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç«‹å³åº”ç”¨ä¹è§‚æ›´æ–°")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submitMessageAction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è°ƒç”¨ Server Action")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("form action"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("formAction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ul"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("optimisticMessages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("li key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("li"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ul"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("input type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SubmitButton "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("form"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br")])]),s("h4",{attrs:{id:"useactionstate-å‰èº«ä¸º-useformstate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#useactionstate-å‰èº«ä¸º-useformstate"}},[t._v("ğŸŒ™")]),t._v(" "),s("code",[t._v("useActionState()")]),t._v(" (å‰èº«ä¸º "),s("code",[t._v("useFormState")]),t._v(")")]),t._v(" "),s("p",[t._v("ç”¨äºå¤„ç† Server Action è¿”å›çš„ç»“æœå’ŒçŠ¶æ€ã€‚")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("æ ¸å¿ƒç›®çš„")]),t._v(": è¿è¡Œä¸€ä¸ª Actionï¼Œå¹¶æ ¹æ®å…¶è¿”å›å€¼æ›´æ–°çŠ¶æ€ï¼ŒåŒæ—¶å¤„ç† pending/error ç­‰çŠ¶æ€ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä½•ä¸ºæœåŠ¡ç«¯æœåŠ¡")]),t._v(": å®ƒæ˜¯ä¸“é—¨ä¸ºç®¡ç† Server Action çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸè€Œè®¾è®¡çš„ï¼Œéå¸¸é€‚åˆå¤„ç†è¡¨å•éªŒè¯åçš„é”™è¯¯ä¿¡æ¯æˆ–æˆåŠŸæ¶ˆæ¯ã€‚")])]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useActionState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useState "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"react"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" addToCart "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./actions.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddToCartForm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("itemID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" itemTitle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" formAction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" isPending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useActionState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("addToCart"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("form action"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("formAction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("itemTitle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("input type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hidden"')]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"itemID"')]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("itemID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"submit"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Add to Cart"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("isPending "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Loading..."')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("form"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// actions.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"use server"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addToCart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prevState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" queryData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" itemID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" queryData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'itemID'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("itemID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Added to cart"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add a fake delay to make waiting noticeable.")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Promise")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Couldn\'t add to cart: the item is sold out."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"_2-ä¸ºè§£å†³ä¼ ç»Ÿ-ssr-æ°´åˆ-hydration-é—®é¢˜çš„-hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä¸ºè§£å†³ä¼ ç»Ÿ-ssr-æ°´åˆ-hydration-é—®é¢˜çš„-hooks"}},[t._v("ğŸŒ™")]),t._v(" 2. ä¸ºè§£å†³ä¼ ç»Ÿ SSR æ°´åˆï¼ˆHydrationï¼‰é—®é¢˜çš„ Hooks")]),t._v(" "),s("p",[t._v("è¿™äº› Hooks è§£å†³äº†é•¿æœŸä»¥æ¥åœ¨ SSR ä¸­å­˜åœ¨çš„ç—›ç‚¹ã€‚")]),t._v(" "),s("h4",{attrs:{id:"useid"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#useid"}},[t._v("ğŸŒ™")]),t._v(" "),s("code",[t._v("useId()")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("æ ¸å¿ƒç›®çš„")]),t._v(": ç”Ÿæˆåœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´éƒ½ä¿æŒç¨³å®šçš„å”¯ä¸€ IDã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä½•ä¸ºæœåŠ¡ç«¯æœåŠ¡")]),t._v(": åœ¨ä¼ ç»Ÿçš„ SSR ä¸­ï¼Œå¦‚æœä½ ä½¿ç”¨ "),s("code",[t._v("Math.random()")]),t._v(" æˆ–è®¡æ•°å™¨ç”Ÿæˆ IDï¼ŒæœåŠ¡å™¨ç”Ÿæˆçš„ ID å’Œå®¢æˆ·ç«¯ç”Ÿæˆçš„ ID ä¼šä¸åŒ¹é…ï¼Œå¯¼è‡´"),s("strong",[t._v("æ°´åˆé”™è¯¯ (hydration mismatch)")]),t._v("ã€‚"),s("code",[t._v("useId")]),t._v(" é€šè¿‡ä¸€ä¸ªç¡®å®šçš„ç®—æ³•è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œç¡®ä¿ç»„ä»¶æ— è®ºåœ¨ä½•å¤„æ¸²æŸ“ï¼Œå…¶ ID éƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™å¯¹äº "),s("code",[t._v("aria-")]),t._v(" å±æ€§å’Œ "),s("code",[t._v('<label htmlFor="...">')]),t._v(" è‡³å…³é‡è¦ã€‚")])]),t._v(" "),s("p",[t._v("æœ€ä½³å®è·µï¼š")]),t._v(" "),s("ul",[s("li",[t._v("åœ¨ä»»ä½•éœ€è¦å°†ä¸¤ä¸ªå…ƒç´ é€šè¿‡ ID å…³è”çš„åœ°æ–¹ä½¿ç”¨å®ƒï¼Œä¾‹å¦‚ "),s("code",[t._v("<label>")]),t._v(" å’Œ "),s("code",[t._v("<input>")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("ä¸è¦ç”¨å®ƒæ¥ç”Ÿæˆåˆ—è¡¨ä¸­çš„ keyã€‚åˆ—è¡¨çš„ key åº”è¯¥æºè‡ªä½ çš„æ•°æ®ï¼ˆä¾‹å¦‚ item.idï¼‰ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("ç¤ºä¾‹")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// components/FormField.tsx ('use client' or can be used in server component)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useId "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("FormField")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// âœ… åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç”Ÿæˆç›¸åŒçš„ ID: ":r0:", ":r1:" ç­‰')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("label htmlFor"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Your Name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("label"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("input id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"_3-ä¸ºæ”¯æŒå¹¶å‘æ¸²æŸ“-ç°ä»£-ssr-çš„åŸºç¡€-çš„-hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ä¸ºæ”¯æŒå¹¶å‘æ¸²æŸ“-ç°ä»£-ssr-çš„åŸºç¡€-çš„-hooks"}},[t._v("ğŸŒ™")]),t._v(" 3. ä¸ºæ”¯æŒå¹¶å‘æ¸²æŸ“ï¼ˆç°ä»£ SSR çš„åŸºç¡€ï¼‰çš„ Hooks")]),t._v(" "),s("p",[t._v("React 18 çš„æµå¼ SSR (Streaming SSR) å’Œé€‰æ‹©æ€§æ°´åˆ (Selective Hydration) éƒ½å»ºç«‹åœ¨å¹¶å‘æ¸²æŸ“ä¹‹ä¸Šã€‚è¿™äº› Hooks æ˜¯å¯ç”¨å¹¶å‘ç‰¹æ€§çš„å…³é”®ã€‚")]),t._v(" "),s("h4",{attrs:{id:"usetransition"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usetransition"}},[t._v("ğŸŒ™")]),t._v(" "),s("code",[t._v("useTransition()")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("æ ¸å¿ƒç›®çš„")]),t._v(": å°†æŸä¸ªçŠ¶æ€æ›´æ–°æ ‡è®°ä¸ºâ€œéç´§æ€¥â€ï¼Œå…è®¸å…¶ä»–æ›´ç´§æ€¥çš„æ¸²æŸ“ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ï¼‰ä¼˜å…ˆè¿›è¡Œï¼Œè€Œä¸ä¼šè¢«é˜»å¡ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä½•ä¸ºæœåŠ¡ç«¯æœåŠ¡")]),t._v(": åœ¨ä¸æœåŠ¡ç«¯äº¤äº’æ—¶ï¼Œæ¯”å¦‚è§¦å‘ä¸€ä¸ª Server Action æˆ–ä¸€ä¸ªéœ€è¦é‡æ–°è·å–æ•°æ®çš„æ“ä½œï¼Œä½ å¯ä»¥ç”¨ "),s("code",[t._v("startTransition")]),t._v(" åŒ…è£¹å®ƒã€‚è¿™æ ·ï¼Œå³ä½¿åœ¨ç­‰å¾…æœåŠ¡ç«¯å“åº”æ—¶ï¼Œä½ çš„ UI ä¹Ÿèƒ½ä¿æŒå“åº”ï¼Œä¸ä¼šå› ä¸ºæ•°æ®åŠ è½½è€Œå¡ä½ã€‚è¿™æ˜¯å®ç°æµç•…ä½“éªŒçš„å…³é”®ã€‚")])]),t._v(" "),s("p",[t._v("æœ€ä½³å®è·µï¼š")]),t._v(" "),s("ul",[s("li",[t._v("ç”¨äºåŒ…è£¹ä¼šè§¦å‘æ˜‚è´µæ¸²æŸ“æˆ–æ•°æ®è¯·æ±‚çš„çŠ¶æ€æ›´æ–°ï¼Œä¾‹å¦‚æœç´¢æ¡†è¾“å…¥ã€ç­›é€‰å™¨å˜æ›´ç­‰ã€‚")]),t._v(" "),s("li",[t._v("ä½¿ç”¨è¿”å›çš„ isPending çŠ¶æ€ï¼Œå‘ç”¨æˆ·å±•ç¤ºä¸€ä¸ªåŠ è½½æŒ‡ç¤ºå™¨ï¼Œå‘ŠçŸ¥ä»–ä»¬åå°æ­£åœ¨å‘ç”Ÿå˜åŒ–ã€‚")])]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SubmitButton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" submitAction "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("isPending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" startTransition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useTransition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button\n      disabled"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("isPending"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      onClick"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("startTransition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submitAction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      Submit\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("h4",{attrs:{id:"usesyncexternalstore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usesyncexternalstore"}},[t._v("ğŸŒ™")]),t._v(" "),s("code",[t._v("useSyncExternalStore()")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("æ ¸å¿ƒç›®çš„")]),t._v(": å…è®¸ React å®‰å…¨åœ°ä»å¤–éƒ¨æ•°æ®æºï¼ˆå¦‚ Redux, Zustand, ç”šè‡³ "),s("code",[t._v("window.matchMedia")]),t._v("ï¼‰è¯»å–æ•°æ®ï¼Œå¹¶æ”¯æŒå¹¶å‘æ¸²æŸ“ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä½•ä¸ºæœåŠ¡ç«¯æœåŠ¡")]),t._v(": åœ¨å¹¶å‘æ¸²æŸ“ï¼ˆå¦‚æµå¼ SSRï¼‰ä¸­ï¼ŒReact å¯èƒ½ä¼šåœ¨åå°â€œæš‚åœâ€å’Œâ€œæ¢å¤â€æ¸²æŸ“ã€‚å¦‚æœå¤–éƒ¨ store åœ¨æ­¤æœŸé—´å‘ç”Ÿå˜åŒ–ï¼Œå¯èƒ½ä¼šå¯¼è‡´ UI â€œæ’•è£‚â€ (tearing)â€”â€”å³ UI çš„ä¸€éƒ¨åˆ†æ˜¾ç¤ºæ—§æ•°æ®ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¾ç¤ºæ–°æ•°æ®ã€‚"),s("code",[t._v("useSyncExternalStore")]),t._v(" é€šè¿‡è®¢é˜…å’Œå¼ºåˆ¶åŒæ­¥è¯»å–æ¥é˜²æ­¢è¿™ç§æƒ…å†µï¼Œç¡®ä¿äº†åœ¨ SSR å’Œå¹¶å‘æ¨¡å¼ä¸‹çš„æ•°æ®ä¸€è‡´æ€§ã€‚")])]),t._v(" "),s("p",[t._v("æœ€ä½³å®è·µï¼š")]),t._v(" "),s("ul",[s("li",[t._v("ç”¨äºä»ä»»ä½•å¤–éƒ¨æ•°æ®æºè¯»å–æ•°æ®ï¼Œå°¤å…¶æ˜¯é‚£äº›å¯èƒ½åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿå˜åŒ–çš„ã€‚")]),t._v(" "),s("li",[t._v("ç¡®ä¿åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½èƒ½æ­£ç¡®è¯»å–æ•°æ®ï¼Œé¿å… UI æ’•è£‚ã€‚")])]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useSyncExternalStore "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useOnlineStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isOnline "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useSyncExternalStore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("subscribe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" getSnapshot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" getServerSnapshot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" isOnline"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSnapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" navigator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onLine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServerSnapshot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Always show "Online" for server-generated HTML')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'online'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'online'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'offline'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br")])]),s("h3",{attrs:{id:"æ€»ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[t._v("ğŸŒ™")]),t._v(" æ€»ç»“")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("Hook")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("ä¸»è¦èŒè´£")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸­çš„æ ¸å¿ƒä½œç”¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[s("code",[t._v("use()")])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("åŒæ­¥åœ°è¯»å– Promise / Context")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("åœ¨ Server Component ä¸­è¿›è¡Œæ•°æ®è·å–")]),t._v("ã€‚")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[s("code",[t._v("useOptimistic()")])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("æä¾›ä¹è§‚ UI çŠ¶æ€")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ä¸º Server Action æä¾›å³æ—¶ UI åé¦ˆï¼Œéšè—ç½‘ç»œå»¶è¿Ÿã€‚")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[s("code",[t._v("useFormStatus()")])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("è·å–è¡¨å•æäº¤çŠ¶æ€")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("åœ¨ Server Action æ‰§è¡ŒæœŸé—´ï¼Œè½»æ¾ç®¡ç† UIï¼ˆå¦‚ç¦ç”¨æŒ‰é’®ï¼‰ã€‚")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[s("code",[t._v("useActionState()")])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ç®¡ç† Action çš„çŠ¶æ€å’Œç»“æœ")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("å¤„ç† Server Action çš„è¿”å›å€¼ï¼Œå¦‚é”™è¯¯ä¿¡æ¯ã€‚")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[s("code",[t._v("useId()")])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ç”Ÿæˆç¨³å®šçš„å”¯ä¸€ ID")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("é˜²æ­¢æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ ID ä¸åŒ¹é…å¯¼è‡´çš„æ°´åˆé”™è¯¯")]),t._v("ã€‚")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[s("code",[t._v("useTransition()")])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("æ ‡è®°éç´§æ€¥æ›´æ–°")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ä¿æŒ UI åœ¨ç­‰å¾…æœåŠ¡ç«¯å“åº”ï¼ˆå¦‚ Server Actionï¼‰æ—¶ä¸è¢«å¡ä½ã€‚")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[s("code",[t._v("useSyncExternalStore()")])])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("å®‰å…¨åœ°ä»å¤–éƒ¨ store è¯»å–æ•°æ®")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("åœ¨å¹¶å‘å’Œæµå¼ SSR ä¸­ï¼Œ"),s("strong",[t._v("ä¿è¯å¤–éƒ¨æ•°æ®æºçš„ä¸€è‡´æ€§ï¼Œé˜²æ­¢ UI æ’•è£‚")]),t._v("ã€‚")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);