(window.webpackJsonp=window.webpackJsonp||[]).push([[272],{986:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("本文详细解读 Next.js 中这些至关重要的渲染策略：CSR、SSR、SSG 和 ISR。理解它们的区别和实现原理，是掌握 Next.js、优化应用性能和用户体验的关键。")]),t._v(" "),s("h3",{attrs:{id:"渲染策略概览"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#渲染策略概览"}},[t._v("🌙")]),t._v(" 渲染策略概览")]),t._v(" "),s("p",[t._v("在 Web 开发中，“渲染”指的是将代码（如 React 组件）转换为用户可以在浏览器中看到和交互的 HTML 和 CSS 的过程。这个过程可以在不同的时间和地点发生，从而衍生出不同的渲染策略。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("策略")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("全称")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("渲染发生地")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("渲染时机")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("CSR")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Client-Side Rendering")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("浏览器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("每次访问时")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("SSR")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Server-Side Rendering")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("服务器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("每次请求时")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("SSG")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Static Site Generation")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("服务器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("构建应用时")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("ISR")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Incremental Static Regeneration")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("服务器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("构建时 + 后台按需")])])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_1-csr-客户端渲染-client-side-rendering"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-csr-客户端渲染-client-side-rendering"}},[t._v("🌙")]),t._v(" 1. CSR (客户端渲染 - Client-Side Rendering)")]),t._v(" "),s("h4",{attrs:{id:"概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("🌙")]),t._v(" 概念")]),t._v(" "),s("p",[t._v("CSR 是传统 React 单页应用（SPA）的模式。服务器发送一个近乎空白的 HTML 文件和一个巨大的 JavaScript 包。浏览器下载并执行这个 JS 包，然后由 JS 代码获取数据、渲染组件，最终生成完整的页面。")]),t._v(" "),s("h4",{attrs:{id:"实现原理-工作流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现原理-工作流程"}},[t._v("🌙")]),t._v(" 实现原理 / 工作流程")]),t._v(" "),s("ol",[s("li",[t._v("用户请求页面。")]),t._v(" "),s("li",[t._v("服务器立即响应一个“空壳” HTML 文件和一个 "),s("code",[t._v("<script>")]),t._v(" 标签，指向 JavaScript 文件。"),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token doctype"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),s("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("..."),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("root"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 通常只有一个挂载点 --\x3e")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/_next/static/chunks/app.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 大量的 JS --\x3e")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])])]),t._v(" "),s("li",[t._v("浏览器下载并执行 "),s("code",[t._v("app.js")]),t._v("。")]),t._v(" "),s("li",[t._v("JavaScript 代码（例如在 "),s("code",[t._v("useEffect")]),t._v(" Hook 中）向 API 发起数据请求。")]),t._v(" "),s("li",[t._v("数据返回后，React 将数据和组件结合，在浏览器中生成 DOM，并挂载到 `"),s("div",{attrs:{id:"root"}},[t._v("moverride>。")])]),t._v(" "),s("li",[t._v("页面最终变得可见且可交互。")])]),t._v(" "),s("h4",{attrs:{id:"next-js-中的实现-app-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#next-js-中的实现-app-router"}},[t._v("🌙")]),t._v(" Next.js 中的实现 (App Router)")]),t._v(" "),s("p",[t._v("在 App Router 中，任何组件只要在文件顶部声明了 "),s("strong",[s("code",[t._v("'use client';")])]),t._v("，它及其所有子组件就会变成客户端组件，采用 CSR 模式（或 SSR 后的 Hydration 模式）。")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("app/dashboard/page.tsx")])])]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'use client'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关键指令：标记为客户端组件")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" useEffect "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserData")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("DashboardPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setUser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token generic-function"}},[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token generic class-name"}},[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("UserData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("isLoading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setIsLoading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这个 fetch 在浏览器中执行")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api/user/profile'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setUser")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setIsLoading")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 空依赖数组，仅在组件挂载时执行一次")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isLoading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Loading your dashboard"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Welcome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br")])]),s("h4",{attrs:{id:"优缺点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优缺点"}},[t._v("🌙")]),t._v(" 优缺点")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("优点:")]),t._v(" "),s("ul",[s("li",[t._v("页面切换快：后续导航无需刷新页面，只更新变化的部分，体验流畅。")]),t._v(" "),s("li",[t._v("服务端压力小：服务器只负责提供静态资源和 API。")])])]),t._v(" "),s("li",[s("strong",[t._v("缺点:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("首屏加载慢 (FCP/LCP 差):")]),t._v(" 需要下载、解析和执行大量 JS 后才能看到内容。")]),t._v(" "),s("li",[s("strong",[t._v("SEO 不友好:")]),t._v(" 搜索引擎爬虫可能无法正确执行 JS，导致抓取到的是空内容。")])])])]),t._v(" "),s("h4",{attrs:{id:"适用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用场景"}},[t._v("🌙")]),t._v(" 适用场景")]),t._v(" "),s("ul",[s("li",[t._v("需要高度交互的应用，如后台管理面板、复杂的表单应用、在线编辑器等。")]),t._v(" "),s("li",[t._v("内容在登录后才可见，对 SEO 没有要求的页面。")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_2-ssr-服务端渲染-server-side-rendering"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-ssr-服务端渲染-server-side-rendering"}},[t._v("🌙")]),t._v(" 2. SSR (服务端渲染 - Server-Side Rendering)")]),t._v(" "),s("h4",{attrs:{id:"概念-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念-2"}},[t._v("🌙")]),t._v(" 概念")]),t._v(" "),s("p",[t._v("对于每一个用户的请求，服务器都会获取最新数据，将 React 组件渲染成完整的 HTML 字符串，然后将这个 HTML 发送给浏览器。浏览器接收到后能立即显示页面内容。之后，JS 代码在后台“注水”（Hydration），让页面变得可交互。")]),t._v(" "),s("h4",{attrs:{id:"实现原理-工作流程-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现原理-工作流程-2"}},[t._v("🌙")]),t._v(" 实现原理 / 工作流程")]),t._v(" "),s("ol",[s("li",[t._v("用户请求页面。")]),t._v(" "),s("li",[t._v("Next.js 服务器接收到请求。")]),t._v(" "),s("li",[t._v("服务器执行页面组件的代码，包括其中的数据获取逻辑 ("),s("code",[t._v("fetch")]),t._v(")。")]),t._v(" "),s("li",[t._v("服务器等待数据返回，然后将数据和组件渲染成一个完整的 HTML 字符串。")]),t._v(" "),s("li",[t._v("服务器将这个完整的 HTML 响应给浏览器。")]),t._v(" "),s("li",[t._v("浏览器立即渲染 HTML，用户看到完整内容的页面（但还不可交互）。")]),t._v(" "),s("li",[t._v("浏览器下载页面所需的 JS。")]),t._v(" "),s("li",[t._v("JS 执行，将事件监听器等附加到已存在的 DOM 上（这个过程叫 Hydration），页面变得可交互。")])]),t._v(" "),s("h4",{attrs:{id:"next-js-中的实现-app-router-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#next-js-中的实现-app-router-2"}},[t._v("🌙")]),t._v(" Next.js 中的实现 (App Router)")]),t._v(" "),s("p",[t._v("在 App Router 中，"),s("strong",[t._v("服务端组件是默认的")]),t._v("。任何没有 "),s("code",[t._v("'use client';")]),t._v(" 指令的组件都是服务端组件。要实现动态的 SSR（即每次请求都重新渲染），你需要使用动态函数或设置 "),s("code",[t._v("fetch")]),t._v(" 的缓存策略。")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("app/profile/[id]/page.tsx")])])]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" cookies "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'next/headers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用动态函数会强制 SSR")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserProfileProps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  params"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这是一个服务端组件 (默认行为)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// async 关键字允许我们在组件内部直接 await 数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UserProfilePage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" UserProfileProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 cookies() 或 headers() 会使页面动态化，每次请求都重新渲染")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cookieStore "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cookies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" token "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cookieStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'token'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这个 fetch 在服务器上为每个请求执行")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'no-store' 确保数据总是最新的")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("https://api.example.com/users/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    cache"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'no-store'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关键：禁用缓存，强制 SSR")]),t._v("\n    headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Authorization"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Bearer ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" user "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("'s Profile"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br")])]),s("h4",{attrs:{id:"优缺点-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优缺点-2"}},[t._v("🌙")]),t._v(" 优缺点")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("优点:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("极佳的 SEO:")]),t._v(" 搜索引擎能直接抓取到完整的页面内容。")]),t._v(" "),s("li",[s("strong",[t._v("更快的可感知加载速度 (FCP):")]),t._v(" 用户能更快看到内容，无需等待 JS 加载。")])])]),t._v(" "),s("li",[s("strong",[t._v("缺点:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("服务器压力大:")]),t._v(" 每个请求都需要服务端计算，增加了服务器成本和负载。")]),t._v(" "),s("li",[s("strong",[t._v("TTFB (Time to First Byte) 可能较慢:")]),t._v(" 服务器需要完成数据获取和渲染后才能响应。")])])])]),t._v(" "),s("h4",{attrs:{id:"适用场景-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-2"}},[t._v("🌙")]),t._v(" 适用场景")]),t._v(" "),s("ul",[s("li",[t._v("内容高度动态、个性化且需要 SEO 的页面。例如：新闻源、社交媒体时间线、电商搜索结果页。")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_3-ssg-静态站点生成-static-site-generation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ssg-静态站点生成-static-site-generation"}},[t._v("🌙")]),t._v(" 3. SSG (静态站点生成 - Static Site Generation)")]),t._v(" "),s("h4",{attrs:{id:"概念-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念-3"}},[t._v("🌙")]),t._v(" 概念")]),t._v(" "),s("p",[t._v("在"),s("strong",[t._v("构建时 (build time)")]),t._v("，Next.js 就提前将所有页面渲染成静态的 HTML 文件。当用户请求页面时，服务器（通常是 CDN）直接返回这个已经生成好的 HTML 文件，无需任何实时计算。")]),t._v(" "),s("h4",{attrs:{id:"实现原理-工作流程-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现原理-工作流程-3"}},[t._v("🌙")]),t._v(" 实现原理 / 工作流程")]),t._v(" "),s("ol",[s("li",[t._v("开发者运行 "),s("code",[t._v("next build")]),t._v(" 命令。")]),t._v(" "),s("li",[t._v("Next.js 遍历所有可以静态生成的页面。")]),t._v(" "),s("li",[t._v("对于每个页面，它获取所需数据，并将其渲染成一个 "),s("code",[t._v("page.html")]),t._v(" 文件。")]),t._v(" "),s("li",[t._v("所有生成的 HTML、CSS、JS 文件被部署到静态托管服务（如 Vercel, Netlify, CDN）。")]),t._v(" "),s("li",[t._v("用户请求页面。")]),t._v(" "),s("li",[t._v("CDN 直接将对应的 "),s("code",[t._v("page.html")]),t._v(" 文件以最快的速度返回给用户。")])]),t._v(" "),s("h4",{attrs:{id:"next-js-中的实现-app-router-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#next-js-中的实现-app-router-3"}},[t._v("🌙")]),t._v(" Next.js 中的实现 (App Router)")]),t._v(" "),s("p",[t._v("在 App Router 中，如果一个页面"),s("strong",[t._v("不使用任何动态函数")]),t._v("（如 "),s("code",[t._v("cookies()")]),t._v(", "),s("code",[t._v("headers()")]),t._v("）并且其 "),s("code",[t._v("fetch")]),t._v(" 请求"),s("strong",[t._v("没有禁用缓存")]),t._v("，那么它"),s("strong",[t._v("默认就是 SSG")]),t._v("。")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("app/posts/[slug]/page.tsx")])])]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PostPageProps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  params"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" slug"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 告诉 Next.js 在构建时要生成哪些动态页面")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateStaticParams")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://.../posts'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" posts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回一个 params 数组，Next.js 会为每个对象生成一个静态页面")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" posts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("post"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" slug"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    slug"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 页面组件本身")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PostPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" PostPageProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这个 fetch 在构建时执行")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("https://.../posts/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slug"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 默认缓存")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" post "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("article"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div dangerouslySetInnerHTML"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" __html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("article"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br")])]),s("h4",{attrs:{id:"优缺点-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优缺点-3"}},[t._v("🌙")]),t._v(" 优缺点")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("优点:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("速度极快:")]),t._v(" 页面直接从 CDN 边缘节点提供，TTFB 几乎为零。")]),t._v(" "),s("li",[s("strong",[t._v("高可用、高安全性:")]),t._v(" 没有实时服务器计算，减少了攻击面和故障点。")]),t._v(" "),s("li",[s("strong",[t._v("服务器成本极低:")]),t._v(" 静态文件托管非常便宜。")])])]),t._v(" "),s("li",[s("strong",[t._v("缺点:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("数据可能过时:")]),t._v(" 内容只在构建时更新。任何数据变更都需要重新构建和部署整个站点。")]),t._v(" "),s("li",[s("strong",[t._v("构建时间长:")]),t._v(" 如果有成千上万个页面，构建过程会非常耗时。")])])])]),t._v(" "),s("h4",{attrs:{id:"适用场景-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-3"}},[t._v("🌙")]),t._v(" 适用场景")]),t._v(" "),s("ul",[s("li",[t._v("内容不经常变动的网站。例如：博客、文档站、营销页面、作品集。")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-isr-增量静态再生-incremental-static-regeneration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-isr-增量静态再生-incremental-static-regeneration"}},[t._v("🌙")]),t._v(" 4. ISR (增量静态再生 - Incremental Static Regeneration)")]),t._v(" "),s("h4",{attrs:{id:"概念-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念-4"}},[t._v("🌙")]),t._v(" 概念")]),t._v(" "),s("p",[t._v("ISR 是 SSG 和 SSR 的完美结合。它首先在构建时生成一个静态页面（像 SSG），但同时设定一个“保质期”。当用户在保质期过后访问页面时，他们会先看到旧的静态页面（速度快），同时 Next.js 会在后台触发一次页面重新生成。下次再有用户访问时，他们就会看到这个全新的页面。")]),t._v(" "),s("h4",{attrs:{id:"实现原理-工作流程-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现原理-工作流程-4"}},[t._v("🌙")]),t._v(" 实现原理 / 工作流程")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("构建时:")]),t._v(" 与 SSG 一样，生成一个初始版本的静态页面。")]),t._v(" "),s("li",[s("strong",[t._v("第一个请求 (保质期内):")]),t._v(" 用户立即收到静态页面。")]),t._v(" "),s("li",[s("strong",[t._v("第一个请求 (保質期后):")]),t._v("\na. 用户"),s("strong",[t._v("立即")]),t._v("收到"),s("strong",[t._v("旧的 (stale)")]),t._v(" 静态页面。\nb. "),s("strong",[t._v("同时")]),t._v("，Next.js 在后台服务器上重新获取数据并渲染新页面。\nc. 渲染完成后，用新页面替换掉 CDN 上的旧页面。")]),t._v(" "),s("li",[s("strong",[t._v("后续请求:")]),t._v(" 用户会收到这个新鲜出炉的页面，直到下一个保质期结束。")])]),t._v(" "),s("h4",{attrs:{id:"next-js-中的实现-app-router-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#next-js-中的实现-app-router-4"}},[t._v("🌙")]),t._v(" Next.js 中的实现 (App Router)")]),t._v(" "),s("p",[t._v("实现 ISR 非常简单，只需在 "),s("code",[t._v("fetch")]),t._v(" 请求中添加 "),s("code",[t._v("revalidate")]),t._v(" 选项。")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("app/products/[id]/page.tsx")])])]),t._v(" "),s("div",{staticClass:"language-typescript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProductPageProps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  params"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ProductPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" params "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ProductPageProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这个 fetch 请求的结果会被缓存 60 秒")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("https://api.example.com/products/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    next"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" revalidate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关键：每 60 秒最多重新生成一次")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" product "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("description"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("span"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Price"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("span"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("p",[t._v("此外，你还可以通过 Server Action 或 API 路由调用 "),s("code",[t._v("revalidatePath")]),t._v(" 或 "),s("code",[t._v("revalidateTag")]),t._v(" 来实现"),s("strong",[t._v("按需 ISR (On-demand ISR)")]),t._v("，即在特定事件（如商品信息更新）发生时主动触发页面重新生成，而不是被动等待。")]),t._v(" "),s("h4",{attrs:{id:"优缺点-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优缺点-4"}},[t._v("🌙")]),t._v(" 优缺点")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("优点:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("兼具静态速度和动态数据:")]),t._v(" 用户总能快速获得响应，同时数据又能保持相对新鲜。")]),t._v(" "),s("li",[s("strong",[t._v("高容错性:")]),t._v(" 即使后台数据源宕机，用户依然能看到旧的静态页面。")]),t._v(" "),s("li",[s("strong",[t._v("减轻服务器压力:")]),t._v(" 避免了 SSR 的每次请求都计算。")])])]),t._v(" "),s("li",[s("strong",[t._v("缺点:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("数据非实时:")]),t._v(" 用户可能会在短时间内看到旧数据。")])])])]),t._v(" "),s("h4",{attrs:{id:"适用场景-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用场景-4"}},[t._v("🌙")]),t._v(" 适用场景")]),t._v(" "),s("ul",[s("li",[t._v("内容需要更新，但不需要实时性的页面。例如：电商的产品详情页（价格可能偶尔变动）、新闻文章、热门评论区。")])]),t._v(" "),s("h3",{attrs:{id:"总结与选择"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结与选择"}},[t._v("🌙")]),t._v(" 总结与选择")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("特性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("CSR (客户端渲染)")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("SSR (服务端渲染)")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("SSG (静态站点生成)")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("ISR (增量静态再生)")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("SEO")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("差")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("优秀")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("优秀")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("优秀")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("首屏加载 (FCP)")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("慢")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("快")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("最快")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("最快")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("数据新鲜度")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("实时")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("实时")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("构建时")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("近实时/可配置")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("服务器负载")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("低 (API服务器除外)")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("高")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("无")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("低")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("TTFB")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("快")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("慢")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("最快")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("最快")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("构建时间")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("快")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("快")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("慢 (取决于页面数)")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("中等")])])])]),t._v(" "),s("p",[s("strong",[t._v("如何选择？")])]),t._v(" "),s("p",[t._v("Next.js App Router 的最大优势在于你"),s("strong",[t._v("无需为整个应用选择一种策略")]),t._v("。你可以根据每个页面的特性，甚至每个组件的特性，灵活地混合使用它们：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("默认使用服务端组件 (SSR/SSG/ISR)。")]),t._v(" 这是最强大的模式，能带来最好的性能和 SEO。")]),t._v(" "),s("li",[t._v("如果你的页面内容万年不变，就让它"),s("strong",[t._v("自然成为 SSG")]),t._v("。")]),t._v(" "),s("li",[t._v("如果页面内容需要定期更新但不是实时，使用 "),s("code",[t._v("fetch")]),t._v(" 的 "),s("code",[t._v("revalidate")]),t._v(" 选项"),s("strong",[t._v("实现 ISR")]),t._v("。")]),t._v(" "),s("li",[t._v("如果页面内容必须为每个用户实时生成，使用动态函数或 "),s("code",[t._v("cache: 'no-store'")]),t._v(" "),s("strong",[t._v("强制 SSR")]),t._v("。")]),t._v(" "),s("li",[s("strong",[t._v("只有当")]),t._v("你需要用户交互（如 "),s("code",[t._v("onClick")]),t._v(", "),s("code",[t._v("useState")]),t._v("）时，才将那部分组件抽离出来，并添加 "),s("code",[t._v("'use client';")]),t._v("，使其"),s("strong",[t._v("成为客户端组件 (CSR)")]),t._v("。")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"核心理念-服务端优先-按需客户端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#核心理念-服务端优先-按需客户端"}},[t._v("🌙")]),t._v(" 核心理念：服务端优先，按需客户端")]),t._v(" "),s("p",[t._v("在 Next.js App Router 中，"),s("strong",[t._v("所有组件默认都是在服务端渲染的 React 服务端组件 (RSC)")]),t._v("。你只需要在必要时，通过添加 "),s("code",[t._v("'use client';")]),t._v(" 指令，将组件“降级”为客户端组件。")]),t._v(" "),s("p",[t._v("这意味着你的首要思考点是：“我的页面/组件应该如何"),s("strong",[t._v("在服务端")]),t._v("被渲染？”")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"四大渲染方式速查表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四大渲染方式速查表"}},[t._v("🌙")]),t._v(" 四大渲染方式速查表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("渲染方式")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("一句话概括")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("何时渲染？")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("数据新鲜度")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("适用场景")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("App Router 实现方式")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("静态渲染 (SSG)")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("一次构建，无限次快速服务。")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("构建时 ("),s("code",[t._v("next build")]),t._v(")")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("静态的")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("博客文章、文档、营销页")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("默认行为。")]),t._v(" 只要不使用动态函数和动态 "),s("code",[t._v("fetch")]),t._v(" 缓存策略即可。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("动态渲染 (SSR)")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("每个请求都在服务器上实时渲染。")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("每一次用户请求时")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("实时")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("个性化仪表盘、需要登录才能看的内容、搜索结果")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("使用动态函数 ("),s("code",[t._v("cookies()")]),t._v(", "),s("code",[t._v("headers()")]),t._v(") 或 "),s("code",[t._v("fetch")]),t._v(" 中设置 "),s("code",[t._v("cache: 'no-store'")]),t._v("。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("增量静态再生 (ISR)")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("静态的速度，加上自动的后台更新。")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("构建时 + N秒后访问时在后台触发")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("近实时")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("电商产品页、新闻文章、社交媒体帖子")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("在 "),s("code",[t._v("fetch")]),t._v(" 中设置 "),s("code",[t._v("next: { revalidate: N }")]),t._v(" (N为秒数)。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("客户端渲染 (CSR)")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("在用户的浏览器中渲染交互界面。")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("浏览器加载 JS 后")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("实时 (加载后)")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("需要状态 ("),s("code",[t._v("useState")]),t._v(")、事件 ("),s("code",[t._v("onClick")]),t._v(")、生命周期 ("),s("code",[t._v("useEffect")]),t._v(") 的组件")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("在文件顶部添加 "),s("code",[t._v("'use client';")]),t._v(" 指令。")])])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"如何选择-一份决策指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何选择-一份决策指南"}},[t._v("🌙")]),t._v(" 如何选择？一份决策指南")]),t._v(" "),s("p",[t._v("你可以按照这个思路来决定使用哪种渲染方式：")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("从默认开始：静态渲染 (SSG)")])]),t._v(" "),s("ul",[s("li",[t._v("问问自己：“这个页面的内容可以提前生成吗？”")]),t._v(" "),s("li",[t._v("如果可以，什么都不用做，它默认就是静态的。这是最快、最省成本的方式。")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("内容需要更新吗？ -> 增量静态再生 (ISR)")])]),t._v(" "),s("ul",[s("li",[t._v("如果页面内容需要定期更新（比如每小时），但不需要为每个用户都实时变化。")]),t._v(" "),s("li",[s("strong",[t._v("解决方案")]),t._v("：在数据获取的 "),s("code",[t._v("fetch")]),t._v(" 中添加 "),s("code",[t._v("revalidate")]),t._v(" 选项。")]),t._v(" "),s("li",[s("code",[t._v("fetch(url, { next: { revalidate: 3600 } })")])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("内容必须实时且个性化吗？ -> 动态渲染 (SSR)")])]),t._v(" "),s("ul",[s("li",[t._v("如果页面内容必须根据当前登录的用户、请求头或 URL 参数来实时生成。")]),t._v(" "),s("li",[s("strong",[t._v("解决方案")]),t._v("：使用 "),s("code",[t._v("cookies()")]),t._v("、"),s("code",[t._v("headers()")]),t._v(" 等动态函数，或者在 "),s("code",[t._v("fetch")]),t._v(" 中禁用缓存 "),s("code",[t._v("cache: 'no-store'")]),t._v("。Next.js 会自动切换到动态渲染。")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("组件需要与用户交互吗？ -> 客户端渲染 (CSR)")])]),t._v(" "),s("ul",[s("li",[t._v("如果你的组件需要响应点击事件、管理状态（"),s("code",[t._v("useState")]),t._v("）、或者使用浏览器独有的 API。")]),t._v(" "),s("li",[s("strong",[t._v("解决方案")]),t._v("：将这个组件（以及它的子组件）标记为客户端组件："),s("code",[t._v("'use client';")]),t._v("。")])])])]),t._v(" "),s("h3",{attrs:{id:"关键最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关键最佳实践"}},[t._v("🌙")]),t._v(" 关键最佳实践")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("服务端组件是基础")]),t._v("：你的页面主体和布局应该尽量保持为服务端组件，以获得最佳的加载性能和 SEO。")]),t._v(" "),s("li",[s("strong",[t._v("客户端组件是“孤岛”")]),t._v("：只在必要的地方使用 "),s("code",[t._v("'use client';")]),t._v("。将客户端组件想象成插入到服务端渲染的静态 HTML 中的交互式“孤岛”。")]),t._v(" "),s("li",[s("strong",[t._v("最小化客户端组件")]),t._v("：尽量将客户端逻辑下推到组件树的叶子节点。例如，不要把整个页面都标记为 "),s("code",[t._v("'use client';")]),t._v("，而只把你真正需要交互的那个 "),s("code",[t._v("<SearchBar>")]),t._v(" 或 "),s("code",[t._v("<Button>")]),t._v(" 组件标记为客户端组件。")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("fetch")]),t._v(" 是渲染的控制器")]),t._v("：在 App Router 中，"),s("code",[t._v("fetch")]),t._v(" API 被深度集成，它的缓存选项 ("),s("code",[t._v("cache")]),t._v(", "),s("code",[t._v("revalidate")]),t._v(") 是决定一个服务端组件是静态、动态还是增量再生的关键。")])]),t._v(" "),s("p",[s("strong",[t._v("总而言之，Next.js 的现代渲染模型非常灵活，它鼓励你为应用的每个部分选择最合适的策略，而不是一刀切。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);