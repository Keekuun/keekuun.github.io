(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{829:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"node-js-中的-prisma-orm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-js-中的-prisma-orm"}},[s._v("🌙")]),s._v(" Node.js 中的 Prisma ORM")]),s._v(" "),a("p",[s._v("Prisma 是一个现代的、类型安全的 ORM（对象关系映射）工具，专为 TypeScript 和 JavaScript 应用程序设计。它简化了与数据库的交互，提供了强大的查询构建器和数据迁移工具。以下是关于如何在 Node.js 项目中使用 Prisma 的详细介绍。")]),s._v(" "),a("h4",{attrs:{id:"_1-安装-prisma"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-prisma"}},[s._v("🌙")]),s._v(" 1. "),a("strong",[s._v("安装 Prisma")])]),s._v(" "),a("p",[s._v("首先，你需要安装 Prisma CLI 和 Prisma 客户端：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" @prisma/client\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v(" prisma\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("然后初始化 Prisma：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma init\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这将创建一个 "),a("code",[s._v("prisma")]),s._v(" 目录，并生成 "),a("code",[s._v("schema.prisma")]),s._v(" 文件和 "),a("code",[s._v(".env")]),s._v(" 文件模板。")]),s._v(" "),a("h4",{attrs:{id:"_2-配置数据库连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置数据库连接"}},[s._v("🌙")]),s._v(" 2. "),a("strong",[s._v("配置数据库连接")])]),s._v(" "),a("p",[s._v("编辑 "),a("code",[s._v("prisma/schema.prisma")]),s._v(" 文件，配置你的数据库连接字符串。例如，对于 PostgreSQL 数据库：")]),s._v(" "),a("div",{staticClass:"language-prisma line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('generator client {\nprovider = "prisma-client-js"\n}\n\ndatasource db {\nprovider = "postgresql"\nurl      = env("DATABASE_URL")\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("确保在 "),a("code",[s._v(".env")]),s._v(" 文件中提供正确的数据库 URL：")]),s._v(" "),a("div",{staticClass:"language-env line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('DATABASE_URL="postgresql://user:password@localhost:5432/mydb"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_3-定义数据模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-定义数据模型"}},[s._v("🌙")]),s._v(" 3. "),a("strong",[s._v("定义数据模型")])]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("schema.prisma")]),s._v(" 文件中定义你的数据模型。例如，定义一个 "),a("code",[s._v("User")]),s._v(" 模型：")]),s._v(" "),a("div",{staticClass:"language-prisma line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("model User {\nid        Int      @id @default(autoincrement())\nname      String\nemail     String   @unique\nposts     Post[]\ncreatedAt DateTime @default(now())\nupdatedAt DateTime @updatedAt\n}\n\nmodel Post {\nid        Int      @id @default(autoincrement())\ntitle     String\ncontent   String?\npublished Boolean  @default(false)\nauthor    User     @relation(fields: [authorId], references: [id])\nauthorId  Int\ncreatedAt DateTime @default(now())\nupdatedAt DateTime @updatedAt\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h4",{attrs:{id:"_4-生成-prisma-客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-生成-prisma-客户端"}},[s._v("🌙")]),s._v(" 4. "),a("strong",[s._v("生成 Prisma 客户端")])]),s._v(" "),a("p",[s._v("运行以下命令生成 Prisma 客户端：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma generate\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这将在 "),a("code",[s._v("node_modules/@prisma/client")]),s._v(" 中生成 Prisma 客户端代码，使你可以通过 TypeScript 或 JavaScript 访问数据库。")]),s._v(" "),a("h4",{attrs:{id:"_5-执行数据库迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-执行数据库迁移"}},[s._v("🌙")]),s._v(" 5. "),a("strong",[s._v("执行数据库迁移")])]),s._v(" "),a("p",[s._v("使用 Prisma 迁移工具将你的数据模型应用到数据库：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma migrate dev "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" init\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这将根据 "),a("code",[s._v("schema.prisma")]),s._v(" 文件中的定义创建相应的数据库表。")]),s._v(" "),a("h4",{attrs:{id:"_6-编写查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-编写查询"}},[s._v("🌙")]),s._v(" 6. "),a("strong",[s._v("编写查询")])]),s._v(" "),a("p",[s._v("使用 Prisma 客户端进行数据库操作。例如，在 Express 应用中查询用户列表：")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" PrismaClient "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@prisma/client'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" express "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" prisma "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrismaClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("express")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/users'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("findMany")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'服务器正在监听端口 3000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h4",{attrs:{id:"_7-常见操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-常见操作"}},[s._v("🌙")]),s._v(" 7. "),a("strong",[s._v("常见操作")])]),s._v(" "),a("h5",{attrs:{id:"_7-1-创建记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-创建记录"}},[s._v("🌙")]),s._v(" 7.1 创建记录")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Alice'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("email")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'alice@example.com'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h5",{attrs:{id:"_7-2-查询记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-查询记录"}},[s._v("🌙")]),s._v(" 7.2 查询记录")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("findMany")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("where")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("email")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("contains")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'example.com'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h5",{attrs:{id:"_7-3-更新记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-更新记录"}},[s._v("🌙")]),s._v(" 7.3 更新记录")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" updatedUser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("where")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Bob'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("updatedUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h5",{attrs:{id:"_7-4-删除记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-删除记录"}},[s._v("🌙")]),s._v(" 7.4 删除记录")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" deletedUser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("delete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("where")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("deletedUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"_8-类型安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-类型安全"}},[s._v("🌙")]),s._v(" 8. "),a("strong",[s._v("类型安全")])]),s._v(" "),a("p",[s._v("Prisma 提供了强大的类型推断功能，特别是在 TypeScript 环境下。所有查询结果都是类型安全的，减少了运行时错误的可能性。")]),s._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" PrismaClient "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@prisma/client'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" prisma "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrismaClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("findUnique")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nwhere"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 类型安全，编译时检查")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("finally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("$disconnect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h4",{attrs:{id:"_9-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-总结"}},[s._v("🌙")]),s._v(" 9. "),a("strong",[s._v("总结")])]),s._v(" "),a("p",[s._v("Prisma 是一个现代化的 ORM 工具，提供了简洁的 API 和强大的功能，适用于各种数据库操作。通过 Prisma，你可以轻松地管理数据库模式、执行迁移、编写类型安全的查询，并提高开发效率。")]),s._v(" "),a("h3",{attrs:{id:"prisma-操作数据库字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prisma-操作数据库字段"}},[s._v("🌙")]),s._v(" Prisma 操作数据库字段")]),s._v(" "),a("p",[s._v("在使用 Prisma 进行数据库模式的修改（如新增字段、删除字段、修改字段）时，你需要按照以下步骤进行操作：")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("修改 "),a("code",[s._v("schema.prisma")]),s._v(" 文件")]),s._v("：在 "),a("code",[s._v("prisma/schema.prisma")]),s._v(" 文件中进行相应的修改。")]),s._v(" "),a("li",[a("strong",[s._v("创建迁移")]),s._v("：使用 Prisma 迁移工具创建新的迁移文件。")]),s._v(" "),a("li",[a("strong",[s._v("应用迁移")]),s._v("：将迁移应用到本地数据库。")]),s._v(" "),a("li",[a("strong",[s._v("应用迁移到远程数据库")]),s._v("：将迁移应用到远程数据库。")])]),s._v(" "),a("p",[s._v("以下是详细步骤和示例：")]),s._v(" "),a("h4",{attrs:{id:"_1-修改-schema-prisma-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-修改-schema-prisma-文件"}},[s._v("🌙")]),s._v(" 1. 修改 "),a("code",[s._v("schema.prisma")]),s._v(" 文件")]),s._v(" "),a("p",[s._v("假设你已经有一个 "),a("code",[s._v("User")]),s._v(" 模型，并且你想进行以下修改：")]),s._v(" "),a("ul",[a("li",[s._v("新增一个 "),a("code",[s._v("age")]),s._v(" 字段。")]),s._v(" "),a("li",[s._v("修改 "),a("code",[s._v("email")]),s._v(" 字段的默认值。")]),s._v(" "),a("li",[s._v("删除 "),a("code",[s._v("updatedAt")]),s._v(" 字段。")])]),s._v(" "),a("p",[s._v("修改后的 "),a("code",[s._v("schema.prisma")]),s._v(" 文件如下：")]),s._v(" "),a("div",{staticClass:"language-prisma line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('generator client {\n  provider = "prisma-client-js"\n}\n\ndatasource db {\n  provider = "postgresql"\n  url      = env("DATABASE_URL")\n}\n\nmodel User {\n  id        Int      @id @default(autoincrement())\n  name      String\n  email     String   @unique @default("default@example.com")\n  age       Int?     // 新增字段\n  posts     Post[]\n  createdAt DateTime @default(now())\n  // 删除字段\n}\n\nmodel Post {\n  id        Int      @id @default(autoincrement())\n  title     String\n  content   String?\n  published Boolean  @default(false)\n  author    User     @relation(fields: [authorId], references: [id])\n  authorId  Int\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h4",{attrs:{id:"_2-创建迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建迁移"}},[s._v("🌙")]),s._v(" 2. 创建迁移")]),s._v(" "),a("p",[s._v("使用 Prisma 迁移工具创建新的迁移文件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma migrate dev "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" add_age_field\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这将生成一个新的迁移文件，记录了你对 "),a("code",[s._v("schema.prisma")]),s._v(" 文件所做的修改。")]),s._v(" "),a("h4",{attrs:{id:"_3-应用迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-应用迁移"}},[s._v("🌙")]),s._v(" 3. 应用迁移")]),s._v(" "),a("p",[s._v("Prisma 迁移工具会自动将迁移应用到本地数据库。如果一切顺利，你会看到类似以下的输出：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Prisma schema loaded from prisma/schema.prisma\nDatasource "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" PostgreSQL database "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mydb"')]),s._v(" at "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost:5432"')]),s._v("\n\nApplying migration "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("20231010123456_add_age_field"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\nThe following migration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" have been created and applied from new schema changes:\n\nmigrations/\n  └── 20231010123456_add_age_field/\n    └── migration.sql\n\nYour database is now "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v(" with your schema.\n\nRunning generate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Use --skip-generate to skip the generators"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nadded "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" package, and audited "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" package "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".2s\n\nfound "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" vulnerabilities\n\n✔ Generated Prisma Client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.11")]),s._v(".0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" library"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to ./node_modules/@prisma/client "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 255ms\nYou can now start using Prisma Client "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" your code. Reference: https://pris.ly/d/client\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h4",{attrs:{id:"_4-应用迁移到远程数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-应用迁移到远程数据库"}},[s._v("🌙")]),s._v(" 4. 应用迁移到远程数据库")]),s._v(" "),a("p",[s._v("要将迁移应用到远程数据库，你需要确保 "),a("code",[s._v("DATABASE_URL")]),s._v(" 环境变量指向远程数据库。然后运行以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma migrate deploy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这将应用所有未应用的迁移文件到远程数据库。")]),s._v(" "),a("h4",{attrs:{id:"_5-验证迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-验证迁移"}},[s._v("🌙")]),s._v(" 5. 验证迁移")]),s._v(" "),a("p",[s._v("你可以通过以下方式验证迁移是否成功：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("使用数据库管理工具")]),s._v("：连接到你的数据库，检查 "),a("code",[s._v("User")]),s._v(" 表是否包含 "),a("code",[s._v("age")]),s._v(" 字段，"),a("code",[s._v("email")]),s._v(" 字段的默认值是否已更改，"),a("code",[s._v("updatedAt")]),s._v(" 字段是否已被删除。")]),s._v(" "),a("li",[a("strong",[s._v("使用 Prisma Studio")]),s._v("：Prisma 提供了一个图形化的数据库管理工具，可以方便地查看和管理数据库。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma studio\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_6-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-总结"}},[s._v("🌙")]),s._v(" 6. 总结")]),s._v(" "),a("p",[s._v("通过以上步骤，你可以轻松地使用 Prisma 修改数据库字段、新增字段、删除字段，并将这些更改应用到远程数据库。Prisma 的迁移工具确保了数据库模式的版本控制和一致性，使得数据库管理更加高效和可靠。")]),s._v(" "),a("h3",{attrs:{id:"prisma-增加约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prisma-增加约束"}},[s._v("🌙")]),s._v(" Prisma 增加约束")]),s._v(" "),a("p",[s._v("在使用 Prisma 修改数据库字段并添加约束条件时，你需要在 "),a("code",[s._v("schema.prisma")]),s._v(" 文件中进行相应的定义，然后创建和应用迁移。以下是一些常见的约束条件及其在 Prisma 中的定义方法。")]),s._v(" "),a("h4",{attrs:{id:"常见约束条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见约束条件"}},[s._v("🌙")]),s._v(" 常见约束条件")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("唯一约束（Unique Constraint）")]),s._v("： 在字段上添加 "),a("code",[s._v("@unique")]),s._v("，Prisma 将自动为该字段添加唯一约束。")]),s._v(" "),a("li",[a("strong",[s._v("非空约束（Not Null Constraint）")]),s._v("： 默认情况下，字段是非空的，除非使用 ? 表示可选字段。")]),s._v(" "),a("li",[a("strong",[s._v("默认值（Default Value）")]),s._v("： 在字段上添加 "),a("code",[s._v("@default(value)")]),s._v("，Prisma 将自动为该字段添加默认值。")]),s._v(" "),a("li",[a("strong",[s._v("外键约束（Foreign Key Constraint）")]),s._v("： 在字段上添加 "),a("code",[s._v("@relation")]),s._v("，Prisma 将自动为该字段添加外键约束。")]),s._v(" "),a("li",[a("strong",[s._v("检查约束（Check Constraint）")]),s._v("（某些数据库支持，如 PostgreSQL）：  @@index 和 @@unique 可以用于简单的检查约束，但 Prisma 本身不直接支持复杂的 CHECK 约束。对于复杂的检查约束，可以使用数据库的原生 SQL。")])]),s._v(" "),a("ul",[a("li",[s._v("示例：在 "),a("code",[s._v("User")]),s._v(" 模型中添加约束条件")])]),s._v(" "),a("p",[s._v("假设你有一个 "),a("code",[s._v("User")]),s._v(" 模型，并且你想进行以下修改：")]),s._v(" "),a("ul",[a("li",[s._v("新增一个 "),a("code",[s._v("age")]),s._v(" 字段，并添加非空约束。")]),s._v(" "),a("li",[s._v("修改 "),a("code",[s._v("email")]),s._v(" 字段，使其具有唯一约束。")]),s._v(" "),a("li",[s._v("新增一个 "),a("code",[s._v("role")]),s._v(" 字段，并添加默认值为 "),a("code",[s._v("'user'")]),s._v("。")]),s._v(" "),a("li",[s._v("新增一个 "),a("code",[s._v("createdAt")]),s._v(" 字段，并添加非空约束和默认值为当前时间。")])]),s._v(" "),a("h4",{attrs:{id:"_1-修改-schema-prisma-文件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-修改-schema-prisma-文件-2"}},[s._v("🌙")]),s._v(" 1. 修改 "),a("code",[s._v("schema.prisma")]),s._v(" 文件")]),s._v(" "),a("div",{staticClass:"language-prisma line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('generator client {\n  provider = "prisma-client-js"\n}\n\ndatasource db {\n  provider = "postgresql"\n  url      = env("DATABASE_URL")\n}\n\nmodel User {\n  id        Int      @id @default(autoincrement())\n  name      String\n  email     String   @unique  // 增加唯一约束\n  age       Int      @default(18) // 新增字段，非空约束，默认值为 18\n  role      String   @default("user") // 新增字段，默认值为 \'user\'\n  createdAt DateTime @default(now()) // 新增字段，非空约束，默认值为当前时间\n  posts     Post[]\n}\n\nmodel Post {\n  id        Int      @id @default(autoincrement())\n  title     String\n  content   String?\n  published Boolean  @default(false)\n  author    User     @relation(fields: [authorId], references: [id])\n  authorId  Int\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h4",{attrs:{id:"_2-创建迁移-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建迁移-2"}},[s._v("🌙")]),s._v(" 2. 创建迁移")]),s._v(" "),a("p",[s._v("使用 Prisma 迁移工具创建新的迁移文件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma migrate dev "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" add_constraints\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这将生成一个新的迁移文件，记录了你对 "),a("code",[s._v("schema.prisma")]),s._v(" 文件所做的修改。")]),s._v(" "),a("h4",{attrs:{id:"_3-应用迁移-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-应用迁移-2"}},[s._v("🌙")]),s._v(" 3. 应用迁移")]),s._v(" "),a("p",[s._v("Prisma 迁移工具会自动将迁移应用到本地数据库。如果一切顺利，你会看到类似以下的输出：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Prisma schema loaded from prisma/schema.prisma\nDatasource "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" PostgreSQL database "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mydb"')]),s._v(" at "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost:5432"')]),s._v("\n\nApplying migration "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("20231011123456_add_constraints"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\nThe following migration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" have been created and applied from new schema changes:\n\nmigrations/\n  └── 20231011123456_add_constraints/\n    └── migration.sql\n\nYour database is now "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v(" with your schema.\n\nRunning generate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Use --skip-generate to skip the generators"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nadded "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" package, and audited "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" package "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".2s\n\nfound "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" vulnerabilities\n\n✔ Generated Prisma Client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.11")]),s._v(".0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" library"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to ./node_modules/@prisma/client "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 255ms\nYou can now start using Prisma Client "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" your code. Reference: https://pris.ly/d/client\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h4",{attrs:{id:"_4-应用迁移到远程数据库-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-应用迁移到远程数据库-2"}},[s._v("🌙")]),s._v(" 4. 应用迁移到远程数据库")]),s._v(" "),a("p",[s._v("要将迁移应用到远程数据库，你需要确保 "),a("code",[s._v("DATABASE_URL")]),s._v(" 环境变量指向远程数据库。然后运行以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma migrate deploy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这将应用所有未应用的迁移文件到远程数据库。")]),s._v(" "),a("h4",{attrs:{id:"_5-验证迁移-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-验证迁移-2"}},[s._v("🌙")]),s._v(" 5. 验证迁移")]),s._v(" "),a("p",[s._v("你可以通过以下方式验证迁移是否成功：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("使用数据库管理工具")]),s._v("：连接到你的数据库，检查 "),a("code",[s._v("User")]),s._v(" 表是否包含 "),a("code",[s._v("age")]),s._v(" 字段、"),a("code",[s._v("role")]),s._v(" 字段和 "),a("code",[s._v("createdAt")]),s._v(" 字段，并验证它们的约束条件。")]),s._v(" "),a("li",[a("strong",[s._v("使用 Prisma Studio")]),s._v("：Prisma 提供了一个图形化的数据库管理工具，可以方便地查看和管理数据库。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma studio\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_6-总结-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-总结-2"}},[s._v("🌙")]),s._v(" 6. 总结")]),s._v(" "),a("p",[s._v("通过以上步骤，你可以在 Prisma 中轻松地添加字段并设置各种约束条件。Prisma 的迁移工具确保了数据库模式的版本控制和一致性，使得数据库管理更加高效和可靠。")]),s._v(" "),a("h3",{attrs:{id:"prisma-底层原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prisma-底层原理"}},[s._v("🌙")]),s._v(" Prisma 底层原理")]),s._v(" "),a("p",[s._v("Prisma 是一个现代的、类型安全的 ORM（对象关系映射）工具，旨在简化与数据库的交互。它提供了强大的查询构建器、数据迁移工具和类型安全的查询能力。以下是 Prisma 的底层原理和工作流程的详细解释。")]),s._v(" "),a("h4",{attrs:{id:"_1-架构概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-架构概述"}},[s._v("🌙")]),s._v(" 1. "),a("strong",[s._v("架构概述")])]),s._v(" "),a("p",[s._v("Prisma 的架构可以分为以下几个主要部分：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("Prisma Client")]),s._v("：生成的客户端库，用于与数据库进行交互。")]),s._v(" "),a("li",[a("strong",[s._v("Prisma Migrate")]),s._v("：用于管理数据库迁移的工具。")]),s._v(" "),a("li",[a("strong",[s._v("Prisma Schema")]),s._v("：定义数据模型和数据库连接的配置文件。")]),s._v(" "),a("li",[a("strong",[s._v("Query Engine")]),s._v("：负责生成和执行数据库查询的底层引擎。")]),s._v(" "),a("li",[a("strong",[s._v("Introspection Engine")]),s._v("：用于从现有数据库生成 Prisma Schema 的工具。")])]),s._v(" "),a("h4",{attrs:{id:"_2-prisma-schema"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-prisma-schema"}},[s._v("🌙")]),s._v(" 2. "),a("strong",[s._v("Prisma Schema")])]),s._v(" "),a("p",[a("code",[s._v("schema.prisma")]),s._v(" 文件是 Prisma 的核心配置文件，定义了数据模型和数据库连接信息。它包括以下部分：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("Generator")]),s._v("：指定生成 Prisma Client 的配置。")]),s._v(" "),a("li",[a("strong",[s._v("Datasource")]),s._v("：配置数据库连接字符串。")]),s._v(" "),a("li",[a("strong",[s._v("Model")]),s._v("：定义数据模型，包括字段、关系和约束。")])]),s._v(" "),a("div",{staticClass:"language-prisma line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('generator client {\n  provider = "prisma-client-js"\n}\n\ndatasource db {\n  provider = "postgresql"\n  url      = env("DATABASE_URL")\n}\n\nmodel User {\n  id        Int      @id @default(autoincrement())\n  name      String\n  email     String   @unique\n  posts     Post[]\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n}\n\nmodel Post {\n  id        Int      @id @default(autoincrement())\n  title     String\n  content   String?\n  published Boolean  @default(false)\n  author    User     @relation(fields: [authorId], references: [id])\n  authorId  Int\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h4",{attrs:{id:"_3-prisma-client-生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-prisma-client-生成"}},[s._v("🌙")]),s._v(" 3. "),a("strong",[s._v("Prisma Client 生成")])]),s._v(" "),a("p",[s._v("Prisma Client 是通过 "),a("code",[s._v("npx prisma generate")]),s._v(" 命令生成的 TypeScript/JavaScript 库。它提供了类型安全的查询构建器，使得数据库操作更加直观和安全。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma generate\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("生成的 Prisma Client 包含以下功能：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("类型安全的查询构建器")]),s._v("：根据 "),a("code",[s._v("schema.prisma")]),s._v(" 文件生成类型定义。")]),s._v(" "),a("li",[a("strong",[s._v("自动完成")]),s._v("：在编辑器中提供自动完成功能，帮助你编写正确的查询。")]),s._v(" "),a("li",[a("strong",[s._v("错误处理")]),s._v("：提供详细的错误信息，帮助你调试和解决问题。")])]),s._v(" "),a("h4",{attrs:{id:"_4-prisma-migrate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-prisma-migrate"}},[s._v("🌙")]),s._v(" 4. "),a("strong",[s._v("Prisma Migrate")])]),s._v(" "),a("p",[s._v("Prisma Migrate 是用于管理数据库迁移的工具，确保数据库模式与 "),a("code",[s._v("schema.prisma")]),s._v(" 文件保持一致。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("创建迁移")]),s._v("：使用 "),a("code",[s._v("npx prisma migrate dev --name <migration-name>")]),s._v(" 命令创建迁移文件。")]),s._v(" "),a("li",[a("strong",[s._v("应用迁移")]),s._v("：使用 "),a("code",[s._v("npx prisma migrate deploy")]),s._v(" 命令将迁移应用到数据库。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma migrate dev "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" add_age_field\nnpx prisma migrate deploy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("迁移文件包含 SQL 语句，用于在数据库中创建、修改或删除表和字段。")]),s._v(" "),a("h4",{attrs:{id:"_5-query-engine"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-query-engine"}},[s._v("🌙")]),s._v(" 5. "),a("strong",[s._v("Query Engine")])]),s._v(" "),a("p",[s._v("Query Engine 是 Prisma 的核心组件，负责生成和执行数据库查询。它与 Prisma Client 和数据库进行交互，确保查询的高效性和正确性。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("查询生成")]),s._v("：根据 Prisma Client 的查询请求生成相应的 SQL 语句。")]),s._v(" "),a("li",[a("strong",[s._v("查询执行")]),s._v("：执行生成的 SQL 语句，并将结果返回给 Prisma Client。")]),s._v(" "),a("li",[a("strong",[s._v("结果处理")]),s._v("：将数据库返回的结果转换为 JavaScript/TypeScript 对象。")])]),s._v(" "),a("h4",{attrs:{id:"_6-introspection-engine"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-introspection-engine"}},[s._v("🌙")]),s._v(" 6. "),a("strong",[s._v("Introspection Engine")])]),s._v(" "),a("p",[s._v("Introspection Engine 是用于从现有数据库生成 Prisma Schema 的工具。它可以帮助你快速开始使用 Prisma，而不需要手动编写 "),a("code",[s._v("schema.prisma")]),s._v(" 文件。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("数据库连接")]),s._v("：连接到现有的数据库。")]),s._v(" "),a("li",[a("strong",[s._v("模式提取")]),s._v("：提取数据库的表结构、字段和关系。")]),s._v(" "),a("li",[a("strong",[s._v("Schema 生成")]),s._v("：生成相应的 "),a("code",[s._v("schema.prisma")]),s._v(" 文件。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("npx prisma db pull\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_7-工作流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-工作流程"}},[s._v("🌙")]),s._v(" 7. "),a("strong",[s._v("工作流程")])]),s._v(" "),a("p",[s._v("以下是使用 Prisma 的典型工作流程：")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("定义数据模型")]),s._v("：在 "),a("code",[s._v("schema.prisma")]),s._v(" 文件中定义数据模型。")]),s._v(" "),a("li",[a("strong",[s._v("生成 Prisma Client")]),s._v("：运行 "),a("code",[s._v("npx prisma generate")]),s._v(" 生成 Prisma Client。")]),s._v(" "),a("li",[a("strong",[s._v("创建迁移")]),s._v("：运行 "),a("code",[s._v("npx prisma migrate dev --name <migration-name>")]),s._v(" 创建迁移文件。")]),s._v(" "),a("li",[a("strong",[s._v("应用迁移")]),s._v("：运行 "),a("code",[s._v("npx prisma migrate deploy")]),s._v(" 将迁移应用到数据库。")]),s._v(" "),a("li",[a("strong",[s._v("编写查询")]),s._v("：使用 Prisma Client 进行数据库操作。")]),s._v(" "),a("li",[a("strong",[s._v("验证迁移")]),s._v("：使用数据库管理工具或 Prisma Studio 验证数据库模式。")])]),s._v(" "),a("h4",{attrs:{id:"_8-类型安全-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-类型安全-2"}},[s._v("🌙")]),s._v(" 8. "),a("strong",[s._v("类型安全")])]),s._v(" "),a("p",[s._v("Prisma 提供了强大的类型推断功能，特别是在 TypeScript 环境下。Prisma Client 生成的代码与 "),a("code",[s._v("schema.prisma")]),s._v(" 文件中的定义保持一致，确保所有查询都是类型安全的。")]),s._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" PrismaClient "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@prisma/client'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" prisma "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrismaClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("findUnique")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    where"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 类型安全，编译时检查")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("finally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" prisma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("$disconnect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h4",{attrs:{id:"_9-总结-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-总结-2"}},[s._v("🌙")]),s._v(" 9. "),a("strong",[s._v("总结")])]),s._v(" "),a("p",[s._v("Prisma 的底层原理涉及多个组件和工具，共同确保了数据库操作的高效性和安全性。通过 Prisma Schema 定义数据模型，Prisma Client 提供类型安全的查询构建器，Prisma Migrate 管理数据库迁移，而 Query Engine 负责生成和执行数据库查询。这些组件协同工作，使得 Prisma 成为一个强大且灵活的 ORM 工具。")])])}),[],!1,null,null,null);a.default=e.exports}}]);