(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{993:function(s,t,a){"use strict";a.r(t);var e=a(2),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("çº¿ä¸Šç”¨æˆ·åé¦ˆé¡µé¢ç™½å±æ˜¯ä¸€ä¸ª**P0çº§ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰**çš„ç´§æ€¥é—®é¢˜ã€‚ç°åœ¨æˆ‘ä»¬çš„ Next.js åº”ç”¨æ˜¯ä½¿ç”¨ PM2 ç›´æ¥éƒ¨ç½²åœ¨æœåŠ¡å™¨ï¼ˆå¯èƒ½æ˜¯è™šæ‹Ÿæœºæˆ–ç‰©ç†æœºï¼‰ä¸Šçš„ã€‚æ’æŸ¥é€»è¾‘â€”â€”"),t("strong",[s._v("åŒºåˆ†å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ã€ä»¥æ—¥å¿—ä¸ºä¸­å¿ƒ")]),s._v("ã€‚")]),s._v(" "),t("h3",{attrs:{id:"pm2-ç¯å¢ƒä¸‹çš„åº”æ€¥å“åº”ä¸å®šä½æµç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pm2-ç¯å¢ƒä¸‹çš„åº”æ€¥å“åº”ä¸å®šä½æµç¨‹"}},[s._v("ğŸŒ™")]),s._v(" PM2 ç¯å¢ƒä¸‹çš„åº”æ€¥å“åº”ä¸å®šä½æµç¨‹")]),s._v(" "),t("h4",{attrs:{id:"ç¬¬-1-é˜¶æ®µ-ç´§æ€¥è¯„ä¼°ä¸å¿«é€Ÿæ­¢æŸ-first-5-minutes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬-1-é˜¶æ®µ-ç´§æ€¥è¯„ä¼°ä¸å¿«é€Ÿæ­¢æŸ-first-5-minutes"}},[s._v("ğŸŒ™")]),s._v(" ç¬¬ 1 é˜¶æ®µï¼šç´§æ€¥è¯„ä¼°ä¸å¿«é€Ÿæ­¢æŸ (First 5 Minutes)")]),s._v(" "),t("p",[t("strong",[s._v("1. å¤ç°ä¸æµè§ˆå™¨ç«¯åˆ†æ (ä¸ä¹‹å‰ä¸€è‡´)")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("éšèº«æ¨¡å¼")]),s._v("æ‰“å¼€å‡ºé—®é¢˜çš„é¡µé¢ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)")]),s._v("ï¼š\n"),t("ul",[t("li",[t("strong",[s._v("Console (æ§åˆ¶å°)")]),s._v(": æ˜¯å¦æœ‰ JavaScript é”™è¯¯ï¼Ÿè¿™æ˜¯åŒºåˆ†å®¢æˆ·ç«¯/æœåŠ¡ç«¯é—®é¢˜çš„ç¬¬ä¸€ä¸ªå…³é”®çº¿ç´¢ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("Network (ç½‘ç»œ)")]),s._v(": é¡µé¢æœ¬èº«ï¼ˆHTML æ–‡æ¡£ï¼‰çš„è¯·æ±‚çŠ¶æ€ç æ˜¯ 200 è¿˜æ˜¯ 5xxï¼Ÿ")])])])]),s._v(" "),t("p",[t("strong",[s._v("2. ç«‹åˆ»æ£€æŸ¥ PM2 æ—¥å¿—ï¼")]),s._v("\nè¿™æ˜¯æ•´ä¸ªæ’æŸ¥è¿‡ç¨‹çš„æ ¸å¿ƒã€‚ä½ éœ€è¦ SSH ç™»å½•åˆ°åº”ç”¨æœåŠ¡å™¨ã€‚PM2 ä¼šç®¡ç†åº”ç”¨çš„æ—¥å¿—è¾“å‡º (stdout) å’Œé”™è¯¯è¾“å‡º (stderr)ã€‚")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. æŸ¥çœ‹ç”± PM2 ç®¡ç†çš„æ‰€æœ‰åº”ç”¨çš„çŠ¶æ€")]),s._v("\npm2 status\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. æŸ¥çœ‹åº”ç”¨çš„å®æ—¶æ—¥å¿— (å°† <app_name> æ›¿æ¢ä¸ºä½ çš„åº”ç”¨åæˆ–ID)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿™æ˜¯æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œä¼šåŒæ—¶æ˜¾ç¤ºæ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡º")]),s._v("\npm2 logs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("app_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. åªçœ‹é”™è¯¯æ—¥å¿—ï¼Œè¿™é€šå¸¸æ›´æœ‰ä»·å€¼ï¼")]),s._v("\npm2 logs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("app_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--err")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. å¦‚æœæ—¥å¿—å¤ªå¤šï¼Œå¯ä»¥åªçœ‹æœ€åå‡ ç™¾è¡Œ")]),s._v("\npm2 logs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("app_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--lines")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[t("strong",[s._v("åœ¨æ—¥å¿—ä¸­ä½ è¦å¯»æ‰¾ä»€ä¹ˆï¼Ÿ")])]),s._v(" "),t("ul",[t("li",[s._v("ä»»ä½• "),t("code",[s._v("Error:")]),s._v(" å¼€å¤´çš„å †æ ˆè·Ÿè¸ª (stack trace)ã€‚")]),s._v(" "),t("li",[s._v("æ•°æ®åº“è¿æ¥é”™è¯¯ã€ç¬¬ä¸‰æ–¹ API è¶…æ—¶ã€æ–‡ä»¶æƒé™é—®é¢˜ç­‰ã€‚")]),s._v(" "),t("li",[s._v("ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœåº”ç”¨é¢‘ç¹é‡å¯ï¼Œ"),t("code",[s._v("pm2 status")]),s._v(" ä¼šæ˜¾ç¤º "),t("code",[s._v("restarts")]),s._v(" æ¬¡æ•°å¾ˆé«˜ã€‚è¿™é€šå¸¸æ˜¯è‡´å‘½é”™è¯¯å¯¼è‡´è¿›ç¨‹å´©æºƒçš„è¿¹è±¡ã€‚")])]),s._v(" "),t("p",[t("strong",[s._v("3. å¿«é€Ÿå†³ç­–ï¼šå›æ»š")]),s._v("\nå¦‚æœé—®é¢˜æ˜¯æœ€è¿‘çš„ä¸Šçº¿å¯¼è‡´çš„ï¼Œæœ€å¿«çš„æ¢å¤æ–¹æ³•æ˜¯å›æ»šä»£ç ã€‚åœ¨ PM2 çš„åœºæ™¯ä¸‹ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªåŸå­åŒ–çš„æ“ä½œï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å¸¸è§çš„éƒ¨ç½²ç­–ç•¥ï¼ˆå¦‚ Capistrano é£æ ¼ï¼‰ä¼šå°†æ¯ä¸ªç‰ˆæœ¬éƒ¨ç½²åˆ°å¸¦æ—¶é—´æˆ³çš„ç›®å½•ä¸­ï¼Œå¹¶ç”¨ä¸€ä¸ªåä¸º "),t("code",[s._v("current")]),s._v(" çš„è½¯é“¾æ¥æŒ‡å‘å½“å‰ç‰ˆæœ¬ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å›æ»šæ“ä½œ")]),s._v("ï¼šå°† "),t("code",[s._v("current")]),s._v(" è½¯é“¾æ¥æŒ‡å‘ä¸Šä¸€ä¸ªç¨³å®šçš„ç‰ˆæœ¬ç›®å½•ï¼Œç„¶åæ‰§è¡Œ "),t("code",[s._v("pm2 reload <app_name>")]),s._v("ã€‚è¿™å¯ä»¥å®ç°é›¶åœæœºå›æ»šã€‚")])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"ç¬¬-2-é˜¶æ®µ-æ·±åº¦å®šä½é—®é¢˜æ ¹æº"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬-2-é˜¶æ®µ-æ·±åº¦å®šä½é—®é¢˜æ ¹æº"}},[s._v("ğŸŒ™")]),s._v(" ç¬¬ 2 é˜¶æ®µï¼šæ·±åº¦å®šä½é—®é¢˜æ ¹æº")]),s._v(" "),t("h4",{attrs:{id:"åœºæ™¯ä¸€-å®šä½å®¢æˆ·ç«¯é”™è¯¯-æµè§ˆå™¨æ§åˆ¶å°æœ‰-js-é”™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åœºæ™¯ä¸€-å®šä½å®¢æˆ·ç«¯é”™è¯¯-æµè§ˆå™¨æ§åˆ¶å°æœ‰-js-é”™"}},[s._v("ğŸŒ™")]),s._v(" åœºæ™¯ä¸€ï¼šå®šä½å®¢æˆ·ç«¯é”™è¯¯ (æµè§ˆå™¨æ§åˆ¶å°æœ‰ JS é”™)")]),s._v(" "),t("p",[t("strong",[s._v("æŒ‘æˆ˜")]),s._v("ï¼šå’Œ Docker åœºæ™¯ä¸€æ ·ï¼Œä½ çœ‹åˆ°çš„å°†æ˜¯å‹ç¼©åçš„ä»£ç å †æ ˆã€‚")]),s._v(" "),t("p",[t("strong",[s._v("è§£å†³æ–¹æ¡ˆï¼šæœ¬åœ°å¤ç°ä¸ Source Map è§£ç ")])]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("è·å–æ„å»ºäº§ç‰©")]),s._v(":\nä½ çš„æ„å»ºäº§ç‰©ï¼ˆåŒ…æ‹¬ Source Mapsï¼‰å°±åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿä¸Šï¼Œä½äºä½ çš„é¡¹ç›®éƒ¨ç½²ç›®å½•ä¸‹çš„ "),t("code",[s._v(".next")]),s._v(" æ–‡ä»¶å¤¹é‡Œã€‚ä½ å¯ä»¥ä½¿ç”¨ "),t("code",[s._v("scp")]),s._v(" æˆ– "),t("code",[s._v("rsync")]),s._v(" å°†æ•´ä¸ª "),t("code",[s._v(".next")]),s._v(" ç›®å½•ä»æœåŠ¡å™¨ä¸‹è½½åˆ°æœ¬åœ°ã€‚")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¯­æ³•: scp -r user@your_server_ip:/path/to/your/app/.next ./")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" ubuntu@123.45.67.89:/var/www/my-app/current/.next ./local-next-build\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("æ‰‹åŠ¨è§£ç ")]),s._v(":\næœ‰äº† "),t("code",[s._v(".next")]),s._v(" ç›®å½•ï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤å°±å’Œ Docker åœºæ™¯å®Œå…¨ä¸€æ ·äº†ï¼šæ‰¾åˆ°æŠ¥é”™çš„æ–‡ä»¶åã€è¡Œåˆ—å·ï¼Œç„¶åä½¿ç”¨ "),t("code",[s._v("source-map")]),s._v(" åº“æˆ–åœ¨çº¿å·¥å…·ï¼Œç»“åˆå¯¹åº”çš„ "),t("code",[s._v(".map")]),s._v(" æ–‡ä»¶æ¥å®šä½åˆ°åŸå§‹çš„ TypeScript ä»£ç ã€‚")])])]),s._v(" "),t("h4",{attrs:{id:"åœºæ™¯äºŒ-å®šä½æœåŠ¡ç«¯é”™è¯¯-é¡µé¢è¯·æ±‚-500-æˆ–-pm2-ä¸æ–­é‡å¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åœºæ™¯äºŒ-å®šä½æœåŠ¡ç«¯é”™è¯¯-é¡µé¢è¯·æ±‚-500-æˆ–-pm2-ä¸æ–­é‡å¯"}},[s._v("ğŸŒ™")]),s._v(" åœºæ™¯äºŒï¼šå®šä½æœåŠ¡ç«¯é”™è¯¯ (é¡µé¢è¯·æ±‚ 500 æˆ– PM2 ä¸æ–­é‡å¯)")]),s._v(" "),t("p",[s._v("è¿™æ˜¯ PM2 ç¯å¢ƒä¸‹æœ€éœ€è¦å…³æ³¨çš„æƒ…å†µã€‚")]),s._v(" "),t("p",[t("strong",[s._v("è§£å†³æ–¹æ¡ˆï¼šæ·±æŒ–æ—¥å¿—ã€æ£€æŸ¥ç¯å¢ƒå’Œç³»ç»Ÿèµ„æº")])]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("æ·±æŒ– PM2 æ—¥å¿—")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("pm2 logs --err")]),s._v(" æ˜¯ä½ çš„å¥½æœ‹å‹ã€‚æœåŠ¡ç«¯çš„å †æ ˆè·Ÿè¸ªæ˜¯"),t("strong",[s._v("å¯è¯»çš„")]),s._v("ï¼Œä¼šç›´æ¥æŒ‡å‘ä½ ä»£ç ä¸­çš„æ–‡ä»¶å’Œè¡Œå·ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("å®æ–½ç»“æ„åŒ–æ—¥å¿—")]),s._v("ï¼šè¿™ä¸ªå»ºè®®ä¾ç„¶é€‚ç”¨ã€‚å°†é”™è¯¯åŒ…è£…åœ¨ JSON å¯¹è±¡ä¸­è¾“å‡ºï¼Œå¯ä»¥è®©æ—¥å¿—åˆ†æäº‹åŠåŠŸå€ã€‚")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("æ£€æŸ¥ç¯å¢ƒå˜é‡")]),s._v("ï¼š\nPM2 åº”ç”¨çš„ç¯å¢ƒå˜é‡æ¥æºä¸»è¦æœ‰ä¸¤ä¸ªï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[t("code",[s._v("ecosystem.config.js")]),s._v(" æ–‡ä»¶")]),s._v("ï¼šè¿™æ˜¯ PM2 çš„æœ€ä½³å®è·µã€‚æ£€æŸ¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„è¿™ä¸ªæ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯ "),t("code",[s._v("env")]),s._v(" å’Œ "),t("code",[s._v("env_production")]),s._v(" éƒ¨åˆ†ã€‚"),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ecosystem.config.js")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("apps")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my-next-app'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("script")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node_modules/.bin/next'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("args")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'start'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("env_production")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PORT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ£€æŸ¥è¿™é‡Œçš„ DATABASE_URL, API_KEY ç­‰æ˜¯å¦æ­£ç¡®é…ç½®")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DATABASE_URL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'...'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])])]),s._v(" "),t("li",[t("strong",[s._v("ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡")]),s._v("ï¼šæ£€æŸ¥è¿è¡Œ PM2 çš„ç”¨æˆ·çš„ç¯å¢ƒå˜é‡è®¾ç½®ï¼Œå¦‚ "),t("code",[s._v("~/.bashrc")]),s._v(" æˆ– "),t("code",[s._v("~/.profile")]),s._v("ã€‚ä½¿ç”¨ "),t("code",[s._v("echo $VARIABLE_NAME")]),s._v(" ç¡®è®¤ã€‚")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("æ£€æŸ¥ç³»ç»Ÿèµ„æº (PM2 ç‹¬ç‰¹ä¼˜åŠ¿ä¸åŠ£åŠ¿)")]),s._v("\nä¸ Docker ä¸åŒï¼ŒPM2 è¿›ç¨‹ä¸æœåŠ¡å™¨ä¸Šçš„å…¶ä»–è¿›ç¨‹å…±äº«èµ„æºã€‚èµ„æºè€—å°½æ˜¯å¸¸è§é—®é¢˜ã€‚")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("å†…å­˜æº¢å‡º (Out of Memory)")]),s._v(": Node.js åº”ç”¨å¦‚æœå†…å­˜æ³„æ¼ï¼Œå¯èƒ½ä¼šè¢«ç³»ç»Ÿçš„ OOM Killer æ€æ­»ï¼Œå¯¼è‡´ PM2 ä¸æ–­é‡å¯ã€‚\n"),t("ul",[t("li",[t("strong",[s._v("ä½¿ç”¨ "),t("code",[s._v("pm2 monit")])]),s._v("ï¼šè¿™ä¸ªå‘½ä»¤æä¾›äº†ä¸€ä¸ªæ¼‚äº®çš„ç»ˆç«¯ä»ªè¡¨ç›˜ï¼Œå¯ä»¥å®æ—¶ç›‘æ§æ¯ä¸ªåº”ç”¨çš„ CPU å’Œå†…å­˜ä½¿ç”¨æƒ…å†µã€‚")]),s._v(" "),t("li",[t("strong",[s._v("ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤")]),s._v("ï¼š"),t("code",[s._v("htop")]),s._v(" æˆ– "),t("code",[s._v("top")]),s._v(" å¯ä»¥çœ‹åˆ°è¿›ç¨‹çš„èµ„æºå ç”¨ã€‚"),t("code",[s._v('dmesg -T | grep -i "killed process"')]),s._v(" å¯ä»¥æŸ¥çœ‹æ˜¯å¦æœ‰è¿›ç¨‹è¢«ç³»ç»Ÿæ€æ­»ã€‚")])])]),s._v(" "),t("li",[t("strong",[s._v("CPU å ç”¨è¿‡é«˜")]),s._v(": æ£€æŸ¥æ˜¯å¦æœ‰æ­»å¾ªç¯æˆ–é«˜è®¡ç®—é‡çš„æ“ä½œã€‚")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("æ£€æŸ¥æ–‡ä»¶æƒé™")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ç¡®è®¤è¿è¡Œ PM2 çš„ç”¨æˆ·ï¼ˆåœ¨ "),t("code",[s._v("pm2 status")]),s._v(" ä¸­å¯ä»¥çœ‹åˆ° "),t("code",[s._v("user")]),s._v("ï¼‰å¯¹é¡¹ç›®ç›®å½•æœ‰æ­£ç¡®çš„è¯»/å†™æƒé™ï¼Œç‰¹åˆ«æ˜¯å¯¹ "),t("code",[s._v(".next")]),s._v(" ç›®å½•å’Œä»»ä½•éœ€è¦å†™å…¥çš„ç¼“å­˜ç›®å½•ã€‚")]),s._v(" "),t("li",[s._v("ä½¿ç”¨ "),t("code",[s._v("ls -l /path/to/your/app")]),s._v(" æ¥æ£€æŸ¥ã€‚")])])])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"pm2-ç¯å¢ƒä¸‹çš„ç™½å±é—®é¢˜æ’æŸ¥æ¸…å•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pm2-ç¯å¢ƒä¸‹çš„ç™½å±é—®é¢˜æ’æŸ¥æ¸…å•"}},[s._v("ğŸŒ™")]),s._v(" PM2 ç¯å¢ƒä¸‹çš„ç™½å±é—®é¢˜æ’æŸ¥æ¸…å•")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("å¤ç°")]),s._v(": åœ¨æµè§ˆå™¨éšèº«æ¨¡å¼ä¸‹å¤ç°é—®é¢˜ï¼Œæ£€æŸ¥"),t("strong",[s._v("æ§åˆ¶å°")]),s._v("å’Œ"),t("strong",[s._v("ç½‘ç»œ")]),s._v("é¢æ¿ï¼Œåˆæ­¥åˆ¤æ–­æ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯é—®é¢˜ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("æŸ¥æ—¥å¿—")]),s._v(": "),t("code",[s._v("ssh")]),s._v(" ç™»å½•æœåŠ¡å™¨ï¼Œç«‹å³æ‰§è¡Œ "),t("code",[s._v("pm2 logs <app_name> --err --lines 200")]),s._v(" æŸ¥çœ‹é”™è¯¯æ—¥å¿—ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("æŸ¥çŠ¶æ€")]),s._v(": "),t("code",[s._v("pm2 status")]),s._v("ï¼Œæ£€æŸ¥åº”ç”¨çš„ "),t("code",[s._v("status")]),s._v(" æ˜¯å¦ä¸º "),t("code",[s._v("online")]),s._v("ï¼Œ"),t("code",[s._v("restarts")]),s._v(" æ¬¡æ•°æ˜¯å¦å¼‚å¸¸é«˜ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("å†³ç­–")]),s._v(": å¦‚æœæ˜¯æ–°ä¸Šçº¿å¯¼è‡´ï¼Œé€šè¿‡ä¿®æ”¹è½¯é“¾æ¥å¹¶ "),t("code",[s._v("pm2 reload <app_name>")]),s._v(" "),t("strong",[s._v("ç«‹å³å›æ»š")]),s._v("ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("æ·±åº¦å®šä½")]),s._v(":\n"),t("ul",[t("li",[t("strong",[s._v("å®¢æˆ·ç«¯é—®é¢˜")]),s._v(": "),t("code",[s._v("scp")]),s._v(" ä¸‹è½½ "),t("code",[s._v(".next")]),s._v(" ç›®å½•ï¼Œåœ¨æœ¬åœ°è¿›è¡Œ Source Map è§£ç ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æœåŠ¡ç«¯é—®é¢˜")]),s._v(":\n"),t("ul",[t("li",[t("code",[s._v("[ ]")]),s._v(" ä»”ç»†åˆ†æ "),t("code",[s._v("pm2 logs")]),s._v(" ä¸­çš„å †æ ˆè·Ÿè¸ªã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" æ£€æŸ¥ "),t("code",[s._v("ecosystem.config.js")]),s._v(" ä¸­çš„ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" ä½¿ç”¨ "),t("code",[s._v("pm2 monit")]),s._v(" æˆ– "),t("code",[s._v("htop")]),s._v(" æ£€æŸ¥åº”ç”¨çš„å†…å­˜å’Œ CPU ä½¿ç”¨æƒ…å†µï¼Œæ’æŸ¥èµ„æºè€—å°½é—®é¢˜ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" ä½¿ç”¨ "),t("code",[s._v("ls -l")]),s._v(" æ£€æŸ¥æ–‡ä»¶æƒé™æ˜¯å¦æ­£ç¡®ã€‚")])])])])]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("ä¿®å¤ä¸é¢„é˜²")]),s._v(":\n"),t("ul",[t("li",[t("code",[s._v("[ ]")]),s._v(" ä¿®å¤ä»£ç åï¼Œé€šè¿‡ CI/CD æµç¨‹æˆ–æ‰‹åŠ¨éƒ¨ç½²æ–°ç‰ˆæœ¬ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("å¼ºçƒˆå»ºè®®")]),s._v(": æ¨åŠ¨è¿ç»´æˆ–è‡ªå·±åŠ¨æ‰‹ï¼Œå°† PM2 çš„æ—¥å¿—ï¼ˆä½äº "),t("code",[s._v("~/.pm2/logs/")]),s._v("ï¼‰é€šè¿‡ Filebeat ç­‰å·¥å…·è½¬å‘åˆ°é›†ä¸­çš„æ—¥å¿—å¹³å°ï¼ˆå¦‚ ELK, Lokiï¼‰ã€‚")]),s._v(" "),t("li",[t("code",[s._v("[ ]")]),s._v(" "),t("strong",[s._v("å¼ºçƒˆå»ºè®®")]),s._v(": ä¸ºä½ çš„åº”ç”¨åˆ›å»ºä¸€ä¸ª "),t("code",[s._v("/api/health")]),s._v(" å¥åº·æ£€æŸ¥æ¥å£ï¼Œå¹¶ä½¿ç”¨å¤–éƒ¨ç›‘æ§å·¥å…·ï¼ˆå¦‚ Uptime Kuma æˆ–ä¸€ä¸ªç®€å•çš„ cron è„šæœ¬ï¼‰å®šæœŸè°ƒç”¨ï¼Œå®ç°åº”ç”¨å­˜æ´»ç›‘æ§ã€‚")])])])]),s._v(" "),t("h3",{attrs:{id:"æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[s._v("ğŸŒ™")]),s._v(" æ€»ç»“")]),s._v(" "),t("p",[s._v("çº¿ä¸Šç™½å±é—®é¢˜åœ¨ PM2 ç¯å¢ƒä¸‹çš„æ’æŸ¥æµç¨‹ä¸ Docker æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ä¹Ÿæœ‰å…¶ç‹¬ç‰¹çš„æŒ‘æˆ˜å’Œè§£å†³æ–¹æ¡ˆã€‚é€šè¿‡ç³»ç»ŸåŒ–çš„æ—¥å¿—åˆ†æã€ç¯å¢ƒæ£€æŸ¥å’Œèµ„æºç›‘æ§ï¼Œä½ å¯ä»¥å¿«é€Ÿå®šä½é—®é¢˜å¹¶æ¢å¤æœåŠ¡ã€‚åŒæ—¶ï¼Œå»ºç«‹è‰¯å¥½çš„æ—¥å¿—å’Œå¥åº·æ£€æŸ¥æœºåˆ¶ï¼Œå°†å¤§å¤§æé«˜æœªæ¥é—®é¢˜çš„æ’æŸ¥æ•ˆç‡ã€‚")]),s._v(" "),t("blockquote",[t("p",[t("RouterLink",{attrs:{to:"/frontEnd/nextjs/nextjs-error-check.html"}},[s._v("Next.js çº¿ä¸Šç™½å±é—®é¢˜æ’æŸ¥æŒ‡å—ï¼ˆSentryç›‘æ§ç‰ˆï¼‰")])],1),s._v(" "),t("p",[t("RouterLink",{attrs:{to:"/frontEnd/nextjs/nextjs-error-check2.html"}},[s._v("Next.js çº¿ä¸Šç™½å±é—®é¢˜æ’æŸ¥æŒ‡å—ï¼ˆDockeréƒ¨ç½²ç‰ˆï¼‰")])],1)])])}),[],!1,null,null,null);t.default=r.exports}}]);